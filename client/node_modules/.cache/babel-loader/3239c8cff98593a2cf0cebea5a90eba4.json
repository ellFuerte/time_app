{"ast":null,"code":"import _regeneratorRuntime from\"D:/time_app/client/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"D:/time_app/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"D:/time_app/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useEffect,useState,useRef}from'react';import axios from'axios';import Employee from'../Employee/Employee';import'./Staff.css';import{Link,useParams}from'react-router-dom';import Modal from'../Templates/Modal/Modal';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Staff(){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),checked=_useState2[0],setChecked=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),statisticsWork=_useState4[0],setStatisticsWork=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),users=_useState6[0],setUsers=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),UsersDep=_useState8[0],setUsersDeps=_useState8[1];var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),user=_useState10[0],setUser=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),isOpen=_useState12[0],setIsOpen=_useState12[1];var _useState13=useState(true),_useState14=_slicedToArray(_useState13,2),isJob=_useState14[0],setIsJob=_useState14[1];var _useState15=useState(false),_useState16=_slicedToArray(_useState15,2),modalMain=_useState16[0],setModalMain=_useState16[1];var localUser=JSON.parse(localStorage.getItem('user'));var departId=useParams().username;useEffect(function(){//Вывод статистики для админов\nvar get_statistics_all_users=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var getUsers,res,all,all_users,sort,_sort,_sort2,_sort3,_sort4,_sort5;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(localUser.isAdmin===true)){_context.next=21;break;}getUsers={id:localUser._id};_context.next=4;return axios.post('/api/get_statistics_all_users',getUsers);case 4:res=_context.sent;all=res.data[0].get_statistics_all_users[0]['all_users'].sort(function(a,b){return a.user_name.localeCompare(b.user_name);});all_users=filterUsersFoo(all);if(res.data[0].get_statistics_all_users[0]['all_users']===null&&!!~document.location.href.indexOf('/all_users/')){alert('Нет не одного пользователя в работе');}if(res.data[0].get_statistics_all_users[0]['not_working_today']===null&&!!~document.location.href.indexOf('/not_working_today/')){alert('Сегодня все в работе');window.location.href=\"/department/\".concat(localUser.departmentId);}if(res.data[0].get_statistics_all_users[0]['not_worked_yesterday']===null&&!!~document.location.href.indexOf('/not_worked_yesterday/')){alert('Вчера все работали');window.location.href=\"/department/\".concat(localUser.departmentId);}if(res.data[0].get_statistics_all_users[0]['sick_today']===null&&!!~document.location.href.indexOf('/sick_today/')){alert('Нет болеющих сегодня');window.location.href=\"/department/\".concat(localUser.departmentId);}if(res.data[0].get_statistics_all_users[0]['sick_yesterday']===null&&!!~document.location.href.indexOf('/sick_yesterday')){alert('Вчера не было сотрудников на больничном');window.location.href=\"/department/\".concat(localUser.main_department);}if(res.data[0].get_statistics_all_users[0]['vacation_today']===null&&!!~document.location.href.indexOf('/vacation_today')){alert('На сегодня нет сотрудников в отпуске');window.location.href=\"/department/\".concat(localUser.main_department);}if(res.data[0].get_statistics_all_users[0]['vacation_yesterday']===null&&!!~document.location.href.indexOf('/vacation_yesterday')){alert('Вчера не было сотрудников в отпуске');window.location.href=\"/department/\".concat(localUser.main_department);}if(!!~document.location.href.indexOf('/all_users/')){setIsJob(isJob);setStatisticsWork(all_users);}if(!!~document.location.href.indexOf('/not_working_today/')){if(res.data[0].get_statistics_all_users[0]['not_working_today']===null){}else{setIsJob(isJob);sort=res.data[0].get_statistics_all_users[0]['not_working_today'].sort(function(a,b){return a.user_name.localeCompare(b.user_name);});setStatisticsWork(filterUsersFoo(sort));}}if(!!~document.location.href.indexOf('/not_worked_yesterday/')){if(res.data[0].get_statistics_all_users[0]['not_worked_yesterday']===null){}else{setIsJob(isJob);_sort=res.data[0].get_statistics_all_users[0]['not_worked_yesterday'].sort(function(a,b){return a.user_name.localeCompare(b.user_name);});setStatisticsWork(filterUsersFoo(_sort));}}if(!!~document.location.href.indexOf('/sick_today/')){if(res.data[0].get_statistics_all_users[0]['sick_today']===null){}else{setIsJob(isJob);_sort2=res.data[0].get_statistics_all_users[0]['sick_today'].sort(function(a,b){return a.user_name.localeCompare(b.user_name);});setStatisticsWork(filterUsersFoo(_sort2));}}if(!!~document.location.href.indexOf('/sick_yesterday/')){if(res.data[0].get_statistics_all_users[0]['sick_yesterday']===null){}else{setIsJob(isJob);_sort3=res.data[0].get_statistics_all_users[0]['sick_yesterday'].sort(function(a,b){return a.user_name.localeCompare(b.user_name);});setStatisticsWork(filterUsersFoo(_sort3));}}if(!!~document.location.href.indexOf('/vacation_today/')){if(res.data[0].get_statistics_all_users[0]['vacation_today']===null){}else{setIsJob(isJob);_sort4=res.data[0].get_statistics_all_users[0]['vacation_today'].sort(function(a,b){return a.user_name.localeCompare(b.user_name);});setStatisticsWork(filterUsersFoo(_sort4));}}if(!!~document.location.href.indexOf('/vacation_yesterday/')){if(res.data[0].get_statistics_all_users[0]['vacation_yesterday']===null){}else{setIsJob(isJob);_sort5=res.data[0].get_statistics_all_users[0]['vacation_yesterday'].sort(function(a,b){return a.user_name.localeCompare(b.user_name);});setStatisticsWork(filterUsersFoo(_sort5));}}case 21:case\"end\":return _context.stop();}}},_callee);}));return function get_statistics_all_users(){return _ref.apply(this,arguments);};}();// функция показывает нажата ли галочка показать дочернии\nvar statusChild=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var user;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return axios.get('/api/user/'+localUser._id);case 2:user=_context2.sent;setChecked(user.data.see_child);setUser(user.data);case 5:case\"end\":return _context2.stop();}}},_callee2);}));return function statusChild(){return _ref2.apply(this,arguments);};}();var fetchUsers=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var res,filteredUsers;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return axios.get('/api/user');case 2:res=_context3.sent;res.data.sort(function(a,b){return a.user_name.localeCompare(b.user_name);});filteredUsers=filterUsersFoo(res.data);return _context3.abrupt(\"return\",filteredUsers.filter(function(user){return user.department_id===departId;}));case 6:case\"end\":return _context3.stop();}}},_callee3);}));return function fetchUsers(){return _ref3.apply(this,arguments);};}();var getUsersByDepIsCheckedTrue=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){var info,res,depUsers,sortedUsers,filteredUsers;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:info={depsId:departId};_context4.next=3;return axios.post('/api/get_users_by_dep/',info);case 3:res=_context4.sent;depUsers=res.data[0].get_users_by_dep;if(!(depUsers===null)){_context4.next=9;break;}return _context4.abrupt(\"return\",[]);case 9:sortedUsers=depUsers.sort(function(a,b){return a.user_name.localeCompare(b.user_name);});filteredUsers=filterUsersFoo(sortedUsers);return _context4.abrupt(\"return\",filteredUsers);case 12:case\"end\":return _context4.stop();}}},_callee4);}));return function getUsersByDepIsCheckedTrue(){return _ref4.apply(this,arguments);};}();var combineUsers=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(){var _users,combinedArray,us;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.prev=0;_context5.next=3;return fetchUsers();case 3:_users=_context5.sent;combinedArray=[];if(!(checked&&user.main_department===departId)){_context5.next=13;break;}setIsJob(false);_context5.next=9;return getUsersByDepIsCheckedTrue();case 9:us=_context5.sent;combinedArray=combinedArray.concat(us);_context5.next=14;break;case 13:combinedArray=_users;case 14:setUsers(combinedArray);_context5.next=20;break;case 17:_context5.prev=17;_context5.t0=_context5[\"catch\"](0);console.error('Ошибка при объединении пользователей:',_context5.t0);case 20:case\"end\":return _context5.stop();}}},_callee5,null,[[0,17]]);}));return function combineUsers(){return _ref5.apply(this,arguments);};}();// Вызов функции combineUsers для получения и объединения пользователей\ncombineUsers();setIsJob(true);if(departId){setUsersDeps([]);}get_statistics_all_users();statusChild();},[departId,user.main_department]);//Сортировка пользователей по статусам\nfunction filterUsersFoo(users){return users.filter(function(user){return user.status===1;}).concat(users.filter(function(user){return user.status===2;})).concat(users.filter(function(user){return user.status===3;})).concat(users.filter(function(user){return user.status!==1&&user.status!==2&&user.status!==3&&user.status!==4;})).concat(users.filter(function(user){return user.status===4;}));}var clickcheckbox=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(){var info;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:setChecked(!checked);info={userId:localUser._id,ischeked:!checked};_context6.next=4;return axios.post('/api/statusChild/',info);case 4:case\"end\":return _context6.stop();}}},_callee6);}));return function clickcheckbox(){return _ref6.apply(this,arguments);};}();var handleModalClick=/*#__PURE__*/function(){var _ref7=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee7(){var add,res;return _regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:add={id:localUser._id,depsId:departId};_context7.next=3;return axios.put('/api/user',add);case 3:res=_context7.sent;setModalMain(false);case 5:case\"end\":return _context7.stop();}}},_callee7);}));return function handleModalClick(){return _ref7.apply(this,arguments);};}();var get_users_by_depIsOpen=/*#__PURE__*/function(){var _ref8=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee8(){var info,res,dep_users,filterUsers;return _regeneratorRuntime.wrap(function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:if(!isJob){_context8.next=7;break;}info={depsId:departId};_context8.next=4;return axios.post('/api/get_users_by_dep/',info);case 4:res=_context8.sent;dep_users=res.data[0]['get_users_by_dep'];if(dep_users!==null){dep_users.sort(function(a,b){return a.user_name.localeCompare(b.user_name);});filterUsers=filterUsersFoo(dep_users);setUsersDeps(filterUsers);setUsers([]);setIsJob(!isJob);setIsOpen(true);}case 7:case\"end\":return _context8.stop();}}},_callee8);}));return function get_users_by_depIsOpen(){return _ref8.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{className:\"staff\",children:[/*#__PURE__*/_jsx(_Fragment,{children:departId&&/*#__PURE__*/_jsxs(_Fragment,{children:[isJob?/*#__PURE__*/_jsx(\"button\",{onClick:get_users_by_depIsOpen,className:\"btnStaff\",style:{width:'155px'},children:\"\\u041F\\u043E\\u043A\\u0430\\u0437\\u0430\\u0442\\u044C \\u0434\\u043E\\u0447\\u0435\\u0440\\u043D\\u0438\\u0435\"}):/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return window.location.href=\"/department/\".concat(departId);},className:\"btnStaff\",disabled:checked&&user.main_department===departId,children:\"\\u0421\\u043A\\u0440\\u044B\\u0442\\u044C \\u0434\\u043E\\u0447\\u0435\\u0440\\u043D\\u0438\\u0435\"}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return setModalMain(true);},className:\"btnStaff\",style:{float:'right'},children:\"\\u0421\\u0434\\u0435\\u043B\\u0430\\u0442\\u044C \\u0433\\u043B\\u0430\\u0432\\u043D\\u043E\\u0439\"}),localUser.isAdmin?/*#__PURE__*/_jsx(Link,{to:\"/VacanciesView/\",children:/*#__PURE__*/_jsx(\"button\",{className:\"btnStaff\",children:\"\\u041F\\u043E\\u043A\\u0430\\u0437\\u0430\\u0442\\u044C \\u0432\\u0430\\u043A\\u0430\\u043D\\u0441\\u0438\\u0438\"})}):'']})}),/*#__PURE__*/_jsxs(\"div\",{className:\"employeeWrapper\",children:[users.map(function(user,id){return/*#__PURE__*/_jsx(Employee,{user:user},id);}),isOpen?UsersDep.map(function(user,id){return/*#__PURE__*/_jsx(Employee,{user:user},id);}):'',!departId?statisticsWork.map(function(user,id){return/*#__PURE__*/_jsx(Employee,{user:user},id);}):'']}),/*#__PURE__*/_jsxs(Modal,{active:modalMain,setActive:setModalMain,children:[/*#__PURE__*/_jsx(\"h1\",{children:\"\\u0418\\u0437\\u043C\\u0435\\u043D\\u0435\\u043D\\u0438\\u0435 \\u0438\\u043D\\u0444\\u043E\\u0440\\u043C\\u0430\\u0446\\u0438\\u0438:\"}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsxs(\"form\",{className:\"modalLoginBox\",children:[/*#__PURE__*/_jsxs(\"label\",{children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",onChange:clickcheckbox,checked:checked}),\"\\u0414\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C \\u0434\\u043E\\u0447\\u0435\\u0440\\u043D\\u0438\\u0435\"]}),/*#__PURE__*/_jsx(\"button\",{className:\"ModalButtonDepartment\",type:\"submit\",onClick:handleModalClick,children:\"\\u0421\\u0434\\u0435\\u043B\\u0430\\u0442\\u044C \\u0433\\u043B\\u0430\\u0432\\u043D\\u044B\\u043C \\u0434\\u0435\\u043F\\u0430\\u0440\\u0442\\u0430\\u043C\\u0435\\u043D\\u0442\\u043E\\u043C\"})]})]})]});}","map":{"version":3,"sources":["D:/time_app/client/src/components/Staff/Staff.jsx"],"names":["useEffect","useState","useRef","axios","Employee","Link","useParams","Modal","Staff","checked","setChecked","statisticsWork","setStatisticsWork","users","setUsers","UsersDep","setUsersDeps","user","setUser","isOpen","setIsOpen","isJob","setIsJob","modalMain","setModalMain","localUser","JSON","parse","localStorage","getItem","departId","username","get_statistics_all_users","isAdmin","getUsers","id","_id","post","res","all","data","sort","a","b","user_name","localeCompare","all_users","filterUsersFoo","document","location","href","indexOf","alert","window","departmentId","main_department","statusChild","get","see_child","fetchUsers","filteredUsers","filter","department_id","getUsersByDepIsCheckedTrue","info","depsId","depUsers","get_users_by_dep","sortedUsers","combineUsers","combinedArray","us","concat","console","error","status","clickcheckbox","userId","ischeked","handleModalClick","add","put","get_users_by_depIsOpen","dep_users","filterUsers","width","float","map"],"mappings":"4SAAA,OAAQA,SAAR,CAAkBC,QAAlB,CAA2BC,MAA3B,KAAwC,OAAxC,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAOC,CAAAA,QAAP,KAAqB,sBAArB,CACA,MAAO,aAAP,CACA,OAAQC,IAAR,CAAcC,SAAd,KAA8B,kBAA9B,CACA,MAAOC,CAAAA,KAAP,KAAkB,0BAAlB,C,6IAIA,cAAe,SAASC,CAAAA,KAAT,EAAiB,CAC5B,cAA8BP,QAAQ,CAAC,KAAD,CAAtC,wCAAOQ,OAAP,eAAgBC,UAAhB,eAEA,eAA4CT,QAAQ,CAAC,EAAD,CAApD,yCAAOU,cAAP,eAAuBC,iBAAvB,eACA,eAA0BX,QAAQ,CAAC,EAAD,CAAlC,yCAAOY,KAAP,eAAcC,QAAd,eACA,eAAiCb,QAAQ,CAAC,EAAD,CAAzC,yCAAOc,QAAP,eAAiBC,YAAjB,eACA,eAAwBf,QAAQ,CAAC,EAAD,CAAhC,0CAAOgB,IAAP,gBAAaC,OAAb,gBACA,gBAA4BjB,QAAQ,CAAC,KAAD,CAApC,2CAAOkB,MAAP,gBAAeC,SAAf,gBACA,gBAA0BnB,QAAQ,CAAC,IAAD,CAAlC,2CAAOoB,KAAP,gBAAcC,QAAd,gBACA,gBAAkCrB,QAAQ,CAAC,KAAD,CAA1C,2CAAOsB,SAAP,gBAAkBC,YAAlB,gBACA,GAAMC,CAAAA,SAAS,CAAGC,IAAI,CAACC,KAAL,CAAWC,YAAY,CAACC,OAAb,CAAqB,MAArB,CAAX,CAAlB,CACA,GAAMC,CAAAA,QAAQ,CAAGxB,SAAS,GAAGyB,QAA7B,CAGA/B,SAAS,CAAC,UAAM,CAEZ;AACA,GAAMgC,CAAAA,wBAAwB,0FAAG,8MAEzBP,SAAS,CAACQ,OAAV,GAAsB,IAFG,2BAGnBC,QAHmB,CAGR,CACbC,EAAE,CAAEV,SAAS,CAACW,GADD,CAHQ,uBAMPjC,CAAAA,KAAK,CAACkC,IAAN,CAAW,+BAAX,CAA4CH,QAA5C,CANO,QAMnBI,GANmB,eAOnBC,GAPmB,CAObD,GAAG,CAACE,IAAJ,CAAS,CAAT,EAAYR,wBAAZ,CAAqC,CAArC,EAAwC,WAAxC,EAAqDS,IAArD,CAA0D,SAACC,CAAD,CAAIC,CAAJ,QAAUD,CAAAA,CAAC,CAACE,SAAF,CAAYC,aAAZ,CAA0BF,CAAC,CAACC,SAA5B,CAAV,EAA1D,CAPa,CASrBE,SATqB,CASTC,cAAc,CAACR,GAAD,CATL,CAWzB,GAAID,GAAG,CAACE,IAAJ,CAAS,CAAT,EAAYR,wBAAZ,CAAqC,CAArC,EAAwC,WAAxC,IAAyD,IAAzD,EAAiE,CAAC,CAAC,CAACgB,QAAQ,CAACC,QAAT,CAAkBC,IAAlB,CAAuBC,OAAvB,CAA+B,aAA/B,CAAxE,CAAuH,CACnHC,KAAK,CAAC,qCAAD,CAAL,CACH,CACD,GAAId,GAAG,CAACE,IAAJ,CAAS,CAAT,EAAYR,wBAAZ,CAAqC,CAArC,EAAwC,mBAAxC,IAAiE,IAAjE,EAAyE,CAAC,CAAC,CAACgB,QAAQ,CAACC,QAAT,CAAkBC,IAAlB,CAAuBC,OAAvB,CAA+B,qBAA/B,CAAhF,CAAuI,CACnIC,KAAK,CAAC,sBAAD,CAAL,CACAC,MAAM,CAACJ,QAAP,CAAgBC,IAAhB,uBAAsCzB,SAAS,CAAC6B,YAAhD,EACH,CACD,GAAIhB,GAAG,CAACE,IAAJ,CAAS,CAAT,EAAYR,wBAAZ,CAAqC,CAArC,EAAwC,sBAAxC,IAAoE,IAApE,EAA4E,CAAC,CAAC,CAACgB,QAAQ,CAACC,QAAT,CAAkBC,IAAlB,CAAuBC,OAAvB,CAA+B,wBAA/B,CAAnF,CAA6I,CACzIC,KAAK,CAAC,oBAAD,CAAL,CACAC,MAAM,CAACJ,QAAP,CAAgBC,IAAhB,uBAAsCzB,SAAS,CAAC6B,YAAhD,EACH,CACD,GAAIhB,GAAG,CAACE,IAAJ,CAAS,CAAT,EAAYR,wBAAZ,CAAqC,CAArC,EAAwC,YAAxC,IAA0D,IAA1D,EAAkE,CAAC,CAAC,CAACgB,QAAQ,CAACC,QAAT,CAAkBC,IAAlB,CAAuBC,OAAvB,CAA+B,cAA/B,CAAzE,CAAyH,CACrHC,KAAK,CAAC,sBAAD,CAAL,CACAC,MAAM,CAACJ,QAAP,CAAgBC,IAAhB,uBAAsCzB,SAAS,CAAC6B,YAAhD,EACH,CACD,GAAIhB,GAAG,CAACE,IAAJ,CAAS,CAAT,EAAYR,wBAAZ,CAAqC,CAArC,EAAwC,gBAAxC,IAA8D,IAA9D,EAAsE,CAAC,CAAC,CAACgB,QAAQ,CAACC,QAAT,CAAkBC,IAAlB,CAAuBC,OAAvB,CAA+B,iBAA/B,CAA7E,CAAgI,CAC5HC,KAAK,CAAC,yCAAD,CAAL,CACAC,MAAM,CAACJ,QAAP,CAAgBC,IAAhB,uBAAsCzB,SAAS,CAAC8B,eAAhD,EACH,CACD,GAAIjB,GAAG,CAACE,IAAJ,CAAS,CAAT,EAAYR,wBAAZ,CAAqC,CAArC,EAAwC,gBAAxC,IAA8D,IAA9D,EAAsE,CAAC,CAAC,CAACgB,QAAQ,CAACC,QAAT,CAAkBC,IAAlB,CAAuBC,OAAvB,CAA+B,iBAA/B,CAA7E,CAAgI,CAC5HC,KAAK,CAAC,sCAAD,CAAL,CACAC,MAAM,CAACJ,QAAP,CAAgBC,IAAhB,uBAAsCzB,SAAS,CAAC8B,eAAhD,EACH,CACD,GAAIjB,GAAG,CAACE,IAAJ,CAAS,CAAT,EAAYR,wBAAZ,CAAqC,CAArC,EAAwC,oBAAxC,IAAkE,IAAlE,EAA0E,CAAC,CAAC,CAACgB,QAAQ,CAACC,QAAT,CAAkBC,IAAlB,CAAuBC,OAAvB,CAA+B,qBAA/B,CAAjF,CAAwI,CACpIC,KAAK,CAAC,qCAAD,CAAL,CACAC,MAAM,CAACJ,QAAP,CAAgBC,IAAhB,uBAAsCzB,SAAS,CAAC8B,eAAhD,EACH,CACD,GAAI,CAAC,CAAC,CAACP,QAAQ,CAACC,QAAT,CAAkBC,IAAlB,CAAuBC,OAAvB,CAA+B,aAA/B,CAAP,CAAsD,CAClD7B,QAAQ,CAACD,KAAD,CAAR,CACAT,iBAAiB,CAACkC,SAAD,CAAjB,CACH,CACD,GAAI,CAAC,CAAC,CAACE,QAAQ,CAACC,QAAT,CAAkBC,IAAlB,CAAuBC,OAAvB,CAA+B,qBAA/B,CAAP,CAA8D,CAC1D,GAAIb,GAAG,CAACE,IAAJ,CAAS,CAAT,EAAYR,wBAAZ,CAAqC,CAArC,EAAwC,mBAAxC,IAAiE,IAArE,CAA2E,CAE1E,CAFD,IAEO,CACHV,QAAQ,CAACD,KAAD,CAAR,CACMoB,IAFH,CAEUH,GAAG,CAACE,IAAJ,CAAS,CAAT,EAAYR,wBAAZ,CAAqC,CAArC,EAAwC,mBAAxC,EAA6DS,IAA7D,CAAkE,SAACC,CAAD,CAAIC,CAAJ,QAAUD,CAAAA,CAAC,CAACE,SAAF,CAAYC,aAAZ,CAA0BF,CAAC,CAACC,SAA5B,CAAV,EAAlE,CAFV,CAGHhC,iBAAiB,CAACmC,cAAc,CAACN,IAAD,CAAf,CAAjB,CACH,CACJ,CAED,GAAI,CAAC,CAAC,CAACO,QAAQ,CAACC,QAAT,CAAkBC,IAAlB,CAAuBC,OAAvB,CAA+B,wBAA/B,CAAP,CAAiE,CAC7D,GAAIb,GAAG,CAACE,IAAJ,CAAS,CAAT,EAAYR,wBAAZ,CAAqC,CAArC,EAAwC,sBAAxC,IAAoE,IAAxE,CAA8E,CAE7E,CAFD,IAEO,CACHV,QAAQ,CAACD,KAAD,CAAR,CACMoB,KAFH,CAEUH,GAAG,CAACE,IAAJ,CAAS,CAAT,EAAYR,wBAAZ,CAAqC,CAArC,EAAwC,sBAAxC,EAAgES,IAAhE,CAAqE,SAACC,CAAD,CAAIC,CAAJ,QAAUD,CAAAA,CAAC,CAACE,SAAF,CAAYC,aAAZ,CAA0BF,CAAC,CAACC,SAA5B,CAAV,EAArE,CAFV,CAGHhC,iBAAiB,CAACmC,cAAc,CAACN,KAAD,CAAf,CAAjB,CACH,CACJ,CAED,GAAI,CAAC,CAAC,CAACO,QAAQ,CAACC,QAAT,CAAkBC,IAAlB,CAAuBC,OAAvB,CAA+B,cAA/B,CAAP,CAAuD,CACnD,GAAIb,GAAG,CAACE,IAAJ,CAAS,CAAT,EAAYR,wBAAZ,CAAqC,CAArC,EAAwC,YAAxC,IAA0D,IAA9D,CAAoE,CAEnE,CAFD,IAEO,CACHV,QAAQ,CAACD,KAAD,CAAR,CACMoB,MAFH,CAEUH,GAAG,CAACE,IAAJ,CAAS,CAAT,EAAYR,wBAAZ,CAAqC,CAArC,EAAwC,YAAxC,EAAsDS,IAAtD,CAA2D,SAACC,CAAD,CAAIC,CAAJ,QAAUD,CAAAA,CAAC,CAACE,SAAF,CAAYC,aAAZ,CAA0BF,CAAC,CAACC,SAA5B,CAAV,EAA3D,CAFV,CAGHhC,iBAAiB,CAACmC,cAAc,CAACN,MAAD,CAAf,CAAjB,CACH,CACJ,CAED,GAAI,CAAC,CAAC,CAACO,QAAQ,CAACC,QAAT,CAAkBC,IAAlB,CAAuBC,OAAvB,CAA+B,kBAA/B,CAAP,CAA2D,CACvD,GAAIb,GAAG,CAACE,IAAJ,CAAS,CAAT,EAAYR,wBAAZ,CAAqC,CAArC,EAAwC,gBAAxC,IAA8D,IAAlE,CAAwE,CAEvE,CAFD,IAEO,CACHV,QAAQ,CAACD,KAAD,CAAR,CACMoB,MAFH,CAEUH,GAAG,CAACE,IAAJ,CAAS,CAAT,EAAYR,wBAAZ,CAAqC,CAArC,EAAwC,gBAAxC,EAA0DS,IAA1D,CAA+D,SAACC,CAAD,CAAIC,CAAJ,QAAUD,CAAAA,CAAC,CAACE,SAAF,CAAYC,aAAZ,CAA0BF,CAAC,CAACC,SAA5B,CAAV,EAA/D,CAFV,CAGHhC,iBAAiB,CAACmC,cAAc,CAACN,MAAD,CAAf,CAAjB,CACH,CACJ,CAED,GAAI,CAAC,CAAC,CAACO,QAAQ,CAACC,QAAT,CAAkBC,IAAlB,CAAuBC,OAAvB,CAA+B,kBAA/B,CAAP,CAA2D,CACvD,GAAIb,GAAG,CAACE,IAAJ,CAAS,CAAT,EAAYR,wBAAZ,CAAqC,CAArC,EAAwC,gBAAxC,IAA8D,IAAlE,CAAwE,CAEvE,CAFD,IAEO,CACHV,QAAQ,CAACD,KAAD,CAAR,CACMoB,MAFH,CAEUH,GAAG,CAACE,IAAJ,CAAS,CAAT,EAAYR,wBAAZ,CAAqC,CAArC,EAAwC,gBAAxC,EAA0DS,IAA1D,CAA+D,SAACC,CAAD,CAAIC,CAAJ,QAAUD,CAAAA,CAAC,CAACE,SAAF,CAAYC,aAAZ,CAA0BF,CAAC,CAACC,SAA5B,CAAV,EAA/D,CAFV,CAGHhC,iBAAiB,CAACmC,cAAc,CAACN,MAAD,CAAf,CAAjB,CACH,CACJ,CAED,GAAI,CAAC,CAAC,CAACO,QAAQ,CAACC,QAAT,CAAkBC,IAAlB,CAAuBC,OAAvB,CAA+B,sBAA/B,CAAP,CAA+D,CAC3D,GAAIb,GAAG,CAACE,IAAJ,CAAS,CAAT,EAAYR,wBAAZ,CAAqC,CAArC,EAAwC,oBAAxC,IAAkE,IAAtE,CAA4E,CAE3E,CAFD,IAEO,CACHV,QAAQ,CAACD,KAAD,CAAR,CACMoB,MAFH,CAEUH,GAAG,CAACE,IAAJ,CAAS,CAAT,EAAYR,wBAAZ,CAAqC,CAArC,EAAwC,oBAAxC,EAA8DS,IAA9D,CAAmE,SAACC,CAAD,CAAIC,CAAJ,QAAUD,CAAAA,CAAC,CAACE,SAAF,CAAYC,aAAZ,CAA0BF,CAAC,CAACC,SAA5B,CAAV,EAAnE,CAFV,CAGHhC,iBAAiB,CAACmC,cAAc,CAACN,MAAD,CAAf,CAAjB,CACH,CACJ,CApGwB,uDAAH,kBAAxBT,CAAAA,wBAAwB,0CAA9B,CAyGA;AACA,GAAMwB,CAAAA,WAAW,2FAAG,wKACGrD,CAAAA,KAAK,CAACsD,GAAN,CAAU,aAAehC,SAAS,CAACW,GAAnC,CADH,QACVnB,IADU,gBAEhBP,UAAU,CAACO,IAAI,CAACuB,IAAL,CAAUkB,SAAX,CAAV,CACAxC,OAAO,CAACD,IAAI,CAACuB,IAAN,CAAP,CAHgB,wDAAH,kBAAXgB,CAAAA,WAAW,2CAAjB,CAMA,GAAMG,CAAAA,UAAU,2FAAG,qLACGxD,CAAAA,KAAK,CAACsD,GAAN,CAAU,WAAV,CADH,QACTnB,GADS,gBAEfA,GAAG,CAACE,IAAJ,CAASC,IAAT,CAAc,SAACC,CAAD,CAAIC,CAAJ,QAAUD,CAAAA,CAAC,CAACE,SAAF,CAAYC,aAAZ,CAA0BF,CAAC,CAACC,SAA5B,CAAV,EAAd,EACMgB,aAHS,CAGOb,cAAc,CAACT,GAAG,CAACE,IAAL,CAHrB,kCAIRoB,aAAa,CAACC,MAAd,CAAqB,SAAA5C,IAAI,QAAIA,CAAAA,IAAI,CAAC6C,aAAL,GAAuBhC,QAA3B,EAAzB,CAJQ,0DAAH,kBAAV6B,CAAAA,UAAU,2CAAhB,CAOA,GAAMI,CAAAA,0BAA0B,2FAAG,wLACzBC,IADyB,CAClB,CAAEC,MAAM,CAAEnC,QAAV,CADkB,wBAEb3B,CAAAA,KAAK,CAACkC,IAAN,CAAW,wBAAX,CAAqC2B,IAArC,CAFa,QAEzB1B,GAFyB,gBAGzB4B,QAHyB,CAGd5B,GAAG,CAACE,IAAJ,CAAS,CAAT,EAAY2B,gBAHE,MAI3BD,QAAQ,GAAK,IAJc,4DAKpB,EALoB,SAOrBE,WAPqB,CAOPF,QAAQ,CAACzB,IAAT,CAAc,SAACC,CAAD,CAAIC,CAAJ,QAAUD,CAAAA,CAAC,CAACE,SAAF,CAAYC,aAAZ,CAA0BF,CAAC,CAACC,SAA5B,CAAV,EAAd,CAPO,CAQrBgB,aARqB,CAQLb,cAAc,CAACqB,WAAD,CART,kCASpBR,aAToB,2DAAH,kBAA1BG,CAAAA,0BAA0B,2CAAhC,CAaA,GAAMM,CAAAA,YAAY,2FAAG,4MAEOV,CAAAA,UAAU,EAFjB,QAEP9C,MAFO,gBAGTyD,aAHS,CAGO,EAHP,MAKT7D,OAAO,EAAIQ,IAAI,CAACsC,eAAL,GAAuBzB,QALzB,4BAMTR,QAAQ,CAAC,KAAD,CAAR,CANS,uBAOQyC,CAAAA,0BAA0B,EAPlC,QAOHQ,EAPG,gBAQTD,aAAa,CAAGA,aAAa,CAACE,MAAd,CAAqBD,EAArB,CAAhB,CARS,gCAUTD,aAAa,CAAGzD,MAAhB,CAVS,QAabC,QAAQ,CAACwD,aAAD,CAAR,CAba,qFAebG,OAAO,CAACC,KAAR,CAAc,uCAAd,eAfa,uEAAH,kBAAZL,CAAAA,YAAY,2CAAlB,CAmBA;AACAA,YAAY,GAGZ/C,QAAQ,CAAC,IAAD,CAAR,CAEA,GAAGQ,QAAH,CAAY,CACRd,YAAY,CAAC,EAAD,CAAZ,CACH,CACDgB,wBAAwB,GACxBwB,WAAW,GAGd,CAvKQ,CAuKN,CAAC1B,QAAD,CAAUb,IAAI,CAACsC,eAAf,CAvKM,CAAT,CA4KA;AACA,QAASR,CAAAA,cAAT,CAAwBlC,KAAxB,CAA+B,CAC3B,MAAOA,CAAAA,KAAK,CAACgD,MAAN,CAAa,SAAA5C,IAAI,QAAIA,CAAAA,IAAI,CAAC0D,MAAL,GAAgB,CAApB,EAAjB,EACFH,MADE,CACK3D,KAAK,CAACgD,MAAN,CAAa,SAAA5C,IAAI,QAAIA,CAAAA,IAAI,CAAC0D,MAAL,GAAgB,CAApB,EAAjB,CADL,EAEFH,MAFE,CAEK3D,KAAK,CAACgD,MAAN,CAAa,SAAA5C,IAAI,QAAIA,CAAAA,IAAI,CAAC0D,MAAL,GAAgB,CAApB,EAAjB,CAFL,EAGFH,MAHE,CAGK3D,KAAK,CAACgD,MAAN,CAAa,SAAA5C,IAAI,QAAIA,CAAAA,IAAI,CAAC0D,MAAL,GAAgB,CAAhB,EAAqB1D,IAAI,CAAC0D,MAAL,GAAgB,CAArC,EAA0C1D,IAAI,CAAC0D,MAAL,GAAgB,CAA1D,EAA+D1D,IAAI,CAAC0D,MAAL,GAAgB,CAAnF,EAAjB,CAHL,EAIFH,MAJE,CAIK3D,KAAK,CAACgD,MAAN,CAAa,SAAA5C,IAAI,QAAIA,CAAAA,IAAI,CAAC0D,MAAL,GAAgB,CAApB,EAAjB,CAJL,CAAP,CAKH,CAGD,GAAMC,CAAAA,aAAa,2FAAG,iJAClBlE,UAAU,CAAC,CAACD,OAAF,CAAV,CACMuD,IAFY,CAEL,CACTa,MAAM,CAAEpD,SAAS,CAACW,GADT,CAET0C,QAAQ,CAAE,CAACrE,OAFF,CAFK,wBAMZN,CAAAA,KAAK,CAACkC,IAAN,CAAW,mBAAX,CAAgC2B,IAAhC,CANY,yDAAH,kBAAbY,CAAAA,aAAa,2CAAnB,CAUA,GAAMG,CAAAA,gBAAgB,2FAAG,oJACfC,GADe,CACT,CACR7C,EAAE,CAAEV,SAAS,CAACW,GADN,CAER6B,MAAM,CAAEnC,QAFA,CADS,wBAKH3B,CAAAA,KAAK,CAAC8E,GAAN,CAAU,WAAV,CAAuBD,GAAvB,CALG,QAKf1C,GALe,gBAMrBd,YAAY,CAAC,KAAD,CAAZ,CANqB,wDAAH,kBAAhBuD,CAAAA,gBAAgB,2CAAtB,CAWA,GAAMG,CAAAA,sBAAsB,2FAAG,+KAEvB7D,KAFuB,0BAGjB2C,IAHiB,CAGV,CACTC,MAAM,CAAEnC,QADC,CAHU,wBAML3B,CAAAA,KAAK,CAACkC,IAAN,CAAW,wBAAX,CAAqC2B,IAArC,CANK,QAMjB1B,GANiB,gBAOjB6C,SAPiB,CAOL7C,GAAG,CAACE,IAAJ,CAAS,CAAT,EAAY,kBAAZ,CAPK,CAQvB,GAAI2C,SAAS,GAAK,IAAlB,CAAwB,CACpBA,SAAS,CAAC1C,IAAV,CAAe,SAACC,CAAD,CAAIC,CAAJ,QAAUD,CAAAA,CAAC,CAACE,SAAF,CAAYC,aAAZ,CAA0BF,CAAC,CAACC,SAA5B,CAAV,EAAf,EACIwC,WAFgB,CAEFrC,cAAc,CAACoC,SAAD,CAFZ,CAGpBnE,YAAY,CAACoE,WAAD,CAAZ,CACAtE,QAAQ,CAAC,EAAD,CAAR,CACAQ,QAAQ,CAAC,CAACD,KAAF,CAAR,CACAD,SAAS,CAAC,IAAD,CAAT,CACH,CAfsB,wDAAH,kBAAtB8D,CAAAA,sBAAsB,2CAA5B,CAoBA,mBAEI,aAAK,SAAS,CAAC,OAAf,wBACI,yBACKpD,QAAQ,eACL,2BACKT,KAAK,cACF,eAAQ,OAAO,CAAE6D,sBAAjB,CAAyC,SAAS,CAAC,UAAnD,CAA8D,KAAK,CAAE,CAAEG,KAAK,CAAE,OAAT,CAArE,+GADE,cAKF,eAAQ,OAAO,CAAE,yBAAMhC,CAAAA,MAAM,CAACJ,QAAP,CAAgBC,IAAhB,uBAAsCpB,QAAtC,CAAN,EAAjB,CAAyE,SAAS,CAAC,UAAnF,CAA8F,QAAQ,CAAErB,OAAO,EAAIQ,IAAI,CAACsC,eAAL,GAAyBzB,QAA5I,mGANR,cAUI,eAAQ,OAAO,CAAE,yBAAMN,CAAAA,YAAY,CAAC,IAAD,CAAlB,EAAjB,CAA2C,SAAS,CAAC,UAArD,CAAgE,KAAK,CAAE,CAAE8D,KAAK,CAAE,OAAT,CAAvE,mGAVJ,CAWK7D,SAAS,CAACQ,OAAV,cAAoB,KAAC,IAAD,EAAM,EAAE,kBAAR,uBAA6B,eAAQ,SAAS,CAAC,UAAlB,+GAA7B,EAApB,CAAkH,EAXvH,GAFR,EADJ,cAoBI,aAAK,SAAS,CAAC,iBAAf,WAGQpB,KAAK,CAAC0E,GAAN,CAAU,SAACtE,IAAD,CAAOkB,EAAP,qBAAc,KAAC,QAAD,EAAmB,IAAI,CAAElB,IAAzB,EAAekB,EAAf,CAAd,EAAV,CAHR,CAMKhB,MAAM,CACHJ,QAAQ,CAACwE,GAAT,CAAa,SAACtE,IAAD,CAAOkB,EAAP,qBAAc,KAAC,QAAD,EAAmB,IAAI,CAAElB,IAAzB,EAAekB,EAAf,CAAd,EAAb,CADG,CAEF,EART,CAYK,CAACL,QAAD,CACKnB,cAAc,CAAC4E,GAAf,CAAmB,SAACtE,IAAD,CAAOkB,EAAP,qBAAc,KAAC,QAAD,EAAmB,IAAI,CAAElB,IAAzB,EAAekB,EAAf,CAAd,EAAnB,CADL,CAEI,EAdT,GApBJ,cAsCI,MAAC,KAAD,EAAO,MAAM,CAAEZ,SAAf,CAA0B,SAAS,CAAEC,YAArC,wBACI,4IADJ,cAEI,aAFJ,cAGI,cAAM,SAAS,CAAC,eAAhB,wBACI,sCACI,cACI,IAAI,CAAC,UADT,CAEI,QAAQ,CAAEoD,aAFd,CAGI,OAAO,CAAEnE,OAHb,EADJ,uGADJ,cAQI,eAAQ,SAAS,CAAC,uBAAlB,CAA0C,IAAI,CAAC,QAA/C,CAAwD,OAAO,CAAEsE,gBAAjE,kLARJ,GAHJ,GAtCJ,GAFJ,CA0DH","sourcesContent":["import {useEffect,useState,useRef} from 'react'\r\nimport axios from 'axios'\r\nimport Employee from '../Employee/Employee'\r\nimport './Staff.css'\r\nimport {Link, useParams} from 'react-router-dom'\r\nimport Modal from '../Templates/Modal/Modal'\r\n\r\n\r\n\r\nexport default function Staff() {\r\n    const [checked, setChecked] = useState(false)\r\n\r\n    const [statisticsWork, setStatisticsWork] = useState([])\r\n    const [users, setUsers] = useState([])\r\n    const [UsersDep, setUsersDeps] = useState([])\r\n    const [user, setUser] = useState([])\r\n    const [isOpen, setIsOpen] = useState(false)\r\n    const [isJob, setIsJob] = useState(true)\r\n    const [modalMain, setModalMain] = useState(false)\r\n    const localUser = JSON.parse(localStorage.getItem('user'))\r\n    const departId = useParams().username;\r\n\r\n\r\n    useEffect(() => {\r\n\r\n        //Вывод статистики для админов\r\n        const get_statistics_all_users = async () => {\r\n\r\n            if (localUser.isAdmin === true) {\r\n                const getUsers = {\r\n                    id: localUser._id\r\n                }\r\n                const res = await axios.post('/api/get_statistics_all_users', getUsers)\r\n                const all = res.data[0].get_statistics_all_users[0]['all_users'].sort((a, b) => a.user_name.localeCompare(b.user_name))\r\n\r\n                let all_users = filterUsersFoo(all)\r\n\r\n                if (res.data[0].get_statistics_all_users[0]['all_users'] === null && !!~document.location.href.indexOf('/all_users/')) {\r\n                    alert('Нет не одного пользователя в работе')\r\n                }\r\n                if (res.data[0].get_statistics_all_users[0]['not_working_today'] === null && !!~document.location.href.indexOf('/not_working_today/')) {\r\n                    alert('Сегодня все в работе')\r\n                    window.location.href = `/department/${localUser.departmentId}`\r\n                }\r\n                if (res.data[0].get_statistics_all_users[0]['not_worked_yesterday'] === null && !!~document.location.href.indexOf('/not_worked_yesterday/')) {\r\n                    alert('Вчера все работали')\r\n                    window.location.href = `/department/${localUser.departmentId}`\r\n                }\r\n                if (res.data[0].get_statistics_all_users[0]['sick_today'] === null && !!~document.location.href.indexOf('/sick_today/')) {\r\n                    alert('Нет болеющих сегодня')\r\n                    window.location.href = `/department/${localUser.departmentId}`\r\n                }\r\n                if (res.data[0].get_statistics_all_users[0]['sick_yesterday'] === null && !!~document.location.href.indexOf('/sick_yesterday')) {\r\n                    alert('Вчера не было сотрудников на больничном')\r\n                    window.location.href = `/department/${localUser.main_department}`\r\n                }\r\n                if (res.data[0].get_statistics_all_users[0]['vacation_today'] === null && !!~document.location.href.indexOf('/vacation_today')) {\r\n                    alert('На сегодня нет сотрудников в отпуске')\r\n                    window.location.href = `/department/${localUser.main_department}`\r\n                }\r\n                if (res.data[0].get_statistics_all_users[0]['vacation_yesterday'] === null && !!~document.location.href.indexOf('/vacation_yesterday')) {\r\n                    alert('Вчера не было сотрудников в отпуске')\r\n                    window.location.href = `/department/${localUser.main_department}`\r\n                }\r\n                if (!!~document.location.href.indexOf('/all_users/')) {\r\n                    setIsJob(isJob)\r\n                    setStatisticsWork(all_users)\r\n                }\r\n                if (!!~document.location.href.indexOf('/not_working_today/')) {\r\n                    if (res.data[0].get_statistics_all_users[0]['not_working_today'] === null) {\r\n\r\n                    } else {\r\n                        setIsJob(isJob)\r\n                        const sort = res.data[0].get_statistics_all_users[0]['not_working_today'].sort((a, b) => a.user_name.localeCompare(b.user_name))\r\n                        setStatisticsWork(filterUsersFoo(sort))\r\n                    }\r\n                }\r\n\r\n                if (!!~document.location.href.indexOf('/not_worked_yesterday/')) {\r\n                    if (res.data[0].get_statistics_all_users[0]['not_worked_yesterday'] === null) {\r\n\r\n                    } else {\r\n                        setIsJob(isJob)\r\n                        const sort = res.data[0].get_statistics_all_users[0]['not_worked_yesterday'].sort((a, b) => a.user_name.localeCompare(b.user_name))\r\n                        setStatisticsWork(filterUsersFoo(sort))\r\n                    }\r\n                }\r\n\r\n                if (!!~document.location.href.indexOf('/sick_today/')) {\r\n                    if (res.data[0].get_statistics_all_users[0]['sick_today'] === null) {\r\n\r\n                    } else {\r\n                        setIsJob(isJob)\r\n                        const sort = res.data[0].get_statistics_all_users[0]['sick_today'].sort((a, b) => a.user_name.localeCompare(b.user_name))\r\n                        setStatisticsWork(filterUsersFoo(sort))\r\n                    }\r\n                }\r\n\r\n                if (!!~document.location.href.indexOf('/sick_yesterday/')) {\r\n                    if (res.data[0].get_statistics_all_users[0]['sick_yesterday'] === null) {\r\n\r\n                    } else {\r\n                        setIsJob(isJob)\r\n                        const sort = res.data[0].get_statistics_all_users[0]['sick_yesterday'].sort((a, b) => a.user_name.localeCompare(b.user_name))\r\n                        setStatisticsWork(filterUsersFoo(sort))\r\n                    }\r\n                }\r\n\r\n                if (!!~document.location.href.indexOf('/vacation_today/')) {\r\n                    if (res.data[0].get_statistics_all_users[0]['vacation_today'] === null) {\r\n\r\n                    } else {\r\n                        setIsJob(isJob)\r\n                        const sort = res.data[0].get_statistics_all_users[0]['vacation_today'].sort((a, b) => a.user_name.localeCompare(b.user_name))\r\n                        setStatisticsWork(filterUsersFoo(sort))\r\n                    }\r\n                }\r\n\r\n                if (!!~document.location.href.indexOf('/vacation_yesterday/')) {\r\n                    if (res.data[0].get_statistics_all_users[0]['vacation_yesterday'] === null) {\r\n\r\n                    } else {\r\n                        setIsJob(isJob)\r\n                        const sort = res.data[0].get_statistics_all_users[0]['vacation_yesterday'].sort((a, b) => a.user_name.localeCompare(b.user_name))\r\n                        setStatisticsWork(filterUsersFoo(sort))\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n\r\n        // функция показывает нажата ли галочка показать дочернии\r\n        const statusChild = async () => {\r\n            const user = await axios.get('/api/user/' + localUser._id)\r\n            setChecked(user.data.see_child)\r\n            setUser(user.data)\r\n        }\r\n\r\n        const fetchUsers = async () => {\r\n            const res = await axios.get('/api/user');\r\n            res.data.sort((a, b) => a.user_name.localeCompare(b.user_name));\r\n            const filteredUsers = filterUsersFoo(res.data);\r\n            return filteredUsers.filter(user => user.department_id === departId);\r\n        };\r\n\r\n        const getUsersByDepIsCheckedTrue = async () => {\r\n            const info = { depsId: departId };\r\n            const res = await axios.post('/api/get_users_by_dep/', info);\r\n            const depUsers = res.data[0].get_users_by_dep;\r\n            if (depUsers === null) {\r\n                return [];\r\n            } else {\r\n                const sortedUsers = depUsers.sort((a, b) => a.user_name.localeCompare(b.user_name));\r\n                const filteredUsers = filterUsersFoo(sortedUsers);\r\n                return filteredUsers;\r\n            }\r\n        };\r\n\r\n        const combineUsers = async () => {\r\n            try {\r\n                const users = await fetchUsers();\r\n                let combinedArray = [];\r\n\r\n                if (checked && user.main_department===departId) {\r\n                    setIsJob(false)\r\n                    const us = await getUsersByDepIsCheckedTrue();\r\n                    combinedArray = combinedArray.concat(us);\r\n                } else {\r\n                    combinedArray = users;\r\n                }\r\n\r\n                setUsers(combinedArray);\r\n            } catch (error) {\r\n                console.error('Ошибка при объединении пользователей:', error);\r\n            }\r\n        };\r\n\r\n        // Вызов функции combineUsers для получения и объединения пользователей\r\n        combineUsers();\r\n\r\n\r\n        setIsJob(true)\r\n\r\n        if(departId){\r\n            setUsersDeps([])\r\n        }\r\n        get_statistics_all_users()\r\n        statusChild()\r\n\r\n\r\n    }, [departId,user.main_department])\r\n\r\n\r\n\r\n\r\n    //Сортировка пользователей по статусам\r\n    function filterUsersFoo(users) {\r\n        return users.filter(user => user.status === 1)\r\n            .concat(users.filter(user => user.status === 2))\r\n            .concat(users.filter(user => user.status === 3))\r\n            .concat(users.filter(user => user.status !== 1 && user.status !== 2 && user.status !== 3 && user.status !== 4))\r\n            .concat(users.filter(user => user.status === 4))\r\n    }\r\n\r\n\r\n    const clickcheckbox = async () => {\r\n        setChecked(!checked)\r\n        const info = {\r\n            userId: localUser._id,\r\n            ischeked: !checked\r\n        };\r\n        await axios.post('/api/statusChild/', info);\r\n\r\n    }\r\n\r\n    const handleModalClick = async () => {\r\n        const add = {\r\n            id: localUser._id,\r\n            depsId: departId\r\n        }\r\n        const res = await axios.put('/api/user', add)\r\n        setModalMain(false)\r\n    }\r\n\r\n\r\n\r\n    const get_users_by_depIsOpen = async () => {\r\n\r\n        if (isJob) {\r\n            const info = {\r\n                depsId: departId\r\n            }\r\n            const res = await axios.post('/api/get_users_by_dep/', info)\r\n            const dep_users = res.data[0]['get_users_by_dep']\r\n            if (dep_users !== null) {\r\n                dep_users.sort((a, b) => a.user_name.localeCompare(b.user_name))\r\n                let filterUsers = filterUsersFoo(dep_users)\r\n                setUsersDeps(filterUsers)\r\n                setUsers([])\r\n                setIsJob(!isJob)\r\n                setIsOpen(true)\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    return (\r\n\r\n        <div className='staff'>\r\n            <>\r\n                {departId && (\r\n                    <>\r\n                        {isJob ?\r\n                            <button onClick={get_users_by_depIsOpen} className=\"btnStaff\" style={{ width: '155px' }}>\r\n                                Показать дочерние\r\n                            </button>\r\n                            :\r\n                            <button onClick={() => window.location.href = `/department/${departId}`} className=\"btnStaff\" disabled={checked && user.main_department === departId}>\r\n                                Скрыть дочерние\r\n                            </button>\r\n                        }\r\n                        <button onClick={() => setModalMain(true)} className='btnStaff' style={{ float: 'right' }}>Сделать главной</button>\r\n                        {localUser.isAdmin ? <Link to={`/VacanciesView/`}><button className=\"btnStaff\">Показать вакансии</button></Link> : ''}\r\n                    </>\r\n                )}\r\n            </>\r\n\r\n\r\n            <div className=\"employeeWrapper\">\r\n\r\n                {\r\n                    users.map((user, id) => <Employee key={id} user={user} />)\r\n                }\r\n\r\n                {isOpen ?\r\n                    UsersDep.map((user, id) => <Employee key={id} user={user} />)\r\n                    :''\r\n\r\n                }\r\n\r\n                {!departId\r\n                    ? statisticsWork.map((user, id) => <Employee key={id} user={user} />)\r\n                    :''\r\n\r\n                }\r\n            </div>\r\n            <Modal active={modalMain} setActive={setModalMain}>\r\n                <h1>Изменение информации:</h1>\r\n                <hr/>\r\n                <form className=\"modalLoginBox\">\r\n                    <label>\r\n                        <input\r\n                            type='checkbox'\r\n                            onChange={clickcheckbox}\r\n                            checked={checked}\r\n                        />\r\n                        Добавить дочерние</label>\r\n                    <button className=\"ModalButtonDepartment\" type=\"submit\" onClick={handleModalClick}>\r\n                        Сделать главным департаментом\r\n                    </button>\r\n                </form>\r\n            </Modal>\r\n        </div>\r\n    )\r\n}\r\n"]},"metadata":{},"sourceType":"module"}