{"ast":null,"code":"import _objectSpread from\"D:/time_app/client/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"D:/time_app/client/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"D:/time_app/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"D:/time_app/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import axios from'axios';import React,{useEffect,useState}from'react';import{Link,useParams}from\"react-router-dom\";import{Create,Delete,Settings,Message}from'@material-ui/icons';import Skills from'../ProfileInfo/Skills/Skills';import ModalVacanciesItem from\"../VacanciesItem/ModalVacanciesItem/ModalVacanciesItem\";import ModalVacancies from\"../Templates/ModalVacancies/ModalVacancies\";import Editing from\"./Editing/Editing\";import'./ProfileInfo.css';import DeleteUser from\"./DeleteUser/DeleteUser\";import ResetPassword from\"./ResetPassword/ResetPassword\";import FinishTime from\"./FinishTime/FinishTime\";import AddNomination from\"./AddNomination/AddNomination\";import ChangePassword from\"./СhangePassword/СhangePassword\";import VoteNominations from\"./VoteNominations/VoteNominations\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function ProfileInfo(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),timeZone=_useState2[0],setTimeZone=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),hasImage=_useState4[0],setHasImage=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),allDateUser=_useState6[0],setAllDateUser=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),modalVacancies=_useState8[0],setModalVacancies=_useState8[1];var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),depsName=_useState10[0],setDepsName=_useState10[1];var _useState11=useState([]),_useState12=_slicedToArray(_useState11,2),cityName=_useState12[0],setCityName=_useState12[1];var _useState13=useState([]),_useState14=_slicedToArray(_useState13,2),user=_useState14[0],setUser=_useState14[1];var _useState15=useState(false),_useState16=_slicedToArray(_useState15,2),isFetching=_useState16[0],setIsFetching=_useState16[1];var _useState17=useState(false),_useState18=_slicedToArray(_useState17,2),modalActive=_useState18[0],setModalActive=_useState18[1];var _useState19=useState(false),_useState20=_slicedToArray(_useState19,2),modalActivePass=_useState20[0],setModalActivePass=_useState20[1];var _useState21=useState(false),_useState22=_slicedToArray(_useState21,2),modalActiveVote=_useState22[0],setModalActiveVote=_useState22[1];var _useState23=useState(false),_useState24=_slicedToArray(_useState23,2),modalVote=_useState24[0],setModalVote=_useState24[1];var _useState25=useState(false),_useState26=_slicedToArray(_useState25,2),modalResetPassword=_useState26[0],setModalResetPassword=_useState26[1];var _useState27=useState(false),_useState28=_slicedToArray(_useState27,2),modalFinishTime=_useState28[0],setModalFinishTime=_useState28[1];var _useState29=useState(false),_useState30=_slicedToArray(_useState29,2),modalActiveDelete=_useState30[0],setModalActiveDelete=_useState30[1];var _useState31=useState(false),_useState32=_slicedToArray(_useState31,2),modalActiveSkills=_useState32[0],setModalActiveSkills=_useState32[1];var username=useParams();var localUser=!!username?{_id:username.username,email:\"\"}:JSON.parse(localStorage.getItem('user'));var localUse=JSON.parse(localStorage.getItem('user'));var usersStatuses={0:'',1:'start',2:'end',3:'sick_leave',4:'deleted',5:'vacation',6:'time_off',7:'other'};function findStatus(k){for(var i in usersStatuses){if(i==k){return usersStatuses[i];}}}useEffect(function(){var hasImageStatus=Object.keys(images).some(function(key){return user.nomination_status===key||user.nomination_status===parseInt(key);});setHasImage(hasImageStatus);var getNameDeps=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var deps,res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:deps={user:username.username};_context.next=3;return axios.post('/api/departments/',deps);case 3:res=_context.sent;setTimeZone(res.data[0]['timezone']);setDepsName(res.data[0]['department_name']);setCityName(res.data[0]['city_name']);case 7:case\"end\":return _context.stop();}}},_callee);}));return function getNameDeps(){return _ref.apply(this,arguments);};}();var fetchUser=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var res;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:localUser._id=!!localUser._id?localUser._id:localUser.id;localUser._id=!!username?username.username:localUser._id;_context2.next=4;return axios.get('/api/user/'+username.username);case 4:res=_context2.sent;setUser(res.data);setIsFetching(false);case 7:case\"end\":return _context2.stop();}}},_callee2);}));return function fetchUser(){return _ref2.apply(this,arguments);};}();fetchUser();getNameDeps();},[user.user_name,user.email,user.phone_number,user.additional_contact,user.distribution_group,user.activity_profile,user.place_of_residence,username.username]);localUser=!!user&&!Array.isArray(user)?user:localUser;localUser.username=!!localUser.user_name?localUser.user_name:localUser.username;var name=localUser.email.toLowerCase();var images={'1':{src:'../images/1.png',title:'Тучка'},'2':{src:'../images/2.png',title:'Аркадий Паровозов'},'3':{src:'../images/3.png',title:'И так сойдет'},'4':{src:'../images/4.png',title:'Портной'},'5':{src:'../images/5.png',title:'Мама обезьянка'},'6':{src:'../images/6.png',title:'Кот Матроскин'},'7':{src:'../images/7.png',title:'Крот'},'8':{src:'../images/8.png',title:'Птица говорун(голосуем только среди дежурных)'},'9':{src:'../images/9.png',title:'Хома(Голосуем среди коллег из внедрения)'},'10':{src:'../images/10.png',title:'Симка и нолик'}};var getChangeVacancies=function getChangeVacancies(){if(localUse.isAdmin){setModalVacancies(true);setAllDateUser(user);}};var updateNominationStatus=function updateNominationStatus(newStatus){setUser(function(prevState){return _objectSpread(_objectSpread({},prevState),{},{nomination_status:newStatus});});};return/*#__PURE__*/_jsxs(\"div\",{className:\"profileInfo\",children:[Object.keys(images).map(function(key,id){return(user.nomination_status===key||user.nomination_status===parseInt(key))&&/*#__PURE__*/_jsx(\"img\",{src:images[key].src,title:images[key].title,alt:\"Image for \".concat(key),className:\"imagesProfile\"},id);}),isFetching?/*#__PURE__*/_jsx(\"div\",{className:\"isFatching\",children:\"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430...\"}):/*#__PURE__*/_jsxs(\"div\",{className:'employeePI '+findStatus(user.status),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"ProfileName\",style:{paddingTop:hasImage?'10px':'0px'},children:[user.user_name,localUse.isAdmin||localUse._id===username.username?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Create,{style:{cursor:'pointer',fontSize:'20px',paddingLeft:'5px'},onClick:function onClick(){return setModalActive(true);}}),/*#__PURE__*/_jsx(Editing,{modalActive:modalActive,setModalActive:setModalActive})]}):'',localUse.isAdmin?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Delete,{style:{cursor:'pointer',fontSize:'20px'},onClick:function onClick(){return setModalActiveDelete(true);}}),/*#__PURE__*/_jsx(DeleteUser,{modalActiveDelete:modalActiveDelete,setModalActiveDelete:setModalActiveDelete,username:username.username,user:user.id})]}):'',localUse.isAdmin===true&&localUse._id===user.id?/*#__PURE__*/_jsx(Link,{to:\"/AdminPanel\",children:/*#__PURE__*/_jsx(Settings,{style:{cursor:'pointer',fontSize:'20px',paddingTop:'5px',color:'black'}})}):'']}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"label\",{style:{cursor:'pointer'},onClick:getChangeVacancies,className:\"ProfileLinkVacancies\",children:user.vacancy_code})}),/*#__PURE__*/_jsxs(\"div\",{style:{border:'3px dashed black',padding:'10px'},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"ProfileInfoCard\",children:[\"Email: \",name.charAt(0).toUpperCase()+name.slice(1)]}),/*#__PURE__*/_jsxs(\"div\",{className:\"ProfileInfoCard\",children:[\"\\u0422\\u0435\\u043B\\u0435\\u0444\\u043E\\u043D: \",user.phone_number]}),/*#__PURE__*/_jsxs(\"div\",{className:\"ProfileInfoCard\",children:[localUse.isAdmin!==false||localUse._id===username.username?'Доп.Контакт: ':'',localUse.isAdmin!==false||localUse._id===username.username?user.additional_contact:'']}),/*#__PURE__*/_jsxs(\"div\",{className:\"ProfileInfoCard\",children:[\"\\u0413\\u0440\\u0443\\u043F\\u043F\\u0430 \\u0440\\u0430\\u0441\\u0441\\u044B\\u043B\\u043A\\u0438: \",user.distribution_group]}),/*#__PURE__*/_jsxs(\"div\",{className:\"ProfileInfoCard\",children:[\"\\u041F\\u0440\\u043E\\u0444\\u0438\\u043B\\u044C \\u0434\\u0435\\u044F\\u0442\\u0435\\u043B\\u044C\\u043D\\u043E\\u0441\\u0442\\u0438: \",user.activity_profile]}),/*#__PURE__*/_jsxs(\"div\",{className:\"ProfileInfoCard\",children:[\"\\u0413\\u043E\\u0440\\u043E\\u0434 \\u043F\\u0440\\u043E\\u0436\\u0438\\u0432\\u0430\\u043D\\u0438\\u044F: \",cityName]}),/*#__PURE__*/_jsxs(\"div\",{className:\"ProfileInfoCard\",children:[localUse.isAdmin!==false||localUse._id===username.username?'Адрес фактического проживания: ':'',localUse.isAdmin!==false||localUse._id===username.username?user.place_of_residence:'']}),/*#__PURE__*/_jsxs(\"div\",{className:\"ProfileInfoCard\",children:[\"\\u041F\\u043E\\u0434\\u0440\\u0430\\u0437\\u0434\\u0435\\u043B\\u0435\\u043D\\u0438\\u0435: \",depsName]})]}),localUse.isAdmin||localUse._id===username.username?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"changePass\",onClick:function onClick(){return setModalActivePass(true);},children:\"\\u0418\\u0437\\u043C\\u0435\\u043D\\u0438\\u0442\\u044C \\u043F\\u0430\\u0440\\u043E\\u043B\\u044C\"}),/*#__PURE__*/_jsx(ChangePassword,{modalActivePass:modalActivePass,setModalActivePass:setModalActivePass})]}):'',localUse.isAdmin?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"changePass\",onClick:function onClick(){return setModalResetPassword(true);},children:\"\\u0421\\u0431\\u0440\\u043E\\u0441\\u0438\\u0442\\u044C \\u043F\\u0430\\u0440\\u043E\\u043B\\u044C\"}),/*#__PURE__*/_jsx(ResetPassword,{modalResetPassword:modalResetPassword,setModalResetPassword:setModalResetPassword,username:username.username})]}):'',localUse.isAdmin?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"changePass\",onClick:function onClick(){return setModalFinishTime(true);},children:\"\\u0417\\u0430\\u043A\\u043E\\u043D\\u0447\\u0438\\u0442\\u044C\"}),/*#__PURE__*/_jsx(FinishTime,{modalFinishTime:modalFinishTime,setModalFinishTime:setModalFinishTime,user:user.id,status:user.status})]}):'',localUse._id===user.id?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"changePass\",onClick:function onClick(){return setModalActiveVote(true);},children:\"\\u041F\\u0440\\u043E\\u0433\\u043E\\u043B\\u043E\\u0441\\u043E\\u0432\\u0430\\u0442\\u044C\"}),/*#__PURE__*/_jsx(VoteNominations,{modalActiveVote:modalActiveVote,setModalActiveVote:setModalActiveVote,username:username})]}):'',localUse.isAdmin?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"changePass\",onClick:function onClick(){return setModalVote(true);},children:\"\\u0417\\u0430\\u043A\\u0440\\u0435\\u043F\\u0438\\u0442\\u044C \\u043D\\u043E\\u043C\\u0438\\u043D\\u0430\\u0446\\u0438\\u044E\"}),/*#__PURE__*/_jsx(AddNomination,{modalVote:modalVote,setModalVote:setModalVote,username:username,updateNominationStatus:updateNominationStatus})]}):'',/*#__PURE__*/_jsx(\"div\",{className:\"changePass\",onClick:function onClick(){return setModalActiveSkills(true);},children:\"\\u041D\\u0430\\u0432\\u044B\\u043A\\u0438\"}),/*#__PURE__*/_jsx(Skills,{modalActiveSkills:modalActiveSkills,setModalActiveSkills:setModalActiveSkills})]}),/*#__PURE__*/_jsx(ModalVacancies,{active:modalVacancies,setActive:setModalVacancies,children:/*#__PURE__*/_jsx(ModalVacanciesItem,{allDateUser:allDateUser})}),/*#__PURE__*/_jsx(Skills,{})]});}","map":{"version":3,"sources":["D:/time_app/client/src/components/ProfileInfo/ProfileInfo.jsx"],"names":["axios","React","useEffect","useState","Link","useParams","Create","Delete","Settings","Message","Skills","ModalVacanciesItem","ModalVacancies","Editing","DeleteUser","ResetPassword","FinishTime","AddNomination","ChangePassword","VoteNominations","ProfileInfo","timeZone","setTimeZone","hasImage","setHasImage","allDateUser","setAllDateUser","modalVacancies","setModalVacancies","depsName","setDepsName","cityName","setCityName","user","setUser","isFetching","setIsFetching","modalActive","setModalActive","modalActivePass","setModalActivePass","modalActiveVote","setModalActiveVote","modalVote","setModalVote","modalResetPassword","setModalResetPassword","modalFinishTime","setModalFinishTime","modalActiveDelete","setModalActiveDelete","modalActiveSkills","setModalActiveSkills","username","localUser","_id","email","JSON","parse","localStorage","getItem","localUse","usersStatuses","findStatus","k","i","hasImageStatus","Object","keys","images","some","key","nomination_status","parseInt","getNameDeps","deps","post","res","data","fetchUser","id","get","user_name","phone_number","additional_contact","distribution_group","activity_profile","place_of_residence","Array","isArray","name","toLowerCase","src","title","getChangeVacancies","isAdmin","updateNominationStatus","newStatus","prevState","map","status","paddingTop","cursor","fontSize","paddingLeft","color","vacancy_code","border","padding","charAt","toUpperCase","slice"],"mappings":"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","sourcesContent":["import axios from 'axios'\nimport React, { useEffect, useState } from 'react'\nimport { Link, useParams } from \"react-router-dom\";\nimport { Create, Delete, Settings, Message } from '@material-ui/icons'\n\nimport Skills from '../ProfileInfo/Skills/Skills'\n\nimport ModalVacanciesItem from \"../VacanciesItem/ModalVacanciesItem/ModalVacanciesItem\";\nimport ModalVacancies from \"../Templates/ModalVacancies/ModalVacancies\";\nimport Editing from \"./Editing/Editing\"\n\nimport './ProfileInfo.css'\nimport DeleteUser from \"./DeleteUser/DeleteUser\";\nimport ResetPassword from \"./ResetPassword/ResetPassword\";\nimport FinishTime from \"./FinishTime/FinishTime\";\nimport AddNomination from \"./AddNomination/AddNomination\";\nimport ChangePassword from \"./СhangePassword/СhangePassword\";\nimport VoteNominations from \"./VoteNominations/VoteNominations\";\n\nexport default function ProfileInfo() {\n\n    const [timeZone, setTimeZone] = useState([])\n    const [hasImage, setHasImage] = useState(false);\n    const [allDateUser, setAllDateUser] = useState()\n\n    const [modalVacancies, setModalVacancies] = useState(false)\n\n    const [depsName, setDepsName] = useState([])\n\n    const [cityName, setCityName] = useState([])\n\n    const [user, setUser] = useState([])\n\n    const [isFetching, setIsFetching] = useState(false)\n\n    const [modalActive, setModalActive] = useState(false)\n\n    const [modalActivePass, setModalActivePass] = useState(false)\n\n    const [modalActiveVote, setModalActiveVote] = useState(false)\n\n    const [modalVote, setModalVote] = useState(false)\n\n    const [modalResetPassword, setModalResetPassword] = useState(false)\n\n    const [modalFinishTime, setModalFinishTime] = useState(false)\n\n    const [modalActiveDelete, setModalActiveDelete] = useState(false)\n\n    const [modalActiveSkills, setModalActiveSkills] = useState(false)\n\n    const username = useParams()\n\n\n    let localUser = !!username ? {_id: username.username, email: \"\"} : JSON.parse(localStorage.getItem('user'))\n    const localUse = JSON.parse(localStorage.getItem('user'))\n\n\n    const usersStatuses = {\n        0: '',\n        1: 'start',\n        2: 'end',\n        3: 'sick_leave',\n        4: 'deleted',\n        5: 'vacation',\n        6: 'time_off',\n        7: 'other'\n    }\n\n    function findStatus(k) {\n        for (let i in usersStatuses) {\n            if (i == k) {\n                return usersStatuses[i]\n            }\n        }\n    }\n\n    useEffect(() => {\n\n        const hasImageStatus = Object.keys(images).some(key =>\n            user.nomination_status === key || user.nomination_status === parseInt(key)\n        );\n        setHasImage(hasImageStatus);\n\n        const getNameDeps = async () => {\n            const deps = {\n                user: username.username\n            }\n            const res = await axios.post('/api/departments/', deps)\n            setTimeZone(res.data[0]['timezone'])\n            setDepsName(res.data[0]['department_name'])\n            setCityName(res.data[0]['city_name'])\n        }\n\n        const fetchUser = async () => {\n            localUser._id = !!localUser._id ? localUser._id : localUser.id\n            localUser._id = !!username ? username.username : localUser._id\n            const res = await axios.get('/api/user/' + username.username)\n            setUser(res.data)\n            setIsFetching(false)\n\n        }\n        fetchUser()\n        getNameDeps()\n    }, [\n        user.user_name,\n        user.email,\n        user.phone_number,\n        user.additional_contact,\n        user.distribution_group,\n        user.activity_profile,\n        user.place_of_residence,\n        username.username,\n    ])\n\n\n    localUser = (!!user && !Array.isArray(user)) ? user : localUser\n    localUser.username = !!localUser.user_name ? localUser.user_name : localUser.username\n    const name = localUser.email.toLowerCase()\n\n\n    const images = {\n        '1': {src: '../images/1.png', title: 'Тучка'},\n        '2': {src: '../images/2.png', title: 'Аркадий Паровозов'},\n        '3': {src: '../images/3.png', title: 'И так сойдет'},\n        '4': {src: '../images/4.png', title: 'Портной'},\n        '5': {src: '../images/5.png', title: 'Мама обезьянка'},\n        '6': {src: '../images/6.png', title: 'Кот Матроскин'},\n        '7': {src: '../images/7.png', title: 'Крот'},\n        '8': {src: '../images/8.png', title: 'Птица говорун(голосуем только среди дежурных)'},\n        '9': {src: '../images/9.png', title: 'Хома(Голосуем среди коллег из внедрения)'},\n        '10': {src: '../images/10.png', title: 'Симка и нолик'}\n    };\n\n\n\n    const getChangeVacancies = () => {\n        if (localUse.isAdmin) {\n            setModalVacancies(true)\n            setAllDateUser(user)\n        }\n    }\n    const updateNominationStatus = (newStatus) => {\n        setUser(prevState => ({\n            ...prevState,\n            nomination_status: newStatus\n        }));\n    };\n\n    return (\n\n        <div className='profileInfo'>\n\n            {Object.keys(images).map((key, id) => (\n                (user.nomination_status === key || user.nomination_status === parseInt(key)) &&\n                <img\n                    key={id}\n                    src={images[key].src}\n                    title={images[key].title}\n                    alt={`Image for ${key}`}\n                    className='imagesProfile'\n                />\n            ))}\n\n            {isFetching ? <div className='isFatching'>Загрузка...</div> :\n                <div className={'employeePI ' + (findStatus(user.status))}>\n                    <div className='ProfileName' style={{ paddingTop: hasImage ? '10px' : '0px' }}>\n\n                        {user.user_name}\n\n                        {localUse.isAdmin || localUse._id === username.username\n                            ?\n                            <>\n                                <Create style={{cursor: 'pointer', fontSize: '20px', paddingLeft: '5px'}}\n                                        onClick={() => setModalActive(true)}/>\n                                <Editing modalActive={modalActive} setModalActive={setModalActive}/>\n                            </>\n                            : ''}\n\n                        {localUse.isAdmin ?\n                            <>\n                                <Delete style={{cursor: 'pointer', fontSize: '20px'}}\n                                        onClick={() => setModalActiveDelete(true)}/>\n                                <DeleteUser modalActiveDelete={modalActiveDelete}\n                                            setModalActiveDelete={setModalActiveDelete} username={username.username}\n                                            user={user.id}/>\n                            </>\n                            : ''}\n\n\n                        {localUse.isAdmin === true && localUse._id === user.id ?\n                            <Link to={`/AdminPanel`}>\n                                <Settings\n                                    style={{cursor: 'pointer', fontSize: '20px', paddingTop: '5px', color: 'black'}}/>\n                            </Link>\n                            : ''}\n                    </div>\n\n\n                    <div>\n                        <label style={{cursor: 'pointer'}} onClick={getChangeVacancies}\n                               className='ProfileLinkVacancies'>{user.vacancy_code}</label>\n                    </div>\n\n\n{/*                    {\n                        <Message style={{cursor: 'pointer', fontSize: 'large'}} />\n                    }*/}\n\n\n                    <div style={{border: '3px dashed black', padding: '10px'}}>\n                        <div className='ProfileInfoCard'>Email: {name.charAt(0).toUpperCase() + name.slice(1)}</div>\n                        <div className='ProfileInfoCard'>Телефон: {user.phone_number}</div>\n                        <div className='ProfileInfoCard'>\n                            {localUse.isAdmin !== false || localUse._id === username.username ? 'Доп.Контакт: ' : ''}\n                            {localUse.isAdmin !== false || localUse._id === username.username ? user.additional_contact : ''}\n                        </div>\n                        <div className='ProfileInfoCard'>Группа рассылки: {user.distribution_group}</div>\n                        <div className='ProfileInfoCard'>Профиль деятельности: {user.activity_profile}</div>\n                        <div className='ProfileInfoCard'>Город проживания: {cityName}</div>\n                        <div className='ProfileInfoCard'>\n                            {localUse.isAdmin !== false || localUse._id === username.username ? 'Адрес фактического проживания: ' : ''}\n                            {localUse.isAdmin !== false || localUse._id === username.username ? user.place_of_residence : ''}\n                        </div>\n                        <div className='ProfileInfoCard'>Подразделение: {depsName}</div>\n                    </div>\n\n                    {\n                        localUse.isAdmin || localUse._id === username.username ? <>\n                            <div className='changePass' onClick={() => setModalActivePass(true)}>Изменить пароль</div>\n                            <ChangePassword modalActivePass={modalActivePass} setModalActivePass={setModalActivePass}/>\n                        </> : ''\n\n                    }\n\n                    {\n                        localUse.isAdmin ?\n                            <>\n                                <div className='changePass' onClick={() => setModalResetPassword(true)}>Сбросить\n                                    пароль\n                                </div>\n                                <ResetPassword modalResetPassword={modalResetPassword}\n                                               setModalResetPassword={setModalResetPassword}\n                                               username={username.username}/>\n                            </>\n                            : ''\n                    }\n\n                    {\n                        localUse.isAdmin ?\n                            <>\n                                <div className='changePass' onClick={() => setModalFinishTime(true)}>Закончить</div>\n                                <FinishTime modalFinishTime={modalFinishTime} setModalFinishTime={setModalFinishTime}\n                                            user={user.id} status={user.status}/>\n                            </>\n                            : ''\n                    }\n\n                    {\n                        localUse._id === user.id ?<>\n                            <div className='changePass'\n                                 onClick={() => setModalActiveVote(true)}>Проголосовать</div>\n                            <VoteNominations modalActiveVote={modalActiveVote} setModalActiveVote={setModalActiveVote} username={username}/>\n                            </>\n                            : ''\n                    }\n\n                    {\n                        localUse.isAdmin ?\n                            <>\n                                <div className=\"changePass\" onClick={() => setModalVote(true)}>Закрепить номинацию</div>\n                                <AddNomination modalVote={modalVote} setModalVote={setModalVote} username={username}\n                                               updateNominationStatus={updateNominationStatus}/>\n                            </> : ''\n                    }\n                    <div className=\"changePass\" onClick={() => setModalActiveSkills(true)}>Навыки</div>\n                    <Skills modalActiveSkills={modalActiveSkills} setModalActiveSkills={setModalActiveSkills}/>\n                </div>\n            }\n            <ModalVacancies active={modalVacancies} setActive={setModalVacancies}>\n                <ModalVacanciesItem allDateUser={allDateUser}/>\n            </ModalVacancies>\n            <Skills/>\n        </div>\n    )\n}\n"]},"metadata":{},"sourceType":"module"}