{"ast":null,"code":"import _regeneratorRuntime from\"D:/time_app/client/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"D:/time_app/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"D:/time_app/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{Link,useParams}from'react-router-dom';import{useEffect,useState}from'react';import axios from'axios';import'./Employee.css';import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export default function Employee(_ref){var user=_ref.user;var _useState=useState(['']),_useState2=_slicedToArray(_useState,2),admin=_useState2[0],setAdmin=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),posts=_useState4[0],setPosts=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isFetching=_useState6[0],setIsFetching=_useState6[1];var _useState7=useState(null),_useState8=_slicedToArray(_useState7,2),date=_useState8[0],setDate=_useState8[1];var _useState9=useState(null),_useState10=_slicedToArray(_useState9,2),time=_useState10[0],setTime=_useState10[1];var _useState11=useState(null),_useState12=_slicedToArray(_useState11,2),dateStart=_useState12[0],setDateStart=_useState12[1];var _useState13=useState(null),_useState14=_slicedToArray(_useState13,2),dateEnd=_useState14[0],setDateEnd=_useState14[1];var username=useParams();var localUser=JSON.parse(localStorage.getItem('user'));var setDat=new Date();setDat.setDate(setDat.getDate());var usersStatuses={0:'',1:'start',2:'end',3:'sick_leave',4:'deleted',5:'vacation',6:'time_off',7:'other'};function findStatus(k){for(var i in usersStatuses){if(i==k){return usersStatuses[i];}}}// Проверка, если пользователь в отпуске или на больничном, то вывод даты начала и конца\nuseEffect(function(){var fetchUserpost=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res,users;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get('/api/post?type=1&id='+user.id);case 2:res=_context.sent;_context.next=5;return axios.get('/api/user/'+user.id);case 5:users=_context.sent;if(users.data.isadmin===true){setAdmin('*');}else{setAdmin('');}setDate('');setTime('');try{setDate(res.data[0].workdate);setTime(res.data[0].workend);}catch(_unused){}setPosts(res.data.sort(function(p1,p2){return new Date(p2.workstart)-new Date(p1.workstart);}));setIsFetching(false);case 12:case\"end\":return _context.stop();}}},_callee);}));return function fetchUserpost(){return _ref2.apply(this,arguments);};}();var fetchUser=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var res;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return axios.get('/api/vacation?id='+user.id);case 2:res=_context2.sent;if(res.data.length===0){setDateStart(global.workdate='');setDateEnd(global.worked='');}else{setDateStart(res.data[0].workdate);setDateEnd(res.data[0].worked);}case 4:case\"end\":return _context2.stop();}}},_callee2);}));return function fetchUser(){return _ref3.apply(this,arguments);};}();if(user.status===1){fetchUser();}if(user.status===3){fetchUser();}if(user.status===7){fetchUser();}if(user.status===6){fetchUser();}if(user.status===5){fetchUser();}if(user.status===2||user.nomination_status){fetchUserpost();}},[username._id]);var images={'1':{src:'../images/1.png',title:'Тучка'},'2':{src:'../images/2.png',title:'Аркадий Паровозов'},'3':{src:'../images/3.png',title:'И так сойдет'},'4':{src:'../images/4.png',title:'Портной'},'5':{src:'../images/5.png',title:'Мама обезьянка'},'6':{src:'../images/6.png',title:'Кот Матроскин'},'7':{src:'../images/7.png',title:'Крот'},'8':{src:'../images/8.png',title:'Птица говорун(голосуем только среди дежурных)'},'9':{src:'../images/9.png',title:'Хома(Голосуем среди коллег из внедрения)'},'10':{src:'../images/10.png',title:'Симка и нолик'}};return/*#__PURE__*/_jsx(_Fragment,{children:localUser.isAdmin?/*#__PURE__*/_jsx(Link,{to:\"/profile/\".concat(user.id),className:\"name\",children:/*#__PURE__*/_jsx(\"div\",{className:'employee '+findStatus(user.status),children:/*#__PURE__*/_jsxs(\"div\",{className:\"angry-grid\",children:[/*#__PURE__*/_jsx(\"div\",{id:\"item-0\",children:/*#__PURE__*/_jsxs(\"span\",{className:\"name\",children:[user.user_name,admin]})}),/*#__PURE__*/_jsxs(\"div\",{id:\"item-1\",children:[user.status===5&&/*#__PURE__*/_jsxs(\"div\",{className:\"vacationText\",children:[\"\\u041E\\u0442\\u043F\\u0443\\u0441\\u043A:\",dateStart,\"-\",dateEnd]}),user.status===6&&/*#__PURE__*/_jsxs(\"div\",{className:\"vacationText\",children:[\"\\u041E\\u0442\\u0433\\u0443\\u043B:\",dateStart,\"-\",dateEnd]}),user.status===7&&/*#__PURE__*/_jsxs(\"div\",{className:\"vacationText\",children:[\"\\u0414\\u0440\\u0443\\u0433\\u0430\\u044F \\u043F\\u0440\\u0438\\u0447\\u0438\\u043D\\u0430:\",dateStart,\"-\",dateEnd]}),user.status===3&&/*#__PURE__*/_jsxs(\"div\",{className:\"vacationText\",children:[\"\\u0411\\u043E\\u043B\\u044C\\u043D\\u0438\\u0447\\u043D\\u044B\\u0439:\",dateStart,\"-\",dateEnd]}),user.status===2&&/*#__PURE__*/_jsxs(\"div\",{className:\"vacationText\",children:[date,\" \",time]})]}),/*#__PURE__*/_jsx(\"div\",{id:\"item-2\",children:Object.keys(images).map(function(key,id){return(user.nomination_status===key||user.nomination_status===parseInt(key))&&/*#__PURE__*/_jsx(\"img\",{src:images[key].src,title:images[key].title,alt:\"Image for \".concat(key),className:\"images\"},id);})})]})})}):/*#__PURE__*/_jsx(\"div\",{className:'employee '+findStatus(user.status),children:/*#__PURE__*/_jsxs(\"div\",{className:\"angry-grid\",children:[/*#__PURE__*/_jsx(\"div\",{id:\"item-0\",children:/*#__PURE__*/_jsxs(\"span\",{className:\"name\",children:[user.user_name,admin]})}),/*#__PURE__*/_jsxs(\"div\",{id:\"item-1\",children:[user.status===5&&/*#__PURE__*/_jsxs(\"div\",{className:\"vacationText\",children:[\"\\u041E\\u0442\\u043F\\u0443\\u0441\\u043A:\",dateStart,\"-\",dateEnd]}),user.status===6&&/*#__PURE__*/_jsxs(\"div\",{className:\"vacationText\",children:[\"\\u041E\\u0442\\u0433\\u0443\\u043B:\",dateStart,\"-\",dateEnd]}),user.status===7&&/*#__PURE__*/_jsxs(\"div\",{className:\"vacationText\",children:[\"\\u0414\\u0440\\u0443\\u0433\\u0430\\u044F \\u043F\\u0440\\u0438\\u0447\\u0438\\u043D\\u0430:\",dateStart,\"-\",dateEnd]}),user.status===3&&/*#__PURE__*/_jsxs(\"div\",{className:\"vacationText\",children:[\"\\u0411\\u043E\\u043B\\u044C\\u043D\\u0438\\u0447\\u043D\\u044B\\u0439:\",dateStart,\"-\",dateEnd]}),user.status===2&&/*#__PURE__*/_jsxs(\"div\",{className:\"vacationText\",children:[date,\" \",time]})]}),/*#__PURE__*/_jsx(\"div\",{id:\"item-2\",children:Object.keys(images).map(function(key,id){return(user.nomination_status===key||user.nomination_status===parseInt(key))&&/*#__PURE__*/_jsx(\"img\",{src:images[key].src,title:images[key].title,alt:\"Image for \".concat(key),className:\"images\"},id);})})]})})});}/*<>\r\n  <div className={'employee ' + (findStatus(user.status))}>\r\n    <div className=\"angry-grid\">\r\n      <div id=\"item-0\">\r\n\r\n        {\r\n          localUser.isAdmin\r\n              ?\r\n              <Link to={`/profile/${user.id}`} className='name'><span\r\n                  className='name'>{user.user_name}{admin}</span></Link>\r\n              : <div className='name'><span className='name'>{user.user_name}{admin}</span></div>\r\n        }\r\n\r\n      </div>\r\n      <div id=\"item-1\">\r\n\r\n        {user.status === 5 && <div className='vacationText'>Отпуск:{dateStart}-{dateEnd}</div>}\r\n        {user.status === 6 && <div className='vacationText'>Отгул:{dateStart}-{dateEnd}</div>}\r\n        {user.status === 7 && <div className='vacationText'>Другая причина:{dateStart}-{dateEnd}</div>}\r\n        {user.status === 3 && <div className='vacationText'>Больничный:{dateStart}-{dateEnd}</div>}\r\n        {user.status === 2 && <div className='vacationText'>{date} {time}</div>}\r\n\r\n      </div>\r\n      <div id=\"item-2\">\r\n\r\n        {Object.keys(images).map((key, id) => (\r\n            (user.nomination_status === key || user.nomination_status === parseInt(key)) &&\r\n            <img\r\n                key={id}\r\n                src={images[key].src}\r\n                title={images[key].title}\r\n                alt={`Image for ${key}`}\r\n                className='images'\r\n            />\r\n        ))}\r\n\r\n      </div>\r\n    </div>\r\n  </div>\r\n</>*/","map":{"version":3,"sources":["D:/time_app/client/src/components/Employee/Employee.jsx"],"names":["Link","useParams","useEffect","useState","axios","Employee","user","admin","setAdmin","posts","setPosts","isFetching","setIsFetching","date","setDate","time","setTime","dateStart","setDateStart","dateEnd","setDateEnd","username","localUser","JSON","parse","localStorage","getItem","setDat","Date","getDate","usersStatuses","findStatus","k","i","fetchUserpost","get","id","res","users","data","isadmin","workdate","workend","sort","p1","p2","workstart","fetchUser","length","global","worked","status","nomination_status","_id","images","src","title","isAdmin","user_name","Object","keys","map","key","parseInt"],"mappings":"4SAAA,OAAQA,IAAR,CAAcC,SAAd,KAA8B,kBAA9B,CACA,OAAQC,SAAR,CAAmBC,QAAnB,KAAkC,OAAlC,CAEA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAO,gBAAP,C,6IAGA,cAAe,SAASC,CAAAA,QAAT,MAA0B,IAAPC,CAAAA,IAAO,MAAPA,IAAO,CAEvC,cAA0BH,QAAQ,CAAC,CAAC,EAAD,CAAD,CAAlC,wCAAOI,KAAP,eAAcC,QAAd,eACA,eAA0BL,QAAQ,CAAC,EAAD,CAAlC,yCAAOM,KAAP,eAAcC,QAAd,eACA,eAAoCP,QAAQ,CAAC,KAAD,CAA5C,yCAAOQ,UAAP,eAAmBC,aAAnB,eACA,eAAwBT,QAAQ,CAAC,IAAD,CAAhC,yCAAOU,IAAP,eAAaC,OAAb,eACA,eAAwBX,QAAQ,CAAC,IAAD,CAAhC,0CAAOY,IAAP,gBAAaC,OAAb,gBACA,gBAAkCb,QAAQ,CAAC,IAAD,CAA1C,2CAAOc,SAAP,gBAAkBC,YAAlB,gBACA,gBAA8Bf,QAAQ,CAAC,IAAD,CAAtC,2CAAOgB,OAAP,gBAAgBC,UAAhB,gBACA,GAAMC,CAAAA,QAAQ,CAAGpB,SAAS,EAA1B,CAGA,GAAMqB,CAAAA,SAAS,CAAGC,IAAI,CAACC,KAAL,CAAWC,YAAY,CAACC,OAAb,CAAqB,MAArB,CAAX,CAAlB,CAEA,GAAMC,CAAAA,MAAM,CAAG,GAAIC,CAAAA,IAAJ,EAAf,CACAD,MAAM,CAACb,OAAP,CAAea,MAAM,CAACE,OAAP,EAAf,EAGA,GAAMC,CAAAA,aAAa,CAAG,CACpB,EAAG,EADiB,CAEpB,EAAG,OAFiB,CAGpB,EAAG,KAHiB,CAIpB,EAAG,YAJiB,CAKpB,EAAG,SALiB,CAMpB,EAAG,UANiB,CAOpB,EAAG,UAPiB,CAQpB,EAAG,OARiB,CAAtB,CAWA,QAASC,CAAAA,UAAT,CAAoBC,CAApB,CAAuB,CACrB,IAAK,GAAIC,CAAAA,CAAT,GAAcH,CAAAA,aAAd,CAA6B,CAC3B,GAAIG,CAAC,EAAID,CAAT,CAAY,CACV,MAAOF,CAAAA,aAAa,CAACG,CAAD,CAApB,CACD,CACF,CACF,CAID;AACA/B,SAAS,CAAC,UAAM,CACd,GAAMgC,CAAAA,aAAa,2FAAG,uKACF9B,CAAAA,KAAK,CAAC+B,GAAN,CAAU,uBAAyB7B,IAAI,CAAC8B,EAAxC,CADE,QACdC,GADc,qCAEAjC,CAAAA,KAAK,CAAC+B,GAAN,CAAU,aAAe7B,IAAI,CAAC8B,EAA9B,CAFA,QAEdE,KAFc,eAIpB,GAAIA,KAAK,CAACC,IAAN,CAAWC,OAAX,GAAuB,IAA3B,CAAiC,CAC/BhC,QAAQ,CAAC,GAAD,CAAR,CACD,CAFD,IAEO,CACLA,QAAQ,CAAC,EAAD,CAAR,CACD,CAEDM,OAAO,CAAC,EAAD,CAAP,CACAE,OAAO,CAAC,EAAD,CAAP,CACA,GAAI,CACFF,OAAO,CAACuB,GAAG,CAACE,IAAJ,CAAS,CAAT,EAAYE,QAAb,CAAP,CACAzB,OAAO,CAACqB,GAAG,CAACE,IAAJ,CAAS,CAAT,EAAYG,OAAb,CAAP,CACD,CAAC,cAAM,CACP,CACDhC,QAAQ,CAAC2B,GAAG,CAACE,IAAJ,CAASI,IAAT,CAAc,SAACC,EAAD,CAAKC,EAAL,CAAY,CACjC,MAAO,IAAIjB,CAAAA,IAAJ,CAASiB,EAAE,CAACC,SAAZ,EAAyB,GAAIlB,CAAAA,IAAJ,CAASgB,EAAE,CAACE,SAAZ,CAAhC,CACD,CAFQ,CAAD,CAAR,CAGAlC,aAAa,CAAC,KAAD,CAAb,CApBoB,uDAAH,kBAAbsB,CAAAA,aAAa,2CAAnB,CAuBA,GAAMa,CAAAA,SAAS,2FAAG,uKACE3C,CAAAA,KAAK,CAAC+B,GAAN,CAAU,oBAAsB7B,IAAI,CAAC8B,EAArC,CADF,QACVC,GADU,gBAGhB,GAAIA,GAAG,CAACE,IAAJ,CAASS,MAAT,GAAoB,CAAxB,CAA2B,CACzB9B,YAAY,CAAC+B,MAAM,CAACR,QAAP,CAAkB,EAAnB,CAAZ,CACArB,UAAU,CAAC6B,MAAM,CAACC,MAAP,CAAgB,EAAjB,CAAV,CACD,CAHD,IAGO,CACLhC,YAAY,CAACmB,GAAG,CAACE,IAAJ,CAAS,CAAT,EAAYE,QAAb,CAAZ,CACArB,UAAU,CAACiB,GAAG,CAACE,IAAJ,CAAS,CAAT,EAAYW,MAAb,CAAV,CAED,CAVe,wDAAH,kBAATH,CAAAA,SAAS,2CAAf,CAcA,GAAIzC,IAAI,CAAC6C,MAAL,GAAgB,CAApB,CAAuB,CACrBJ,SAAS,GACV,CACD,GAAIzC,IAAI,CAAC6C,MAAL,GAAgB,CAApB,CAAuB,CACrBJ,SAAS,GACV,CAED,GAAIzC,IAAI,CAAC6C,MAAL,GAAgB,CAApB,CAAuB,CACrBJ,SAAS,GACV,CACD,GAAIzC,IAAI,CAAC6C,MAAL,GAAgB,CAApB,CAAuB,CACrBJ,SAAS,GACV,CAED,GAAIzC,IAAI,CAAC6C,MAAL,GAAgB,CAApB,CAAuB,CACrBJ,SAAS,GACV,CACD,GAAIzC,IAAI,CAAC6C,MAAL,GAAgB,CAAhB,EAAqB7C,IAAI,CAAC8C,iBAA9B,CAAiD,CAC/ClB,aAAa,GACd,CAGF,CA5DQ,CA4DN,CAACb,QAAQ,CAACgC,GAAV,CA5DM,CAAT,CA8DA,GAAMC,CAAAA,MAAM,CAAG,CACb,IAAK,CAAEC,GAAG,CAAE,iBAAP,CAA0BC,KAAK,CAAE,OAAjC,CADQ,CAEb,IAAK,CAAED,GAAG,CAAE,iBAAP,CAA0BC,KAAK,CAAE,mBAAjC,CAFQ,CAGb,IAAK,CAAED,GAAG,CAAE,iBAAP,CAA0BC,KAAK,CAAE,cAAjC,CAHQ,CAIb,IAAK,CAAED,GAAG,CAAE,iBAAP,CAA0BC,KAAK,CAAE,SAAjC,CAJQ,CAKb,IAAK,CAAED,GAAG,CAAE,iBAAP,CAA0BC,KAAK,CAAE,gBAAjC,CALQ,CAMb,IAAK,CAAED,GAAG,CAAE,iBAAP,CAA0BC,KAAK,CAAE,eAAjC,CANQ,CAOb,IAAK,CAAED,GAAG,CAAE,iBAAP,CAA0BC,KAAK,CAAE,MAAjC,CAPQ,CAQb,IAAK,CAAED,GAAG,CAAE,iBAAP,CAA0BC,KAAK,CAAE,+CAAjC,CARQ,CASb,IAAK,CAAED,GAAG,CAAE,iBAAP,CAA0BC,KAAK,CAAE,0CAAjC,CATQ,CAUb,KAAM,CAAED,GAAG,CAAE,kBAAP,CAA2BC,KAAK,CAAE,eAAlC,CAVO,CAAf,CAaA,mBACI,yBAEIlC,SAAS,CAACmC,OAAV,cACI,KAAC,IAAD,EAAM,EAAE,oBAAcnD,IAAI,CAAC8B,EAAnB,CAAR,CAAiC,SAAS,CAAC,MAA3C,uBACE,YAAK,SAAS,CAAE,YAAeL,UAAU,CAACzB,IAAI,CAAC6C,MAAN,CAAzC,uBACE,aAAK,SAAS,CAAC,YAAf,wBACE,YAAK,EAAE,CAAC,QAAR,uBACE,cAAM,SAAS,CAAC,MAAhB,WAAwB7C,IAAI,CAACoD,SAA7B,CAAwCnD,KAAxC,GADF,EADF,cAIE,aAAK,EAAE,CAAC,QAAR,WAEGD,IAAI,CAAC6C,MAAL,GAAgB,CAAhB,eAAqB,aAAK,SAAS,CAAC,cAAf,mDAAsClC,SAAtC,KAAkDE,OAAlD,GAFxB,CAGGb,IAAI,CAAC6C,MAAL,GAAgB,CAAhB,eAAqB,aAAK,SAAS,CAAC,cAAf,6CAAqClC,SAArC,KAAiDE,OAAjD,GAHxB,CAIGb,IAAI,CAAC6C,MAAL,GAAgB,CAAhB,eAAqB,aAAK,SAAS,CAAC,cAAf,8FAA8ClC,SAA9C,KAA0DE,OAA1D,GAJxB,CAKGb,IAAI,CAAC6C,MAAL,GAAgB,CAAhB,eAAqB,aAAK,SAAS,CAAC,cAAf,2EAA0ClC,SAA1C,KAAsDE,OAAtD,GALxB,CAMGb,IAAI,CAAC6C,MAAL,GAAgB,CAAhB,eAAqB,aAAK,SAAS,CAAC,cAAf,WAA+BtC,IAA/B,KAAsCE,IAAtC,GANxB,GAJF,cAaE,YAAK,EAAE,CAAC,QAAR,UAEG4C,MAAM,CAACC,IAAP,CAAYN,MAAZ,EAAoBO,GAApB,CAAwB,SAACC,GAAD,CAAM1B,EAAN,QACrB,CAAC9B,IAAI,CAAC8C,iBAAL,GAA2BU,GAA3B,EAAkCxD,IAAI,CAAC8C,iBAAL,GAA2BW,QAAQ,CAACD,GAAD,CAAtE,gBACA,YAEI,GAAG,CAAER,MAAM,CAACQ,GAAD,CAAN,CAAYP,GAFrB,CAGI,KAAK,CAAED,MAAM,CAACQ,GAAD,CAAN,CAAYN,KAHvB,CAII,GAAG,qBAAeM,GAAf,CAJP,CAKI,SAAS,CAAC,QALd,EACS1B,EADT,CAFqB,EAAxB,CAFH,EAbF,GADF,EADF,EADJ,cAoCM,YAAK,SAAS,CAAE,YAAeL,UAAU,CAACzB,IAAI,CAAC6C,MAAN,CAAzC,uBACE,aAAK,SAAS,CAAC,YAAf,wBACE,YAAK,EAAE,CAAC,QAAR,uBACE,cAAM,SAAS,CAAC,MAAhB,WAAwB7C,IAAI,CAACoD,SAA7B,CAAwCnD,KAAxC,GADF,EADF,cAIE,aAAK,EAAE,CAAC,QAAR,WACGD,IAAI,CAAC6C,MAAL,GAAgB,CAAhB,eAAqB,aAAK,SAAS,CAAC,cAAf,mDAAsClC,SAAtC,KAAkDE,OAAlD,GADxB,CAEGb,IAAI,CAAC6C,MAAL,GAAgB,CAAhB,eAAqB,aAAK,SAAS,CAAC,cAAf,6CAAqClC,SAArC,KAAiDE,OAAjD,GAFxB,CAGGb,IAAI,CAAC6C,MAAL,GAAgB,CAAhB,eAAqB,aAAK,SAAS,CAAC,cAAf,8FAA8ClC,SAA9C,KAA0DE,OAA1D,GAHxB,CAIGb,IAAI,CAAC6C,MAAL,GAAgB,CAAhB,eAAqB,aAAK,SAAS,CAAC,cAAf,2EAA0ClC,SAA1C,KAAsDE,OAAtD,GAJxB,CAKGb,IAAI,CAAC6C,MAAL,GAAgB,CAAhB,eAAqB,aAAK,SAAS,CAAC,cAAf,WAA+BtC,IAA/B,KAAsCE,IAAtC,GALxB,GAJF,cAYE,YAAK,EAAE,CAAC,QAAR,UAEG4C,MAAM,CAACC,IAAP,CAAYN,MAAZ,EAAoBO,GAApB,CAAwB,SAACC,GAAD,CAAM1B,EAAN,QACrB,CAAC9B,IAAI,CAAC8C,iBAAL,GAA2BU,GAA3B,EAAkCxD,IAAI,CAAC8C,iBAAL,GAA2BW,QAAQ,CAACD,GAAD,CAAtE,gBACA,YAEI,GAAG,CAAER,MAAM,CAACQ,GAAD,CAAN,CAAYP,GAFrB,CAGI,KAAK,CAAED,MAAM,CAACQ,GAAD,CAAN,CAAYN,KAHvB,CAII,GAAG,qBAAeM,GAAf,CAJP,CAKI,SAAS,CAAC,QALd,EACS1B,EADT,CAFqB,EAAxB,CAFH,EAZF,GADF,EAtCV,EADJ,CA0ED,CAID;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sourcesContent":["import {Link, useParams} from 'react-router-dom'\r\nimport {useEffect, useState} from 'react'\r\n\r\nimport axios from 'axios'\r\nimport './Employee.css'\r\n\r\n\r\nexport default function Employee({user}) {\r\n\r\n  const [admin, setAdmin] = useState([''])\r\n  const [posts, setPosts] = useState([])\r\n  const [isFetching, setIsFetching] = useState(false)\r\n  const [date, setDate] = useState(null)\r\n  const [time, setTime] = useState(null)\r\n  const [dateStart, setDateStart] = useState(null)\r\n  const [dateEnd, setDateEnd] = useState(null)\r\n  const username = useParams()\r\n\r\n\r\n  const localUser = JSON.parse(localStorage.getItem('user'))\r\n\r\n  const setDat = new Date()\r\n  setDat.setDate(setDat.getDate())\r\n\r\n\r\n  const usersStatuses = {\r\n    0: '',\r\n    1: 'start',\r\n    2: 'end',\r\n    3: 'sick_leave',\r\n    4: 'deleted',\r\n    5: 'vacation',\r\n    6: 'time_off',\r\n    7: 'other'\r\n  }\r\n\r\n  function findStatus(k) {\r\n    for (let i in usersStatuses) {\r\n      if (i == k) {\r\n        return usersStatuses[i]\r\n      }\r\n    }\r\n  }\r\n\r\n\r\n\r\n  // Проверка, если пользователь в отпуске или на больничном, то вывод даты начала и конца\r\n  useEffect(() => {\r\n    const fetchUserpost = async () => {\r\n      const res = await axios.get('/api/post?type=1&id=' + user.id)\r\n      const users = await axios.get('/api/user/' + user.id)\r\n\r\n      if (users.data.isadmin === true) {\r\n        setAdmin('*')\r\n      } else {\r\n        setAdmin('')\r\n      }\r\n\r\n      setDate('')\r\n      setTime('')\r\n      try {\r\n        setDate(res.data[0].workdate)\r\n        setTime(res.data[0].workend)\r\n      } catch {\r\n      }\r\n      setPosts(res.data.sort((p1, p2) => {\r\n        return new Date(p2.workstart) - new Date(p1.workstart)\r\n      }))\r\n      setIsFetching(false)\r\n\r\n    }\r\n    const fetchUser = async () => {\r\n      const res = await axios.get('/api/vacation?id=' + user.id)\r\n\r\n      if (res.data.length === 0) {\r\n        setDateStart(global.workdate = '')\r\n        setDateEnd(global.worked = '')\r\n      } else {\r\n        setDateStart(res.data[0].workdate)\r\n        setDateEnd(res.data[0].worked)\r\n\r\n      }\r\n\r\n    }\r\n\r\n    if (user.status === 1) {\r\n      fetchUser()\r\n    }\r\n    if (user.status === 3) {\r\n      fetchUser()\r\n    }\r\n\r\n    if (user.status === 7) {\r\n      fetchUser()\r\n    }\r\n    if (user.status === 6) {\r\n      fetchUser()\r\n    }\r\n\r\n    if (user.status === 5) {\r\n      fetchUser()\r\n    }\r\n    if (user.status === 2 || user.nomination_status) {\r\n      fetchUserpost()\r\n    }\r\n\r\n\r\n  }, [username._id])\r\n\r\n  const images = {\r\n    '1': { src: '../images/1.png', title: 'Тучка' },\r\n    '2': { src: '../images/2.png', title: 'Аркадий Паровозов' },\r\n    '3': { src: '../images/3.png', title: 'И так сойдет' },\r\n    '4': { src: '../images/4.png', title: 'Портной' },\r\n    '5': { src: '../images/5.png', title: 'Мама обезьянка' },\r\n    '6': { src: '../images/6.png', title: 'Кот Матроскин' },\r\n    '7': { src: '../images/7.png', title: 'Крот' },\r\n    '8': { src: '../images/8.png', title: 'Птица говорун(голосуем только среди дежурных)' },\r\n    '9': { src: '../images/9.png', title: 'Хома(Голосуем среди коллег из внедрения)' },\r\n    '10': { src: '../images/10.png', title: 'Симка и нолик' }\r\n  };\r\n\r\n  return (\r\n      <>\r\n        {\r\n          localUser.isAdmin ? (\r\n              <Link to={`/profile/${user.id}`} className='name'>\r\n                <div className={'employee ' + (findStatus(user.status))}>\r\n                  <div className=\"angry-grid\">\r\n                    <div id=\"item-0\">\r\n                      <span className='name'>{user.user_name}{admin}</span>\r\n                    </div>\r\n                    <div id=\"item-1\">\r\n\r\n                      {user.status === 5 && <div className='vacationText'>Отпуск:{dateStart}-{dateEnd}</div>}\r\n                      {user.status === 6 && <div className='vacationText'>Отгул:{dateStart}-{dateEnd}</div>}\r\n                      {user.status === 7 && <div className='vacationText'>Другая причина:{dateStart}-{dateEnd}</div>}\r\n                      {user.status === 3 && <div className='vacationText'>Больничный:{dateStart}-{dateEnd}</div>}\r\n                      {user.status === 2 && <div className='vacationText'>{date} {time}</div>}\r\n\r\n                    </div>\r\n                    <div id=\"item-2\">\r\n\r\n                      {Object.keys(images).map((key, id) => (\r\n                          (user.nomination_status === key || user.nomination_status === parseInt(key)) &&\r\n                          <img\r\n                              key={id}\r\n                              src={images[key].src}\r\n                              title={images[key].title}\r\n                              alt={`Image for ${key}`}\r\n                              className='images'\r\n                          />\r\n                      ))}\r\n\r\n                    </div>\r\n\r\n\r\n                  </div>\r\n                </div>\r\n              </Link>\r\n          ) : (\r\n                <div className={'employee ' + (findStatus(user.status))}>\r\n                  <div className=\"angry-grid\">\r\n                    <div id=\"item-0\">\r\n                      <span className='name'>{user.user_name}{admin}</span>\r\n                    </div>\r\n                    <div id=\"item-1\">\r\n                      {user.status === 5 && <div className='vacationText'>Отпуск:{dateStart}-{dateEnd}</div>}\r\n                      {user.status === 6 && <div className='vacationText'>Отгул:{dateStart}-{dateEnd}</div>}\r\n                      {user.status === 7 && <div className='vacationText'>Другая причина:{dateStart}-{dateEnd}</div>}\r\n                      {user.status === 3 && <div className='vacationText'>Больничный:{dateStart}-{dateEnd}</div>}\r\n                      {user.status === 2 && <div className='vacationText'>{date} {time}</div>}\r\n\r\n                    </div>\r\n                    <div id=\"item-2\">\r\n\r\n                      {Object.keys(images).map((key, id) => (\r\n                          (user.nomination_status === key || user.nomination_status === parseInt(key)) &&\r\n                          <img\r\n                              key={id}\r\n                              src={images[key].src}\r\n                              title={images[key].title}\r\n                              alt={`Image for ${key}`}\r\n                              className='images'\r\n                          />\r\n                      ))}\r\n\r\n                    </div>\r\n\r\n\r\n                  </div>\r\n                </div>\r\n          )\r\n        }\r\n        </>\r\n  )\r\n}\r\n\r\n\r\n\r\n/*<>\r\n  <div className={'employee ' + (findStatus(user.status))}>\r\n    <div className=\"angry-grid\">\r\n      <div id=\"item-0\">\r\n\r\n        {\r\n          localUser.isAdmin\r\n              ?\r\n              <Link to={`/profile/${user.id}`} className='name'><span\r\n                  className='name'>{user.user_name}{admin}</span></Link>\r\n              : <div className='name'><span className='name'>{user.user_name}{admin}</span></div>\r\n        }\r\n\r\n      </div>\r\n      <div id=\"item-1\">\r\n\r\n        {user.status === 5 && <div className='vacationText'>Отпуск:{dateStart}-{dateEnd}</div>}\r\n        {user.status === 6 && <div className='vacationText'>Отгул:{dateStart}-{dateEnd}</div>}\r\n        {user.status === 7 && <div className='vacationText'>Другая причина:{dateStart}-{dateEnd}</div>}\r\n        {user.status === 3 && <div className='vacationText'>Больничный:{dateStart}-{dateEnd}</div>}\r\n        {user.status === 2 && <div className='vacationText'>{date} {time}</div>}\r\n\r\n      </div>\r\n      <div id=\"item-2\">\r\n\r\n        {Object.keys(images).map((key, id) => (\r\n            (user.nomination_status === key || user.nomination_status === parseInt(key)) &&\r\n            <img\r\n                key={id}\r\n                src={images[key].src}\r\n                title={images[key].title}\r\n                alt={`Image for ${key}`}\r\n                className='images'\r\n            />\r\n        ))}\r\n\r\n      </div>\r\n    </div>\r\n  </div>\r\n</>*/\r\n"]},"metadata":{},"sourceType":"module"}