{"ast":null,"code":"import _regeneratorRuntime from\"D:/Download/time_app/client/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"D:/Download/time_app/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"D:/Download/time_app/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React from'react';import{Link,useParams}from'react-router-dom';import{CircularProgress}from'@material-ui/core';import axios from'axios';import{useEffect,useState}from'react';import SidebarDeps from'../SidebarDeps/SidebarDeps';import'./Sidebar.css';import TreeView from'react-treeview';import'react-treeview/react-treeview.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Sidebar(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),deps=_useState2[0],setDeps=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),users=_useState4[0],setUsers=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isFetching=_useState6[0],setIsFetching=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),filterDeps=_useState8[0],setFilterDeps=_useState8[1];var currentUrl=useParams().username;var localUser=JSON.parse(localStorage.getItem('user'));useEffect(function(){var getDeps=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get('/api/department_tree_to_json/');case 2:res=_context.sent;console.log(\"RES==\",res.data[0]);case 4:case\"end\":return _context.stop();}}},_callee);}));return function getDeps(){return _ref.apply(this,arguments);};}();getDeps();},[]);var dataSource=[{type:'Управление соппровождения и эксплуатации систем подержки бизнеса',id:1,collapsed:false,child:[{name:'Служба поддержски продуктовых систем розничного бизнеса',collapsed:false,id:2,child:[{name:'Отдел администрирования бэк-офисных систем розничного бизнеса',collapsed:false,id:3},{name:'Отдел круглосуточной поддержски процессов закрытия операционного дня отчетности розничного бизнеса',collapsed:false,id:4},{name:'Отдел сопровождения активных операций ФЛ',collapsed:false,id:5},{name:'Отдел сопровождения пассивных операций ФЛ',collapsed:false,id:6}]},{name:'Служба поддержски централизованных и технологических процессов',collapsed:false,id:7,child:[{name:'Отдел поддержски обмена с ФОИВ',collapsed:false,id:8},{name:'Отдел поддержски систем электронного хранения',collapsed:false,id:9},{name:'Отдел поддержски технологиеских процессов',id:10,child:[{name:'Группа поддержки зарплатных проектов',id:11,collapsed:false},{name:'Группа поддержки логичесих карт и технологических сервисов',id:12,collapsed:false}]},{name:'Отдел сопровождения централизованных процессов',id:13}]},{name:'Служба сопровождения муниципальных и специальных сервисов',collapsed:false,id:14,child:[{name:'Отдел сопровождения муниципальных проектов',collapsed:false,id:15},{name:'Отдел сопровождения специальных сервисов',collapsed:false,id:16}]},{name:'Служба сопровождения операционной и расчетной деятельности',collapsed:false,id:17,child:[{name:'Отдел поддержки пользователей прочих АБС',collapsed:false,id:18},{name:'Отдел систем доставки электронных документов',id:19,child:[{name:'Группа поддежрски SWIFT/КФТ/TELEX',id:20}]},{name:'Отдел сопровождения АБС ЮЛ, систем расчетов и задач Казначейства',id:21,child:[{name:'Группа интеграции с внешними системами',id:22,collapsed:false},{name:'Группа поддержки пользователей восточной зоны РФ',id:23,collapsed:false},{name:'Группа поддержки пользователей европейской зоны РФ',id:24,collapsed:false},{name:'Группа сопровождения систем расчетов',id:25}]},{name:'Отдел сопровождения операционного дня',collapsed:false,id:26},{name:'Отдел специального технологического сопровождения АБС',collapsed:false,id:27},{name:'Отдел управления изменениями',collapsed:false,id:28}]}]}];console.log(\"dataSource=\",dataSource);// загрузка всех департаментов\nuseEffect(function(){// сортировка на дочерние и тд\nvar getDeps=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var res,_loop,i,newArr,arr1,arr2;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:setIsFetching(true);_context2.next=3;return axios.get('/api/departments/');case 3:res=_context2.sent;_loop=function _loop(i){var _loop2=function _loop2(j){if(res.data.find(function(k){return k===res.data[j].id&&k!==res.data[i].id;})){if(res.data[j].margin){res.data[j].margin+=40;}else{res.data[j].margin=40;}}};for(var j=i+1;j<res.data.length;j++){_loop2(j);}};for(i=0;i<res.data.length-1;i++){_loop(i);}newArr=res.data.filter(function(d){return d.id!==7;});newArr.push(res.data[6]);global.xz=res.data[0].department_name;/*console.log(\"NEWARRAY=\",global.xz)*/setFilterDeps(newArr.filter(function(a){return a.dep_id===1;}));setDeps(newArr);if(currentUrl&&currentUrl!==localUser._id){arr1=[1,2,3,4,5,6,7,'61efa2f6cf0ce39b27ba2a53','61efa304cf0ce39b27ba2a54','61efa31dcf0ce39b27ba2a55','61efa32bcf0ce39b27ba2a56','61efa33acf0ce39b27ba2a57','61efa344cf0ce39b27ba2a58','61efa34fcf0ce39b27ba2a59'];arr2=[6,8,9,10,11,'61efa344cf0ce39b27ba2a58','61efa35dcf0ce39b27ba2a5a','61efa361cf0ce39b27ba2a5b','61efa36acf0ce39b27ba2a5c','61efa374cf0ce39b27ba2a5d'];if(arr1.find(function(i){return i===currentUrl;})){setFilterDeps(newArr.filter(function(dep){return dep.dep_id===1||dep.dep_id===2||dep.dep_id===3||dep.dep_id===4||dep.dep_id===5||dep.dep_id===6||dep.dep_id===7;}));}if(arr2.find(function(i){return i===currentUrl;})){setFilterDeps(newArr);}else{setFilterDeps(newArr.filter(function(dep){return dep.dep_id===1||dep.dep_id===2||dep.dep_id===3||dep.dep_id===4||dep.dep_id===5||dep.dep_id===6||dep.dep_id===7;}));}}setIsFetching(false);case 13:case\"end\":return _context2.stop();}}},_callee2);}));return function getDeps(){return _ref2.apply(this,arguments);};}();// загрузка пользователей и сортировка по департаментам\nvar fetchUser=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var res,id;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:setIsFetching(true);_context3.next=3;return axios.get('/api/user/');case 3:res=_context3.sent;id=res.data.sort(function(a,b){return a.user_name.localeCompare(b.user_name);});setUsers(res.data);setIsFetching(false);console.log(\"ID=\",id);case 8:case\"end\":return _context3.stop();}}},_callee3);}));return function fetchUser(){return _ref3.apply(this,arguments);};}();fetchUser();getDeps();},[]);var isShowDeps=function isShowDeps(e){var arr1=[1,2,3,4,5,6,7,'61efa2f6cf0ce39b27ba2a53','61efa304cf0ce39b27ba2a54','61efa31dcf0ce39b27ba2a55','61efa32bcf0ce39b27ba2a56','61efa33acf0ce39b27ba2a57','61efa344cf0ce39b27ba2a58','61efa34fcf0ce39b27ba2a59'];var arr2=[6,8,9,10,11,'61efa344cf0ce39b27ba2a58','61efa35dcf0ce39b27ba2a5a','61efa361cf0ce39b27ba2a5b','61efa36acf0ce39b27ba2a5c','61efa374cf0ce39b27ba2a5d'];if(e.target.value===1){setFilterDeps(deps.filter(function(dep){return dep.dep_id===1||dep.dep_id===2||dep.dep_id===3||dep.dep_id===4||dep.dep_id===5||dep.dep_id===6||dep.dep_id===7;}));}if(arr2.find(function(i){return i===e.target.value;})){setFilterDeps(deps);}else{setFilterDeps(deps.filter(function(dep){return dep.dep_id===1||dep.dep_id===2||dep.dep_id===3||dep.dep_id===4||dep.dep_id===5||dep.dep_id===6||dep.dep_id===7;}));}};return/*#__PURE__*/_jsxs(\"div\",{className:\"sidebar\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"sidebarWrapper\",children:/*#__PURE__*/_jsx(\"div\",{className:\"tree\",children:/*#__PURE__*/_jsx(\"div\",{className:\"treeWrapper\",children:dataSource.map(function(node,i){var label=/*#__PURE__*/_jsx(Link,{to:\"/department/\".concat(node.id),className:\"depsUser\",style:{fontWeight:\"bold\"},children:/*#__PURE__*/_jsx(\"span\",{className:\"node\",children:node.type})});return/*#__PURE__*/_jsx(TreeView,{nodeLabel:label,defaultCollapsed:true,children:node.child.map(function(departments){var label2=/*#__PURE__*/_jsx(Link,{to:\"/department/\".concat(departments.id),className:\"depsUser\",children:/*#__PURE__*/_jsx(\"span\",{className:\"node\",children:departments.name})});return/*#__PURE__*/_jsx(TreeView,{nodeLabel:label2,defaultCollapsed:true,children:!!departments.child?departments.child.map(function(departments1){var label3=/*#__PURE__*/_jsx(Link,{to:\"/department/\".concat(departments1.id),className:\"depsUser\",children:/*#__PURE__*/_jsx(\"span\",{className:\"node\",children:departments1.name})});return/*#__PURE__*/_jsx(TreeView,{nodeLabel:label3,defaultCollapsed:true,children:!!departments1.child?departments1.child.map(function(departments2){return/*#__PURE__*/_jsx(Link,{to:\"/department/\".concat(departments2.id),className:\"depsUser\",children:/*#__PURE__*/_jsx(\"div\",{style:{paddingBottom:'8px'},children:departments2.name})});}):''});}):''},departments.child);})},node.type+'|'+i);})})})}),/*#__PURE__*/_jsx(\"div\",{})]});}","map":{"version":3,"sources":["D:/Download/time_app/client/src/components/Sidebar/Sidebar.jsx"],"names":["React","Link","useParams","CircularProgress","axios","useEffect","useState","SidebarDeps","TreeView","Sidebar","deps","setDeps","users","setUsers","isFetching","setIsFetching","filterDeps","setFilterDeps","currentUrl","username","localUser","JSON","parse","localStorage","getItem","getDeps","get","res","console","log","data","dataSource","type","id","collapsed","child","name","i","j","find","k","margin","length","newArr","filter","d","push","global","xz","department_name","a","dep_id","_id","arr1","arr2","dep","fetchUser","sort","b","user_name","localeCompare","isShowDeps","e","target","value","map","node","label","fontWeight","departments","label2","departments1","label3","departments2","paddingBottom"],"mappings":"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","sourcesContent":["import React from 'react'\r\nimport { Link, useParams } from 'react-router-dom'\r\nimport { CircularProgress } from '@material-ui/core'\r\nimport axios from 'axios'\r\nimport { useEffect, useState } from 'react'\r\n\r\nimport SidebarDeps from '../SidebarDeps/SidebarDeps'\r\nimport './Sidebar.css'\r\nimport TreeView from 'react-treeview';\r\nimport 'react-treeview/react-treeview.css'\r\n\r\nexport default function Sidebar() {\r\n  const [deps, setDeps] = useState([])\r\n  const [users, setUsers] = useState([])\r\n  const [isFetching, setIsFetching] = useState(false)\r\n  const [filterDeps, setFilterDeps] = useState([])\r\n  const currentUrl = useParams().username\r\n  const localUser = JSON.parse(localStorage.getItem('user'))\r\n\r\n    useEffect(() => {\r\n        const getDeps = async () => {\r\n           const res = await axios.get('/api/department_tree_to_json/')\r\n            console.log(\"RES==\",res.data[0])\r\n        }\r\n        getDeps()\r\n        }, [])\r\n\r\n\r\n  const dataSource = [\r\n\r\n      {\r\n          type: 'Управление соппровождения и эксплуатации систем подержки бизнеса',id:1,\r\n          collapsed: false,\r\n          child: [\r\n              {name: 'Служба поддержски продуктовых систем розничного бизнеса',collapsed: false,id:2,\r\n                  child: [\r\n                      {name: 'Отдел администрирования бэк-офисных систем розничного бизнеса',collapsed: false,id:3},\r\n                      {name: 'Отдел круглосуточной поддержски процессов закрытия операционного дня отчетности розничного бизнеса', collapsed: false,id:4},\r\n                      {name: 'Отдел сопровождения активных операций ФЛ', collapsed: false,id:5},\r\n                      {name: 'Отдел сопровождения пассивных операций ФЛ', collapsed: false,id:6}]},\r\n\r\n              {name: 'Служба поддержски централизованных и технологических процессов', collapsed: false,id:7,\r\n                  child: [\r\n                      {name: 'Отдел поддержски обмена с ФОИВ', collapsed: false,id:8},\r\n                      {name: 'Отдел поддержски систем электронного хранения', collapsed: false,id:9},\r\n                      {name: 'Отдел поддержски технологиеских процессов',id:10,\r\n                          child: [\r\n                              {name:'Группа поддержки зарплатных проектов',id:11,collapsed: false},\r\n                              {name:'Группа поддержки логичесих карт и технологических сервисов',id:12, collapsed: false}\r\n                          ]},\r\n                      {name: 'Отдел сопровождения централизованных процессов',id:13}\r\n                  ],\r\n              },\r\n\r\n              {name: 'Служба сопровождения муниципальных и специальных сервисов', collapsed: false,id:14,\r\n                  child: [\r\n                      {name: 'Отдел сопровождения муниципальных проектов', collapsed: false,id:15},\r\n                      {name: 'Отдел сопровождения специальных сервисов', collapsed: false,id:16}\r\n                  ],\r\n              },\r\n\r\n              {name: 'Служба сопровождения операционной и расчетной деятельности', collapsed: false,id:17,\r\n                  child: [{name: 'Отдел поддержки пользователей прочих АБС', collapsed: false,id:18},\r\n                      {name: 'Отдел систем доставки электронных документов',id:19,\r\n                          child: [\r\n                              {name:'Группа поддежрски SWIFT/КФТ/TELEX',id:20}]},\r\n                      {name: 'Отдел сопровождения АБС ЮЛ, систем расчетов и задач Казначейства',id:21,\r\n                          child: [\r\n                              {name:'Группа интеграции с внешними системами',id:22,collapsed: false},\r\n                              {name:'Группа поддержки пользователей восточной зоны РФ',id:23,collapsed: false},\r\n                              {name:'Группа поддержки пользователей европейской зоны РФ',id:24,collapsed: false},\r\n                              {name:'Группа сопровождения систем расчетов',id:25}]},\r\n                      {name: 'Отдел сопровождения операционного дня', collapsed: false,id:26},\r\n                      {name: 'Отдел специального технологического сопровождения АБС', collapsed: false,id:27},\r\n                      {name: 'Отдел управления изменениями', collapsed: false,id:28}\r\n\r\n                  ]\r\n              }\r\n          ],\r\n      },\r\n  ]\r\nconsole.log(\"dataSource=\",dataSource)\r\n\r\n\r\n  // загрузка всех департаментов\r\n  useEffect(() => {\r\n    // сортировка на дочерние и тд\r\n    const getDeps = async () => {\r\n        setIsFetching(true)\r\n        const res = await axios.get('/api/departments/')\r\n\r\n\r\n        for(let i = 0; i < res.data.length-1; i++){\r\n          for(let j = i+1; j < res.data.length; j++){\r\n            if(res.data.find(k => k === res.data[j].id && k !== res.data[i].id)){\r\n              if(res.data[j].margin ){\r\n                res.data[j].margin += 40\r\n              } else {\r\n                res.data[j].margin = 40\r\n              }\r\n            }\r\n          }\r\n        }\r\n\r\n      let newArr = res.data.filter(d => d.id !== 7)\r\n      newArr.push(res.data[6])\r\n      global.xz=res.data[0].department_name\r\n      /*console.log(\"NEWARRAY=\",global.xz)*/\r\n      setFilterDeps(newArr.filter(a => a.dep_id === 1))\r\n      setDeps(newArr)\r\n      if(currentUrl && currentUrl !== localUser._id){\r\n        const arr1 = [1, 2, 3, 4, 5, 6, 7, '61efa2f6cf0ce39b27ba2a53', '61efa304cf0ce39b27ba2a54', '61efa31dcf0ce39b27ba2a55', '61efa32bcf0ce39b27ba2a56', '61efa33acf0ce39b27ba2a57', '61efa344cf0ce39b27ba2a58', '61efa34fcf0ce39b27ba2a59']\r\n        const arr2 = [6, 8, 9, 10, 11, '61efa344cf0ce39b27ba2a58', '61efa35dcf0ce39b27ba2a5a', '61efa361cf0ce39b27ba2a5b', '61efa36acf0ce39b27ba2a5c', '61efa374cf0ce39b27ba2a5d']\r\n\r\n        if(arr1.find(i => i === currentUrl)){\r\n          setFilterDeps(newArr.filter(dep => dep.dep_id === 1 || dep.dep_id === 2 || dep.dep_id === 3 || dep.dep_id === 4 || dep.dep_id === 5 || dep.dep_id === 6 || dep.dep_id === 7))\r\n        }\r\n        if(arr2.find(i => i === currentUrl)){\r\n          setFilterDeps(newArr)\r\n        }else{\r\n          setFilterDeps(newArr.filter(dep => dep.dep_id === 1 || dep.dep_id === 2 || dep.dep_id === 3 || dep.dep_id === 4 || dep.dep_id === 5 || dep.dep_id === 6 || dep.dep_id === 7))\r\n        }\r\n      }\r\n      setIsFetching(false)\r\n    }\r\n\r\n    // загрузка пользователей и сортировка по департаментам\r\n    const fetchUser = async () => {\r\n      setIsFetching(true)\r\n      const res = await axios.get('/api/user/')\r\n      const id=res.data.sort((a, b) => a.user_name.localeCompare(b.user_name))\r\n      setUsers(res.data)\r\n      setIsFetching(false)\r\n      console.log(\"ID=\",id)\r\n    }\r\n\r\n    fetchUser()\r\n    getDeps()\r\n  }, [])\r\n\r\n  const isShowDeps = (e) => {\r\n    const arr1 = [1, 2, 3, 4, 5, 6, 7, '61efa2f6cf0ce39b27ba2a53', '61efa304cf0ce39b27ba2a54', '61efa31dcf0ce39b27ba2a55', '61efa32bcf0ce39b27ba2a56', '61efa33acf0ce39b27ba2a57', '61efa344cf0ce39b27ba2a58', '61efa34fcf0ce39b27ba2a59']\r\n    const arr2 = [6, 8, 9, 10, 11, '61efa344cf0ce39b27ba2a58', '61efa35dcf0ce39b27ba2a5a', '61efa361cf0ce39b27ba2a5b', '61efa36acf0ce39b27ba2a5c', '61efa374cf0ce39b27ba2a5d']\r\n\r\n    if(e.target.value === 1){\r\n      setFilterDeps(deps.filter(dep => dep.dep_id === 1 || dep.dep_id === 2 || dep.dep_id === 3 || dep.dep_id === 4 || dep.dep_id === 5 || dep.dep_id === 6 || dep.dep_id === 7))\r\n    }\r\n    if(arr2.find(i => i === e.target.value)){\r\n      setFilterDeps(deps)\r\n    }else{\r\n      setFilterDeps(deps.filter(dep => dep.dep_id === 1 || dep.dep_id === 2 || dep.dep_id === 3 || dep.dep_id === 4 || dep.dep_id === 5 || dep.dep_id === 6 || dep.dep_id === 7))\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className='sidebar'>\r\n      <div className=\"sidebarWrapper\">\r\n        <div className=\"tree\">\r\n          <div className=\"treeWrapper\">\r\n\r\n              {dataSource.map((node, i) => {\r\n\r\n                  const label = <Link to={`/department/${node.id}`} className='depsUser' style={{fontWeight: `bold`}}><span className=\"node\">{node.type}</span></Link>\r\n\r\n                  return (\r\n\r\n                      <TreeView key={node.type + '|' + i} nodeLabel={label} defaultCollapsed={true}>\r\n\r\n                          {node.child.map(departments => {\r\n\r\n                              const label2 = <Link to={`/department/${departments.id}`} className='depsUser'><span className=\"node\">{departments.name}</span></Link>\r\n\r\n                              return (\r\n\r\n                                  <TreeView nodeLabel={label2} key={departments.child} defaultCollapsed={true}>\r\n\r\n                                      {!!departments.child ? departments.child.map(departments1  => {\r\n\r\n                                          const label3 = <Link to={`/department/${departments1.id}`} className='depsUser'><span className=\"node\">{departments1.name}</span></Link>\r\n\r\n                                          return(\r\n\r\n                                              <TreeView nodeLabel={label3} defaultCollapsed={true} >\r\n\r\n                                                  {!!departments1.child ? departments1.child.map(departments2  => {\r\n\r\n                                            return(\r\n\r\n                                                <Link to={`/department/${departments2.id}`} className='depsUser'>\r\n\r\n                                                    <div  style={{paddingBottom:'8px'}}>{departments2.name}</div>\r\n\r\n                                                </Link>\r\n                                            )\r\n\r\n                                      }):''}\r\n                                  </TreeView>\r\n                              );\r\n                          }):''}\r\n                      </TreeView>\r\n                  );\r\n              })}\r\n                      </TreeView>\r\n                  );\r\n              })}\r\n          </div>\r\n        </div>\r\n      </div>\r\n        {/* <SidebarDeps users={users} dep={deps}/>*/}\r\n        <div>\r\n\r\n        </div>\r\n    </div>\r\n  )\r\n}\r\n"]},"metadata":{},"sourceType":"module"}