{"ast":null,"code":"import _regeneratorRuntime from\"D:/time_app/client/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"D:/time_app/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"D:/time_app/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useContext,useRef,useEffect,useState}from'react';import{CircularProgress}from'@material-ui/core';import{Link}from'react-router-dom';import axios from\"axios\";import loginCall from'../../apiCalls';import{AuthContext}from'../../context/AuthContext';import'./Login.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Login(){var _useState=useState(),_useState2=_slicedToArray(_useState,2),errorMessage=_useState2[0],setErrorMessage=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),serverError=_useState4[0],setServerError=_useState4[1];useEffect(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:axios.get('/api/user').then(function(response){if(!response){throw new Error('Сервер недоступен');}}).catch(function(error){setServerError(true);setErrorMessage('Ошибка: '+error.message);});case 1:case\"end\":return _context.stop();}}},_callee);})),[]);var email=useRef();var password=useRef();var _useContext=useContext(AuthContext),isFetching=_useContext.isFetching,error=_useContext.error,dispatch=_useContext.dispatch;var handleClick=function handleClick(e){e.preventDefault();loginCall({email:email.current.value.toUpperCase(),password:password.current.value},dispatch);};return/*#__PURE__*/_jsxs(\"div\",{className:\"login\",children:[!errorMessage&&error&&/*#__PURE__*/_jsx(\"div\",{className:\"error\",children:\"\\u041D\\u0435\\u043F\\u0440\\u0430\\u0432\\u0438\\u043B\\u044C\\u043D\\u044B\\u0439 \\u043B\\u043E\\u0433\\u0438\\u043D \\u0438\\u043B\\u0438 \\u043F\\u0430\\u0440\\u043E\\u043B\\u044C\"}),serverError&&/*#__PURE__*/_jsx(\"div\",{className:\"error\",children:\"\\u0421\\u0435\\u0440\\u0432\\u0435\\u0440 \\u043D\\u0435\\u0434\\u043E\\u0441\\u0442\\u0443\\u043F\\u0435\\u043D\"}),/*#__PURE__*/_jsx(\"div\",{className:\"loginWrapper\",children:/*#__PURE__*/_jsx(\"div\",{className:\"loginCenter\",children:/*#__PURE__*/_jsxs(\"form\",{className:\"loginBox\",onSubmit:handleClick,children:[/*#__PURE__*/_jsx(\"input\",{placeholder:\"Email\",className:\"loginInput\",type:\"emailLogin\",ref:email,required:true}),/*#__PURE__*/_jsx(\"input\",{placeholder:\"Password\",type:\"password\",className:\"loginInput\",ref:password,required:true,minLength:\"6\"}),/*#__PURE__*/_jsx(\"button\",{className:\"loginButton\",type:\"submit\",disabled:isFetching,children:isFetching?/*#__PURE__*/_jsx(CircularProgress,{style:{color:'white'}}):'Войти'}),/*#__PURE__*/_jsx(Link,{to:\"/register\",style:{width:'167%'},children:/*#__PURE__*/_jsx(\"button\",{className:\"loginRegisterButton\",disabled:isFetching,children:isFetching?/*#__PURE__*/_jsx(CircularProgress,{style:{color:'white'}}):'Создать новый аккаунт'})})]})})})]});}","map":{"version":3,"sources":["D:/time_app/client/src/pages/Login/Login.jsx"],"names":["useContext","useRef","useEffect","useState","CircularProgress","Link","axios","loginCall","AuthContext","Login","errorMessage","setErrorMessage","serverError","setServerError","get","then","response","Error","catch","error","message","email","password","isFetching","dispatch","handleClick","e","preventDefault","current","value","toUpperCase","color","width"],"mappings":"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","sourcesContent":["import {useContext, useRef, useEffect,useState} from 'react';\r\nimport {CircularProgress} from '@material-ui/core'\r\nimport {Link} from 'react-router-dom'\r\nimport axios from \"axios\";\r\nimport  loginCall  from '../../apiCalls';\r\nimport { AuthContext } from '../../context/AuthContext'\r\nimport './Login.css'\r\n\r\n\r\nexport default function Login() {\r\n\r\n    const [errorMessage, setErrorMessage] = useState();\r\n    const [serverError, setServerError] = useState(false);\r\n\r\n    useEffect(async () => {\r\n        axios.get('/api/user')\r\n            .then(response => {\r\n                if (!response) {\r\n                    throw new Error('Сервер недоступен');\r\n                }\r\n            })\r\n            .catch(error => {\r\n                setServerError(true);\r\n                setErrorMessage('Ошибка: ' + error.message);\r\n            });\r\n    }, []);\r\n\r\n\r\n  const email = useRef()\r\n  const password = useRef()\r\n\r\n  const {isFetching, error, dispatch } = useContext(AuthContext)\r\n  const handleClick = (e) => {\r\n    e.preventDefault()\r\n    loginCall({email:email.current.value.toUpperCase(), password:password.current.value}, dispatch)\r\n  }\r\n\r\n  return (\r\n      <div className=\"login\">\r\n          {!errorMessage && error &&\r\n              <div className='error'>\r\n                  Неправильный логин или пароль\r\n              </div>}\r\n\r\n          {serverError &&\r\n              <div className='error'>\r\n                  Сервер недоступен\r\n              </div>\r\n          }\r\n\r\n\r\n\r\n      <div className=\"loginWrapper\">\r\n        <div className=\"loginCenter\">\r\n          <form className=\"loginBox\" onSubmit={handleClick}>\r\n            <input \r\n              placeholder=\"Email\"\r\n              className=\"loginInput\" \r\n              type='emailLogin'\r\n              ref={email} \r\n              required\r\n            />\r\n            <input \r\n              placeholder=\"Password\" \r\n              type='password' \r\n              className=\"loginInput\" \r\n              ref={password} \r\n              required\r\n              minLength='6'\r\n            />\r\n            <button  className=\"loginButton\" type=\"submit\" disabled={isFetching}>\r\n\r\n              {isFetching ? <CircularProgress style={{color:'white'}}/> : 'Войти'}\r\n\r\n            </button>\r\n\r\n            {/* <span className=\"loginForgot\">Забыли пароль?</span> */}\r\n            <Link to='/register' style={{width:'167%'}}>\r\n              <button className=\"loginRegisterButton\" disabled={isFetching}>\r\n                {isFetching ? <CircularProgress style={{color:'white'}}/> : 'Создать новый аккаунт'}\r\n              </button>\r\n            </Link>\r\n          </form>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}