{"ast":null,"code":"import _regeneratorRuntime from\"D:/Download/time_app/client/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"D:/Download/time_app/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"D:/Download/time_app/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{Link}from'react-router-dom';import{Delete}from'@material-ui/icons';import axios from'axios';import'./Employee.css';import{useEffect,useState}from'react';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export default function Employee(_ref){var user=_ref.user;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),posts=_useState2[0],setPosts=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isFetching=_useState4[0],setIsFetching=_useState4[1];var fetchUserpost=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get('/api/post?type=1&id='+user.id);case 2:res=_context.sent;console.log('RES___DATA=',res.data);global.postend='';global.workstart='';try{global.postend=res.data[0].workdate;global.workstart=res.data[0].workstart;console.log('res.data=',global.postend);}catch(_unused){}setPosts(res.data.sort(function(p1,p2){return new Date(p2.workstart)-new Date(p1.workstart);}));setIsFetching(false);case 9:case\"end\":return _context.stop();}}},_callee);}));return function fetchUserpost(){return _ref2.apply(this,arguments);};}();var localUser=JSON.parse(localStorage.getItem('user'));var usersStatuses={0:'',1:'start',2:'end',3:'sick_leave',4:'deleted',5:'vacation',6:'time_off',7:'other'};function findStatus(k){for(var i in usersStatuses){if(i==k){return usersStatuses[i];}}}var setDat=new Date();//Сегодняшнея дата\nsetDat.setDate(setDat.getDate());//\nvar dat=setDat.toLocaleDateString();//\n/*  console.log(\"SETDATE\",dat)     */ //\nvar _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),date=_useState6[0],setDate=_useState6[1];var _useState7=useState(null),_useState8=_slicedToArray(_useState7,2),time=_useState8[0],setTime=_useState8[1];/*  // Проверка, если пользователь закончил работу, то вывод даты, когда он закончил\r\n  useEffect(() => {\r\n    const fetchUser = async () => {\r\n      const res = await axios.get('/api/post/')\r\n      res.data.sort((p1, p2) => {\r\n        return new Date(p2.workStart) - new Date(p1.workStart)\r\n      })\r\n      let data = (res.data[0].workEnd)\r\n      data = new Date(data)\r\n      data = data.toLocaleString()\r\n      data = data.split(',')\r\n      let dataF = data[0].split('.')\r\n      let dataS = data[1].split(':')\r\n      dataF = dataF[0]+'/'+dataF[1]\r\n      dataS = dataS[0]+':'+dataS[1]\r\n      setDate(dataF)\r\n      setTime(dataS)\r\n    }\r\n    if(user.status === 2){\r\n      fetchUser()\r\n    }\r\n  }, [user._id])*/var _useState9=useState(null),_useState10=_slicedToArray(_useState9,2),dateStart=_useState10[0],setDateStart=_useState10[1];var _useState11=useState(null),_useState12=_slicedToArray(_useState11,2),dateEnd=_useState12[0],setDateEnd=_useState12[1];// Проверка, если пользователь в отпуске или на больничном, то вывод даты начала и конца\nuseEffect(function(){var fetchUser=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var res;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return axios.get('/api/vacation?id='+user.id);case 2:res=_context2.sent;console.log('VACATION=',res.data);if(res.data.length===0){setDateStart(global.workdate='');setDateEnd(global.worked='');}else{global.workdate=res.data[0].workdate;global.worked=res.data[0].worked;console.log(\"res.data[0].workdate=\",res.data[0].workdate);setDateStart(global.workdate);setDateEnd(global.worked);}case 5:case\"end\":return _context2.stop();}}},_callee2);}));return function fetchUser(){return _ref3.apply(this,arguments);};}();if(user.status===3){fetchUser();}if(user.status===7){fetchUser();}if(user.status===6){fetchUser();}if(user.status===5){fetchUser();}if(user.status===2){fetchUserpost();}},[user._id]);return/*#__PURE__*/_jsx(_Fragment,{children:user.status===4&&!localUser.isAdmin?/*#__PURE__*/_jsx(\"div\",{}):/*#__PURE__*/_jsxs(\"div\",{className:'employee '+findStatus(user.status),children:[/*#__PURE__*/_jsx(\"div\",{className:\"top\",children:localUser.isAdmin?/*#__PURE__*/_jsx(Link,{to:\"/profile/\".concat(user.id),className:\"name\",children:/*#__PURE__*/_jsx(\"span\",{className:\"name\",children:user.user_name})}):/*#__PURE__*/_jsx(\"div\",{className:\"name\",children:/*#__PURE__*/_jsx(\"span\",{className:\"name\",children:user.user_name})})}),/*#__PURE__*/_jsx(\"div\",{className:\"down\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"downRight\",children:[user.status===5&&/*#__PURE__*/_jsxs(\"div\",{className:\"vacationText\",children:[\"\\u041E\\u0442\\u043F\\u0443\\u0441\\u043A:\",global.workdate,\"-\",global.worked]}),user.status===6&&/*#__PURE__*/_jsxs(\"div\",{className:\"vacationText\",children:[\"\\u041E\\u0442\\u0433\\u0443\\u043B:\",global.workdate,\"-\",global.worked]}),user.status===7&&/*#__PURE__*/_jsxs(\"div\",{className:\"vacationText\",children:[\"\\u0414\\u0440\\u0443\\u0433\\u0430\\u044F \\u043F\\u0440\\u0438\\u0447\\u0438\\u043D\\u0430:\",global.workdate,\"-\",global.worked]}),user.status===3&&/*#__PURE__*/_jsxs(\"div\",{className:\"vacationText\",children:[\"\\u0411\\u043E\\u043B\\u044C\\u043D\\u0438\\u0447\\u043D\\u044B\\u0439:\",global.workdate,\"-\",global.worked]}),user.status===2&&/*#__PURE__*/_jsxs(\"div\",{className:\"vacationText\",children:[global.postend,\"  \",global.workstart]})]})})]})});}{/*<div className='emailEmployee'>{user.email}</div>*/}","map":{"version":3,"sources":["D:/Download/time_app/client/src/components/Employee/Employee.jsx"],"names":["Link","Delete","axios","useEffect","useState","Employee","user","posts","setPosts","isFetching","setIsFetching","fetchUserpost","get","id","res","console","log","data","global","postend","workstart","workdate","sort","p1","p2","Date","localUser","JSON","parse","localStorage","getItem","usersStatuses","findStatus","k","i","setDat","setDate","getDate","dat","toLocaleDateString","date","time","setTime","dateStart","setDateStart","dateEnd","setDateEnd","fetchUser","length","worked","status","_id","isAdmin","user_name"],"mappings":"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","sourcesContent":["import { Link } from 'react-router-dom'\r\nimport { Delete } from '@material-ui/icons'\r\nimport axios from 'axios'\r\n\r\nimport './Employee.css'\r\nimport { useEffect, useState } from 'react'\r\nexport default function Employee({user}) {\r\n\r\n  const [posts, setPosts] = useState([])\r\n  const [isFetching, setIsFetching] = useState(false)\r\n\r\n  const fetchUserpost = async () => {\r\n    const res = await axios.get('/api/post?type=1&id='+user.id)\r\n    console.log('RES___DATA=',res.data)\r\n    global.postend=''\r\n    global.workstart=''\r\ntry{\r\n  global.postend = res.data[0].workdate\r\n  global.workstart = res.data[0].workstart\r\n  console.log('res.data=', global.postend)\r\n}\r\ncatch {\r\n\r\n}\r\n    setPosts(res.data.sort((p1, p2) => {\r\n      return new Date(p2.workstart) - new Date(p1.workstart)\r\n    }))\r\n    setIsFetching(false)\r\n  }\r\n  const localUser = JSON.parse(localStorage.getItem('user'))\r\n\r\n  const usersStatuses = {0: '', 1: 'start', 2: 'end', 3: 'sick_leave', 4: 'deleted' ,5: 'vacation', 6: 'time_off', 7: 'other'}\r\n  function findStatus(k){\r\n    for(let i in usersStatuses){\r\n      if(i == k){\r\n        return usersStatuses[i]\r\n      }\r\n    }\r\n  }\r\n\r\n\r\n  const setDat = new Date()                     //Сегодняшнея дата\r\n  setDat.setDate(setDat.getDate())              //\r\n  const dat=setDat.toLocaleDateString()         //\r\n/*  console.log(\"SETDATE\",dat)     */               //\r\n\r\n  const [date, setDate] = useState(null)\r\n  const [time, setTime] = useState(null)\r\n\r\n/*  // Проверка, если пользователь закончил работу, то вывод даты, когда он закончил\r\n  useEffect(() => {\r\n    const fetchUser = async () => {\r\n      const res = await axios.get('/api/post/')\r\n      res.data.sort((p1, p2) => {\r\n        return new Date(p2.workStart) - new Date(p1.workStart)\r\n      })\r\n      let data = (res.data[0].workEnd)\r\n      data = new Date(data)\r\n      data = data.toLocaleString()\r\n      data = data.split(',')\r\n      let dataF = data[0].split('.')\r\n      let dataS = data[1].split(':')\r\n      dataF = dataF[0]+'/'+dataF[1]\r\n      dataS = dataS[0]+':'+dataS[1]\r\n      setDate(dataF)\r\n      setTime(dataS)\r\n    }\r\n    if(user.status === 2){\r\n      fetchUser()\r\n    }\r\n  }, [user._id])*/\r\n\r\n  const [dateStart, setDateStart] = useState(null)\r\n  const [dateEnd, setDateEnd] = useState(null)\r\n\r\n  // Проверка, если пользователь в отпуске или на больничном, то вывод даты начала и конца\r\n  useEffect(() => {\r\n    const fetchUser = async () => {\r\n    const res = await axios.get('/api/vacation?id='+user.id)\r\n      console.log('VACATION=',res.data)\r\n      if(res.data.length===0){\r\n        setDateStart(global.workdate='')\r\n        setDateEnd(global.worked='')\r\n      }else{\r\n    global.workdate=res.data[0].workdate\r\n    global.worked=res.data[0].worked\r\n        console.log(\"res.data[0].workdate=\",res.data[0].workdate)\r\n        setDateStart(global.workdate)\r\n        setDateEnd(global.worked)\r\n  }}\r\n\r\n    if(user.status===3){\r\n      fetchUser()}\r\n\r\n      if(user.status===7){\r\n      fetchUser()\r\n      }\r\n    if(user.status===6){\r\n      fetchUser()}\r\n\r\n    if(user.status===5){\r\n      fetchUser()\r\n    }\r\n    if(user.status===2){\r\n      fetchUserpost()\r\n    }\r\n\r\n  }, [user._id])\r\n\r\n\r\n\r\n  return (<>\r\n\r\n        {user.status === 4 && !localUser.isAdmin\r\n            ?\r\n            <div></div>\r\n            :\r\n            <div className={'employee ' + (findStatus(user.status))}>\r\n              <div className='top'>{localUser.isAdmin\r\n                  ?\r\n                  <Link to={`/profile/${user.id}`} className='name'><span className='name'>{user.user_name}</span></Link>\r\n                  : <div className='name'><span className='name'>{user.user_name}</span></div>\r\n              }\r\n              </div>\r\n              <div className='down'>\r\n                <div className='downRight'>\r\n                  {/*<div className='emailEmployee'>{user.email}</div>*/}\r\n                  {user.status === 5 && <div className='vacationText'>Отпуск:{global.workdate}-{global.worked}</div>}\r\n                  {user.status === 6 && <div className='vacationText'>Отгул:{global.workdate}-{global.worked}</div>}\r\n                  {user.status === 7 && <div className='vacationText'>Другая причина:{global.workdate}-{global.worked}</div>}\r\n                  {user.status === 3 && <div className='vacationText' >Больничный:{global.workdate}-{global.worked}</div>}\r\n                  {user.status === 2 && <div className='vacationText' >{global.postend}  {global.workstart}</div>}\r\n                </div>\r\n              </div>\r\n            </div>\r\n        }</>\r\n  )\r\n}\r\n\r\n\r\n{/*<div className='emailEmployee'>{user.email}</div>*/}\r\n"]},"metadata":{},"sourceType":"module"}