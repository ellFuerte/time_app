{"ast":null,"code":"import _regeneratorRuntime from\"D:/time_app/client/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"D:/time_app/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"D:/time_app/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{Link}from'react-router-dom';import'./SearchBlock.css';import{useEffect,useState}from\"react\";import axios from\"axios\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var usersStatuses={0:'',1:'start',2:'end',3:'sick_leave',4:'deleted',5:'vacation',6:'time_off',7:'other'};function findStatus(k){for(var i in usersStatuses){if(i==k){return usersStatuses[i];}}}export default function SearchBlock(_ref){var user=_ref.user;var _useState=useState(['']),_useState2=_slicedToArray(_useState,2),admin=_useState2[0],setAdmin=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),dateStart=_useState4[0],setDateStar=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),dateEnd=_useState6[0],setDateEn=_useState6[1];useEffect(function(){var fetchUser=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res,users;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get('/api/vacation?id='+user.id);case 2:res=_context.sent;if(res.data.length===0){setDateStar(global.workdate='');setDateEn(global.worked='');}else{global.workdate=res.data[0].workdate;global.worked=res.data[0].worked;setDateStar(global.workdate);setDateEn(global.worked);}_context.next=6;return axios.get('/api/user/'+user.id);case 6:users=_context.sent;if(users.data.isadmin===true){setAdmin('*');}else{setAdmin('');}case 8:case\"end\":return _context.stop();}}},_callee);}));return function fetchUser(){return _ref2.apply(this,arguments);};}();if(user.status===3){fetchUser();}if(user.status===7){fetchUser();}if(user.status===1){fetchUser();}if(user.status===6){fetchUser();}if(user.status===5){fetchUser();}if(user.status===2){fetchUser();}},[user._id]);var localUser=JSON.parse(localStorage.getItem('user'));var name=user.email.toLowerCase();return/*#__PURE__*/_jsx(\"div\",{className:\"searchBlockContainer\",children:user.status===4&&!localUser.isAdmin?/*#__PURE__*/_jsx(\"div\",{}):/*#__PURE__*/_jsxs(\"div\",{className:'employee '+findStatus(user.status),children:[/*#__PURE__*/_jsx(\"div\",{className:\"top\",children:localUser.isAdmin?/*#__PURE__*/_jsx(Link,{to:\"/profile/\".concat(user.id),onClick:function onClick(){return window.location.href=\"/profile/\".concat(user.id);},className:\"name\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"name\",children:[user.user_name,admin]})}):/*#__PURE__*/_jsx(\"div\",{className:\"name\",children:/*#__PURE__*/_jsxs(\"span\",{children:[user.user_name,admin]})})}),/*#__PURE__*/_jsx(\"div\",{className:\"email\",children:name.charAt(0).toUpperCase()+name.slice(1)}),user.status===5&&/*#__PURE__*/_jsxs(\"div\",{className:\"vacationText\",children:[\"\\u041E\\u0442\\u043F\\u0443\\u0441\\u043A:\",global.workdate,\"-\",global.worked]}),user.status===6&&/*#__PURE__*/_jsxs(\"div\",{className:\"vacationText\",children:[\"\\u041E\\u0442\\u0433\\u0443\\u043B:\",global.workdate,\"-\",global.worked]}),user.status===7&&/*#__PURE__*/_jsxs(\"div\",{className:\"vacationText\",children:[\"\\u0414\\u0440\\u0443\\u0433\\u0430\\u044F \\u043F\\u0440\\u0438\\u0447\\u0438\\u043D\\u0430:\",global.workdate,\"-\",global.worked]}),user.status===3&&/*#__PURE__*/_jsxs(\"div\",{className:\"vacationText\",children:[\"\\u0411\\u043E\\u043B\\u044C\\u043D\\u0438\\u0447\\u043D\\u044B\\u0439:\",global.workdate,\"-\",global.worked]})]})});}","map":{"version":3,"sources":["D:/time_app/client/src/components/SearchBlock/SearchBlock.jsx"],"names":["Link","useEffect","useState","axios","usersStatuses","findStatus","k","i","SearchBlock","user","admin","setAdmin","dateStart","setDateStar","dateEnd","setDateEn","fetchUser","get","id","res","data","length","global","workdate","worked","users","isadmin","status","_id","localUser","JSON","parse","localStorage","getItem","name","email","toLowerCase","isAdmin","window","location","href","user_name","charAt","toUpperCase","slice"],"mappings":"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","sourcesContent":["import {Link} from 'react-router-dom'\r\n\r\nimport './SearchBlock.css'\r\nimport {useEffect, useState} from \"react\";\r\nimport axios from \"axios\";\r\n\r\nconst usersStatuses = {0: '', 1: 'start', 2: 'end', 3: 'sick_leave', 4: 'deleted' ,5: 'vacation', 6: 'time_off', 7: 'other'}\r\nfunction findStatus(k){\r\n    for(let i in usersStatuses){\r\n        if(i == k){\r\n            return usersStatuses[i]\r\n        }\r\n    }\r\n}\r\n\r\nexport default function SearchBlock({user}) {\r\n    const [admin, setAdmin] = useState([''])\r\n    const [dateStart, setDateStar] = useState(null)\r\n    const [dateEnd, setDateEn] = useState(null)\r\n\r\n    useEffect(() => {\r\n        const fetchUser = async () => {\r\n            const res = await axios.get('/api/vacation?id='+user.id)\r\n\r\n            if(res.data.length===0){\r\n                setDateStar(global.workdate='')\r\n                setDateEn(global.worked='')\r\n            }else{\r\n                global.workdate=res.data[0].workdate\r\n                global.worked=res.data[0].worked\r\n                setDateStar(global.workdate)\r\n                setDateEn(global.worked)\r\n            }\r\n            const users = await axios.get('/api/user/'+user.id)\r\n\r\n\r\n            if(users.data.isadmin===true){\r\n                setAdmin('*')}else{\r\n                setAdmin('')\r\n            }}\r\n\r\n        if(user.status===3){\r\n            fetchUser()}\r\n\r\n        if(user.status===7){\r\n            fetchUser()\r\n        }\r\n\r\n        if(user.status===1){\r\n            fetchUser()}\r\n\r\n        if(user.status===6){\r\n            fetchUser()}\r\n\r\n        if(user.status===5){\r\n            fetchUser()\r\n        }\r\n        if(user.status===2){\r\n            fetchUser()\r\n\r\n\r\n        }}, [user._id])\r\n\r\n    const localUser = JSON.parse(localStorage.getItem('user'))\r\n    const name=user.email.toLowerCase()\r\n    return (\r\n        <div className=\"searchBlockContainer\">\r\n            {user.status === 4 && !localUser.isAdmin ? <div></div> :\r\n                <div className={'employee ' + (findStatus(user.status))}>\r\n                    <div className='top'>{localUser.isAdmin ?\r\n                        <Link to={`/profile/${user.id}`} onClick={() => window.location.href = `/profile/${user.id}`}\r\n                              className='name'>\r\n                            <div className='name'>{user.user_name}{admin}</div>\r\n                        </Link> : <div className='name'><span>{user.user_name}{admin}</span></div>\r\n                    }\r\n                 </div>\r\n                    <div className='email'>{name.charAt(0).toUpperCase() + name.slice(1)}</div>\r\n                    {user.status === 5 && <div className='vacationText'>Отпуск:{global.workdate}-{global.worked}</div>}\r\n                    {user.status === 6 && <div className='vacationText'>Отгул:{global.workdate}-{global.worked}</div>}\r\n                    {user.status === 7 && <div className='vacationText'>Другая причина:{global.workdate}-{global.worked}</div>}\r\n                    {user.status === 3 && <div className='vacationText'>Больничный:{global.workdate}-{global.worked}</div>}\r\n\r\n                </div>\r\n            }\r\n        </div>\r\n    )\r\n}\r\n\r\n"]},"metadata":{},"sourceType":"module"}