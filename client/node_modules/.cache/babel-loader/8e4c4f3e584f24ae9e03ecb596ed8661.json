{"ast":null,"code":"import _regeneratorRuntime from\"D:/time_app/client/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"D:/time_app/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"D:/time_app/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useRef,useState}from'react';import Modal from\"../../Templates/Modal/Modal\";import axios from\"axios\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function ChangePassword(_ref){var modalActivePass=_ref.modalActivePass,setModalActivePass=_ref.setModalActivePass;var localUse=JSON.parse(localStorage.getItem('user'));var _useState=useState(''),_useState2=_slicedToArray(_useState,2),er=_useState2[0],setErr=_useState2[1];var modalOldPass=useRef();var modalNewPass=useRef();var modalNewPassAgain=useRef();var handleChangePassword=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var passwords;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();if(!(modalNewPass.current.value!==modalNewPassAgain.current.value)){_context.next=4;break;}setErr('Новые пароли не совпадают');return _context.abrupt(\"return\");case 4:passwords={userId:localUse._id,password:localUse.password,oldPassword:modalOldPass.current.value,newPassword:modalNewPass.current.value};_context.prev=5;_context.next=8;return axios.put('/api/newPassword/',passwords);case 8:setModalActivePass(false);/*      localStorage.clear()\r\n                  window.location.reload()\r\n                  window.location.href = '/'*/_context.next=14;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](5);setErr('Старые пароли не совпадают');case 14:case\"end\":return _context.stop();}}},_callee,null,[[5,11]]);}));return function handleChangePassword(_x){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(Modal,{active:modalActivePass,setActive:setModalActivePass,children:[/*#__PURE__*/_jsx(\"h1\",{children:\"\\u0418\\u0437\\u043C\\u0435\\u043D\\u0435\\u043D\\u0438\\u0435 \\u0438\\u043D\\u0444\\u043E\\u0440\\u043C\\u0430\\u0446\\u0438\\u0438:\"}),/*#__PURE__*/_jsx(\"hr\",{}),er&&/*#__PURE__*/_jsx(\"div\",{className:\"modalError\",children:er}),/*#__PURE__*/_jsxs(\"form\",{className:\"modalLoginBox\",onSubmit:handleChangePassword,children:[/*#__PURE__*/_jsx(\"input\",{placeholder:\"\\u0421\\u0442\\u0430\\u0440\\u044B\\u0439 \\u043F\\u0430\\u0440\\u043E\\u043B\\u044C\",type:\"password\",className:\"inputChangePassword\",ref:modalOldPass}),/*#__PURE__*/_jsx(\"input\",{placeholder:\"\\u041D\\u043E\\u0432\\u044B\\u0439 \\u043F\\u0430\\u0440\\u043E\\u043B\\u044C\",type:\"password\",className:\"inputChangePassword\",ref:modalNewPass,minLength:\"6\"}),/*#__PURE__*/_jsx(\"input\",{placeholder:\"\\u041D\\u043E\\u0432\\u044B\\u0439 \\u043F\\u0430\\u0440\\u043E\\u043B\\u044C \\u0435\\u0449\\u0451 \\u0440\\u0430\\u0437\",type:\"password\",className:\"inputChangePassword\",ref:modalNewPassAgain,minLength:\"6\"}),/*#__PURE__*/_jsx(\"button\",{className:\"ModalButtonChangePassword\",type:\"submit\",children:\"\\u0418\\u0437\\u043C\\u0435\\u043D\\u0438\\u0442\\u044C\"})]})]});}export default ChangePassword;","map":{"version":3,"sources":["D:/time_app/client/src/components/ProfileInfo/СhangePassword/СhangePassword.jsx"],"names":["React","useRef","useState","Modal","axios","ChangePassword","modalActivePass","setModalActivePass","localUse","JSON","parse","localStorage","getItem","er","setErr","modalOldPass","modalNewPass","modalNewPassAgain","handleChangePassword","e","preventDefault","current","value","passwords","userId","_id","password","oldPassword","newPassword","put"],"mappings":"4SAAA,MAAOA,CAAAA,KAAP,EAAgBC,MAAhB,CAAwBC,QAAxB,KAAwC,OAAxC,CACA,MAAOC,CAAAA,KAAP,KAAkB,6BAAlB,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,C,wFAGA,QAASC,CAAAA,cAAT,MAA8D,IAArCC,CAAAA,eAAqC,MAArCA,eAAqC,CAArBC,kBAAqB,MAArBA,kBAAqB,CAC1D,GAAMC,CAAAA,QAAQ,CAAGC,IAAI,CAACC,KAAL,CAAWC,YAAY,CAACC,OAAb,CAAqB,MAArB,CAAX,CAAjB,CACA,cAAqBV,QAAQ,CAAC,EAAD,CAA7B,wCAAOW,EAAP,eAAWC,MAAX,eACA,GAAMC,CAAAA,YAAY,CAAGd,MAAM,EAA3B,CACA,GAAMe,CAAAA,YAAY,CAAGf,MAAM,EAA3B,CACA,GAAMgB,CAAAA,iBAAiB,CAAGhB,MAAM,EAAhC,CAEA,GAAMiB,CAAAA,oBAAoB,2FAAG,iBAAOC,CAAP,gIACzBA,CAAC,CAACC,cAAF,GADyB,KAErBJ,YAAY,CAACK,OAAb,CAAqBC,KAArB,GAA+BL,iBAAiB,CAACI,OAAlB,CAA0BC,KAFpC,0BAGrBR,MAAM,CAAC,2BAAD,CAAN,CAHqB,wCAMnBS,SANmB,CAMP,CACdC,MAAM,CAAEhB,QAAQ,CAACiB,GADH,CAEdC,QAAQ,CAAElB,QAAQ,CAACkB,QAFL,CAGdC,WAAW,CAAEZ,YAAY,CAACM,OAAb,CAAqBC,KAHpB,CAIdM,WAAW,CAAEZ,YAAY,CAACK,OAAb,CAAqBC,KAJpB,CANO,uCAaflB,CAAAA,KAAK,CAACyB,GAAN,CAAU,mBAAV,CAA+BN,SAA/B,CAbe,QAcrBhB,kBAAkB,CAAC,KAAD,CAAlB,CACA;AACZ;AACA,8CAjBiC,iFAmBrBO,MAAM,CAAC,4BAAD,CAAN,CAnBqB,qEAAH,kBAApBI,CAAAA,oBAAoB,6CAA1B,CAsBA,mBACI,MAAC,KAAD,EAAO,MAAM,CAAEZ,eAAf,CAAgC,SAAS,CAAEC,kBAA3C,wBACI,4IADJ,cAEI,aAFJ,CAGKM,EAAE,eAAI,YAAK,SAAS,CAAC,YAAf,UAA6BA,EAA7B,EAHX,cAII,cAAM,SAAS,CAAC,eAAhB,CAAgC,QAAQ,CAAEK,oBAA1C,wBACI,cACI,WAAW,CAAC,2EADhB,CAEI,IAAI,CAAC,UAFT,CAGI,SAAS,CAAC,qBAHd,CAII,GAAG,CAAEH,YAJT,EADJ,cAOI,cACI,WAAW,CAAC,qEADhB,CAEI,IAAI,CAAC,UAFT,CAGI,SAAS,CAAC,qBAHd,CAII,GAAG,CAAEC,YAJT,CAKI,SAAS,CAAC,GALd,EAPJ,cAcI,cACI,WAAW,CAAC,2GADhB,CAEI,IAAI,CAAC,UAFT,CAGI,SAAS,CAAC,qBAHd,CAII,GAAG,CAAEC,iBAJT,CAKI,SAAS,CAAC,GALd,EAdJ,cAqBI,eAAQ,SAAS,CAAC,2BAAlB,CAA8C,IAAI,CAAC,QAAnD,8DArBJ,GAJJ,GADJ,CAiCH,CAED,cAAeZ,CAAAA,cAAf","sourcesContent":["import React, { useRef, useState } from 'react';\r\nimport Modal from \"../../Templates/Modal/Modal\";\r\nimport axios from \"axios\";\r\n\r\n\r\nfunction ChangePassword({modalActivePass,setModalActivePass}) {\r\n    const localUse = JSON.parse(localStorage.getItem('user'))\r\n    const [er, setErr] = useState('')\r\n    const modalOldPass = useRef()\r\n    const modalNewPass = useRef()\r\n    const modalNewPassAgain = useRef()\r\n\r\n    const handleChangePassword = async (e) => {\r\n        e.preventDefault()\r\n        if (modalNewPass.current.value !== modalNewPassAgain.current.value) {\r\n            setErr('Новые пароли не совпадают')\r\n            return\r\n        }\r\n        const passwords = {\r\n            userId: localUse._id,\r\n            password: localUse.password,\r\n            oldPassword: modalOldPass.current.value,\r\n            newPassword: modalNewPass.current.value\r\n        }\r\n        try {\r\n            await axios.put('/api/newPassword/', passwords)\r\n            setModalActivePass(false)\r\n            /*      localStorage.clear()\r\n                  window.location.reload()\r\n                  window.location.href = '/'*/\r\n        } catch (er) {\r\n            setErr('Старые пароли не совпадают')\r\n        }\r\n    }\r\n    return (\r\n        <Modal active={modalActivePass} setActive={setModalActivePass}>\r\n            <h1>Изменение информации:</h1>\r\n            <hr/>\r\n            {er && <div className='modalError'>{er}</div>}\r\n            <form className=\"modalLoginBox\" onSubmit={handleChangePassword}>\r\n                <input\r\n                    placeholder=\"Старый пароль\"\r\n                    type='password'\r\n                    className=\"inputChangePassword\"\r\n                    ref={modalOldPass}\r\n                />\r\n                <input\r\n                    placeholder=\"Новый пароль\"\r\n                    type='password'\r\n                    className=\"inputChangePassword\"\r\n                    ref={modalNewPass}\r\n                    minLength='6'\r\n                />\r\n                <input\r\n                    placeholder=\"Новый пароль ещё раз\"\r\n                    type='password'\r\n                    className=\"inputChangePassword\"\r\n                    ref={modalNewPassAgain}\r\n                    minLength='6'\r\n                />\r\n                <button className=\"ModalButtonChangePassword\" type=\"submit\" >\r\n                    Изменить\r\n                </button>\r\n            </form>\r\n        </Modal>\r\n    );\r\n\r\n}\r\n\r\nexport default ChangePassword;"]},"metadata":{},"sourceType":"module"}