{"ast":null,"code":"var _jsxFileName = \"D:\\\\Download\\\\time_app\\\\client\\\\src\\\\components\\\\ProfileInfo\\\\ProfileInfo.jsx\",\n    _s = $RefreshSig$();\n\nimport axios from 'axios';\nimport { useEffect, useRef, useState } from 'react';\nimport { Create, Delete } from '@material-ui/icons';\nimport Modal from '../Templates/Modal/Modal';\nimport './ProfileInfo.css';\nimport { useParams } from \"react-router-dom\";\nimport { CircularProgress } from \"@material-ui/core\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport default function ProfileInfo() {\n  _s();\n\n  const [user, setUser] = useState([]);\n  const [isFetching, setIsFetching] = useState(false);\n  const [modalActive, setModalActive] = useState(false);\n  const [modalActivePass, setModalActivePass] = useState(false);\n  const [modalActiveResetPass, setModalActiveResetPass] = useState(false);\n  const [modalActiveDelete, setModalActiveDelete] = useState(false);\n  const [deps, setDeps] = useState([]);\n  const [error, setError] = useState('');\n  const [er, setErr] = useState('');\n  const [posts, setPosts] = useState([]);\n  const username = useParams();\n  let localUser = !!username ? {\n    _id: username.username,\n    email: \"\"\n  } : JSON.parse(localStorage.getItem('user'));\n  const localUse = JSON.parse(localStorage.getItem('user'));\n  const departId = useParams().username;\n  const modalName = useRef();\n  const modalDep = useRef();\n  const modalEmail = useRef();\n  const modalOldPass = useRef();\n  const modalNewPass = useRef();\n  const modalNewPassAgain = useRef();\n  const modalComment = useRef();\n  const usersStatuses = {\n    0: '',\n    1: 'start',\n    2: 'end',\n    3: 'sick_leave',\n    4: 'deleted',\n    5: 'vacation',\n    6: 'time_off',\n    7: 'other'\n  };\n\n  function findStatus(k) {\n    for (let i in usersStatuses) {\n      if (i == k) {\n        return usersStatuses[i];\n      }\n    }\n  }\n\n  const handleName = e => {\n    setModalName(e.target.value);\n  }; // данные о пользователе\n\n\n  useEffect(() => {\n    setIsFetching(true);\n\n    const fetchUser = async () => {\n      localUser._id = !!localUser._id ? localUser._id : localUser.id;\n      localUser._id = !!username ? username.username : localUser._id;\n      const res = await axios.get('/api/user/' + localUser._id);\n      setUser(res.data);\n      setIsFetching(false);\n    };\n\n    fetchUser();\n  }, [username]); // все возможные департаменты\n\n  useEffect(() => {\n    const getDeps = async () => {\n      const res = await axios.get('/api/departments/');\n      setDeps(res.data);\n    };\n\n    getDeps();\n  }, []); // данные о работе от последнего к первому\n\n  /*  useEffect(() => {\n      setIsFetching(true)\n      const fetchUser = async () => {\n        const res = await axios.get('/api/user/')\n        setPosts(res.data.sort((p1, p2) => {\n          return new Date(p2.workStart) - new Date(p1.workStart)\n        }))\n        setIsFetching(false)\n      }\n      fetchUser()\n    }, [username])*/\n\n  console.log(\"DEPART=\", departId); // изменение данных пользователя\n\n  const handleClick = async e => {\n    e.preventDefault();\n    const oldItems = JSON.parse(localStorage.getItem('user'));\n    const newInfo = {\n      _id: username.username,\n      isAdmin: localUse.isAdmin,\n      username: modalName.current.value || user.username,\n      email: modalEmail.current.value.toUpperCase() || user.email,\n      departmentId: modalDep.current.value || user.departmentId,\n      status: 2,\n      main_department: oldItems.main_department\n    };\n\n    try {\n      await axios.put('/api/user/', newInfo);\n\n      if (user._id === localUser._id) {\n        newInfo.password = localUser.password;\n        localStorage.clear();\n        localStorage.setItem('user', JSON.stringify({ ...newInfo\n        }));\n      }\n\n      window.location.reload();\n    } catch (error) {\n      setError(\"Такой email существует\");\n    }\n  }; // изменить пароль\n\n\n  const handleClickPassword = async e => {\n    e.preventDefault();\n\n    if (modalNewPass.current.value !== modalNewPassAgain.current.value) {\n      setErr('Новые пароли не совпадают');\n      return;\n    }\n\n    const passwords = {\n      userId: localUse._id,\n      password: localUse.password,\n      oldPassword: modalOldPass.current.value,\n      newPassword: modalNewPass.current.value\n    };\n\n    try {\n      await axios.put('/api/newPassword/', passwords);\n      setModalActivePass(false);\n      /*      localStorage.clear()\n            window.location.reload()\n            window.location.href = '/'*/\n    } catch (er) {\n      setErr('Старые пароли не совпадают');\n    }\n  }; // сбросить пароль\n\n\n  const handleResetPass = async e => {\n    e.preventDefault();\n    const resetPassword = {\n      userId: username.username,\n      newPassword: 'qwerty123'\n    };\n\n    try {\n      await axios.put('/api/resetPassword/', resetPassword);\n      setModalActiveResetPass(false);\n    } catch (error) {\n      console.log('Ошибка');\n    }\n  };\n\n  const status = async e => {\n    const status = {\n      userId: user._id,\n      typework_id: 1,\n      status: 2,\n      healthEnd: +modalName,\n      commentEnd: modalComment.current.value || '-',\n      workEnd: new Date(Date.now())\n    };\n    console.log('status=', status);\n    await axios.put('/api/status/', status);\n  }; // удалить пользователя\n\n\n  const handleDelete = async e => {\n    e.preventDefault();\n    setIsFetching(true);\n    const newPost = {\n      userId: username.username,\n      healthEnd: 1,\n      status: 4\n      /*      workEnd: new Date(Date.now()),\n            workTime: new Date(Date.now()) - new Date(posts[0].workStart)*/\n\n    };\n    /* localStorage.setItem('user', JSON.stringify({...localUser, status:3}))*/\n\n    try {\n      await axios.put('/api/deluser/', newPost);\n      /*      if(user.status === 1){\n              await axios.put(\"/api/post/\"+posts[0]._id, newPost)\n            }*/\n\n      /*      localStorage.clear()\n            window.location.reload()\n            window.location.href = '/'*/\n\n      setModalActiveDelete(false);\n      window.location.href = `/profile/${user.id}`;\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  localUser = !!user && !Array.isArray(user) ? user : localUser;\n  localUser.username = !!localUser.user_name ? localUser.user_name : localUser.username;\n  const name = localUser.email.toLowerCase();\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"profileInfo\",\n    children: [isFetching ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"isFatching\",\n      children: \"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 201,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      className: 'employeePI ' + findStatus(user.status),\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"top\",\n        children: /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"name\",\n          children: [localUser.username, localUser ? /*#__PURE__*/_jsxDEV(Create, {\n            style: {\n              fontSize: 'medium',\n              cursor: 'pointer',\n              marginLeft: '10px'\n            },\n            onClick: () => setModalActive(true)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 206,\n            columnNumber: 28\n          }, this) : '', localUse.isAdmin ? /*#__PURE__*/_jsxDEV(Delete, {\n            style: {\n              cursor: 'pointer',\n              fontSize: 'medium'\n            },\n            onClick: () => setModalActiveDelete(true)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 207,\n            columnNumber: 35\n          }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {}, void 0, false)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 204,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 203,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          fontSize: '18px'\n        },\n        className: \"email\",\n        children: name.charAt(0).toUpperCase() + name.slice(1)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 210,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"hr\", {\n        className: \"hr\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 211,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"changePass\",\n        onClick: () => setModalActivePass(true),\n        children: \"\\u0418\\u0437\\u043C\\u0435\\u043D\\u0438\\u0442\\u044C \\u043F\\u0430\\u0440\\u043E\\u043B\\u044C\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 212,\n        columnNumber: 14\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"changePass\",\n        style: {\n          width: \"20px\"\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 213,\n        columnNumber: 13\n      }, this), localUse.isAdmin ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"changePass\",\n        onClick: () => setModalActiveResetPass(true),\n        children: \"\\u0421\\u0431\\u0440\\u043E\\u0441\\u0438\\u0442\\u044C \\u043F\\u0430\\u0440\\u043E\\u043B\\u044C\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 214,\n        columnNumber: 33\n      }, this) : '', /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"changePass\",\n        style: {\n          width: \"20px\"\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 215,\n        columnNumber: 13\n      }, this), localUse.isAdmin ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"changePass\",\n        onClick: status,\n        children: \"\\u0417\\u0430\\u043A\\u043E\\u043D\\u0447\\u0438\\u0442\\u044C\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 216,\n        columnNumber: 33\n      }, this) : '']\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 202,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(Modal, {\n      active: modalActive,\n      setActive: setModalActive,\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        children: \"\\u0418\\u0437\\u043C\\u0435\\u043D\\u0435\\u043D\\u0438\\u0435 \\u0438\\u043D\\u0444\\u043E\\u0440\\u043C\\u0430\\u0446\\u0438\\u0438:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 222,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"hr\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 223,\n        columnNumber: 9\n      }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"modalError\",\n        children: error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 224,\n        columnNumber: 19\n      }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n        className: \"modalLoginBox\",\n        onSubmit: handleClick,\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          placeholder: \"Name\",\n          className: \"ModalInput\",\n          ref: modalName\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 226,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n          ref: modalDep,\n          children: deps.map((dep, id) => /*#__PURE__*/_jsxDEV(\"option\", {\n            value: dep.id,\n            children: dep.department_name\n          }, id, false, {\n            fileName: _jsxFileName,\n            lineNumber: 233,\n            columnNumber: 36\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 231,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          placeholder: \"Email\",\n          type: \"email\",\n          className: \"ModalInput\",\n          ref: modalEmail,\n          minLength: \"6\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 235,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"ModalButton\",\n          type: \"submit\",\n          disabled: isFetching,\n          children: \"\\u0418\\u0437\\u043C\\u0435\\u043D\\u0438\\u0442\\u044C\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 242,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 225,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 221,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Modal, {\n      active: modalActivePass,\n      setActive: setModalActivePass,\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        children: \"\\u0418\\u0437\\u043C\\u0435\\u043D\\u0435\\u043D\\u0438\\u0435 \\u0438\\u043D\\u0444\\u043E\\u0440\\u043C\\u0430\\u0446\\u0438\\u0438:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 248,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"hr\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 249,\n        columnNumber: 9\n      }, this), er && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"modalError\",\n        children: er\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 250,\n        columnNumber: 16\n      }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n        className: \"modalLoginBox\",\n        onSubmit: handleClickPassword,\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          placeholder: \"Old Password\",\n          type: \"password\",\n          className: \"ModalInput\",\n          ref: modalOldPass\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 252,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          placeholder: \"New Password\",\n          type: \"password\",\n          className: \"ModalInput\",\n          ref: modalNewPass,\n          minLength: \"6\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 258,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          placeholder: \"New Password Again\",\n          type: \"password\",\n          className: \"ModalInput\",\n          ref: modalNewPassAgain,\n          minLength: \"6\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 265,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"ModalButton\",\n          type: \"submit\",\n          disabled: isFetching,\n          children: \"\\u0418\\u0437\\u043C\\u0435\\u043D\\u0438\\u0442\\u044C\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 272,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 251,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 247,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Modal, {\n      active: modalActiveResetPass,\n      setActive: setModalActiveResetPass,\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        children: \"\\u0418\\u0437\\u043C\\u0435\\u043D\\u0435\\u043D\\u0438\\u0435 \\u0438\\u043D\\u0444\\u043E\\u0440\\u043C\\u0430\\u0446\\u0438\\u0438:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 278,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"hr\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 279,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n        className: \"modalLoginBox\",\n        onSubmit: handleResetPass,\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          children: \"\\u041D\\u043E\\u0432\\u044B\\u0439 \\u043F\\u0430\\u0440\\u043E\\u043B\\u044C \\u0431\\u0443\\u0434\\u0435\\u0442: qwerty123\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 281,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"ModalButton\",\n          type: \"submit\",\n          disabled: isFetching,\n          children: \"\\u0421\\u0431\\u0440\\u043E\\u0441\\u0438\\u0442\\u044C\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 282,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 280,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 277,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Modal, {\n      active: modalActiveDelete,\n      setActive: setModalActiveDelete,\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        children: \"\\u0418\\u0437\\u043C\\u0435\\u043D\\u0435\\u043D\\u0438\\u0435 \\u0438\\u043D\\u0444\\u043E\\u0440\\u043C\\u0430\\u0446\\u0438\\u0438:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 288,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"hr\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 289,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n        className: \"modalLoginBox\",\n        onSubmit: handleDelete,\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          children: \"\\u041F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u044C \\u0431\\u0443\\u0434\\u0435\\u0442 \\u0443\\u0434\\u0430\\u043B\\u0435\\u043D\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 291,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"ModalButton\",\n          type: \"submit\",\n          disabled: isFetching,\n          children: \"\\u0423\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 292,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 290,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 287,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"statusBtn\",\n        type: \"submit\",\n        onClick: () => setModalActive(true),\n        className: 'statusBtn ' + findStatus(user.status),\n        children: isFetching ? /*#__PURE__*/_jsxDEV(CircularProgress, {\n          style: {\n            color: 'white',\n            size: '20px',\n            width: '20px',\n            height: '20px'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 300,\n          columnNumber: 17\n        }, this) : user.status !== 1 ? 'Начать' : 'Закончить'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 298,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Modal, {\n        active: modalActive,\n        setActive: setModalActive,\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          children: \"\\u0418\\u0437\\u043C\\u0435\\u043D\\u0435\\u043D\\u0438\\u0435 \\u0438\\u043D\\u0444\\u043E\\u0440\\u043C\\u0430\\u0446\\u0438\\u0438:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 307,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"hr\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 308,\n          columnNumber: 11\n        }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"modalError\",\n          children: error\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 309,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n          className: \"modalLoginBox\",\n          onSubmit: user.status === 1 ? handlerEnd : handlerStart,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              display: 'flex',\n              justifyContent: 'space-between',\n              fontSize: '20px',\n              width: '30%',\n              marginLeft: '35%',\n              marginTop: '30px'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              htmlFor: \"sickLeave\",\n              children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"radio\",\n                value: 1,\n                id: \"sickLeave\",\n                name: \"sickLeave\",\n                onChange: handleName,\n                checked: +modalName === 1\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 313,\n                columnNumber: 17\n              }, this), \"\\u0417\\u0434\\u043E\\u0440\\u043E\\u0432\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 312,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n              htmlFor: \"vacation\",\n              children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"radio\",\n                value: 0,\n                id: \"vacation\",\n                name: \"vacation\",\n                onChange: handleName,\n                checked: +modalName === 0\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 322,\n                columnNumber: 17\n              }, this), \"\\u0411\\u043E\\u043B\\u0435\\u043D\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 321,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 311,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            placeholder: \"\\u041A\\u043E\\u043C\\u043C\\u0435\\u043D\\u0442\\u0430\\u0440\\u0438\\u0439\",\n            className: \"ModalInput\",\n            ref: modalComment\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 331,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"ModalButton\",\n            type: \"submit\",\n            disabled: isFetching,\n            children: \"\\u043E\\u043A\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 336,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 310,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 306,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 199,\n    columnNumber: 5\n  }, this);\n}\n\n_s(ProfileInfo, \"NT/QHXrub3Gj3a0zzVDyCJ9agvc=\", false, function () {\n  return [useParams, useParams];\n});\n\n_c = ProfileInfo;\n\nvar _c;\n\n$RefreshReg$(_c, \"ProfileInfo\");","map":{"version":3,"sources":["D:/Download/time_app/client/src/components/ProfileInfo/ProfileInfo.jsx"],"names":["axios","useEffect","useRef","useState","Create","Delete","Modal","useParams","CircularProgress","ProfileInfo","user","setUser","isFetching","setIsFetching","modalActive","setModalActive","modalActivePass","setModalActivePass","modalActiveResetPass","setModalActiveResetPass","modalActiveDelete","setModalActiveDelete","deps","setDeps","error","setError","er","setErr","posts","setPosts","username","localUser","_id","email","JSON","parse","localStorage","getItem","localUse","departId","modalName","modalDep","modalEmail","modalOldPass","modalNewPass","modalNewPassAgain","modalComment","usersStatuses","findStatus","k","i","handleName","e","setModalName","target","value","fetchUser","id","res","get","data","getDeps","console","log","handleClick","preventDefault","oldItems","newInfo","isAdmin","current","toUpperCase","departmentId","status","main_department","put","password","clear","setItem","stringify","window","location","reload","handleClickPassword","passwords","userId","oldPassword","newPassword","handleResetPass","resetPassword","typework_id","healthEnd","commentEnd","workEnd","Date","now","handleDelete","newPost","href","Array","isArray","user_name","name","toLowerCase","fontSize","cursor","marginLeft","charAt","slice","width","map","dep","department_name","color","size","height","handlerEnd","handlerStart","display","justifyContent","marginTop"],"mappings":"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","sourcesContent":["import axios from 'axios'\nimport { useEffect, useRef, useState } from 'react'\nimport { Create, Delete } from '@material-ui/icons'\nimport Modal from '../Templates/Modal/Modal'\nimport './ProfileInfo.css'\nimport {useParams} from \"react-router-dom\";\nimport {CircularProgress} from \"@material-ui/core\";\nexport default function ProfileInfo() {\n  const [user, setUser] = useState([])\n  const [isFetching, setIsFetching] = useState(false)\n  const [modalActive, setModalActive] = useState(false)\n  const [modalActivePass, setModalActivePass] = useState(false)\n  const [modalActiveResetPass, setModalActiveResetPass] = useState(false)\n  const [modalActiveDelete, setModalActiveDelete] = useState(false)\n  const [deps, setDeps] = useState([])\n  const [error, setError] = useState('')\n  const [er, setErr] = useState('')\n  const [posts, setPosts] = useState([])\n  const username=useParams()\n  let localUser = !!username ? {_id:username.username,email:\"\"} : JSON.parse(localStorage.getItem('user'))\n  const localUse = JSON.parse(localStorage.getItem('user'))\n  const departId = useParams().username\n  const modalName = useRef()\n  const modalDep = useRef()\n  const modalEmail = useRef()\n  const modalOldPass = useRef()\n  const modalNewPass = useRef()\n  const modalNewPassAgain = useRef()\n  const modalComment = useRef()\n\n  const usersStatuses = {0: '', 1: 'start', 2: 'end', 3: 'sick_leave', 4: 'deleted' ,5: 'vacation', 6: 'time_off', 7: 'other'}\n  function findStatus(k){\n    for(let i in usersStatuses){\n      if(i == k){\n        return usersStatuses[i]\n      }\n    }\n  }\n  const handleName = e => {\n    setModalName(e.target.value)\n  }\n\n  // данные о пользователе\n  useEffect(() => {\n    setIsFetching(true)\n    const fetchUser = async () => {\n      localUser._id=!!localUser._id ? localUser._id:localUser.id\n      localUser._id=!!username ? username.username:localUser._id\n      const res = await axios.get('/api/user/'+localUser._id)\n      setUser(res.data)\n      setIsFetching(false)\n    }\n    fetchUser()\n  }, [username])\n\n  // все возможные департаменты\n  useEffect(() => {\n    const getDeps = async () => {\n      const res = await axios.get('/api/departments/')\n      setDeps(res.data)\n    }\n    getDeps()\n  }, [])\n\n\n\n\n\n\n  // данные о работе от последнего к первому\n/*  useEffect(() => {\n    setIsFetching(true)\n    const fetchUser = async () => {\n      const res = await axios.get('/api/user/')\n      setPosts(res.data.sort((p1, p2) => {\n        return new Date(p2.workStart) - new Date(p1.workStart)\n      }))\n      setIsFetching(false)\n    }\n    fetchUser()\n  }, [username])*/\nconsole.log(\"DEPART=\",departId)\n  // изменение данных пользователя\n  const handleClick = async (e) => {\n    e.preventDefault()\n    const oldItems = JSON.parse(localStorage.getItem('user'))\n    const newInfo= {\n      _id: username.username,\n      isAdmin:localUse.isAdmin,\n      username: modalName.current.value || user.username,\n      email: modalEmail.current.value.toUpperCase() || user.email,\n      departmentId: modalDep.current.value || user.departmentId,\n      status:2,\n      main_department:oldItems.main_department\n    }\n\n    try {\n      await axios.put('/api/user/', newInfo)\n      if(user._id === localUser._id){\n        newInfo.password = localUser.password\n        localStorage.clear()\n        localStorage.setItem('user', JSON.stringify({...newInfo}))\n\n      }\n      window.location.reload()\n    } catch (error) {\n      setError(\"Такой email существует\")\n    }\n  }\n\n  // изменить пароль\n  const handleClickPassword = async (e) => {\n\n    e.preventDefault()\n    if(modalNewPass.current.value !== modalNewPassAgain.current.value){\n      setErr('Новые пароли не совпадают')\n      return }\n    const passwords = {\n      userId: localUse._id,\n      password: localUse.password,\n      oldPassword: modalOldPass.current.value,\n      newPassword: modalNewPass.current.value\n    }\n    try {\n\n      await axios.put('/api/newPassword/', passwords)\n      setModalActivePass(false)\n/*      localStorage.clear()\n      window.location.reload()\n      window.location.href = '/'*/\n    } catch (er) {\n      setErr('Старые пароли не совпадают')\n    }\n  }\n\n  // сбросить пароль\n  const handleResetPass = async (e) => {\n    e.preventDefault()\n\n    const resetPassword = {\n      userId: username.username,\n      newPassword: 'qwerty123'\n    }\n\n    try {\n      await axios.put('/api/resetPassword/', resetPassword)\n      setModalActiveResetPass(false)\n    } catch (error) {\n      console.log('Ошибка');\n    }\n  }\n  const status = async (e) => {\n  const status ={\n    userId: user._id,\n    typework_id: 1,\n    status: 2,\n    healthEnd: +modalName,\n    commentEnd: modalComment.current.value  || '-',\n    workEnd: new Date(Date.now())\n\n  }\n  console.log('status=',status)\n  await axios.put('/api/status/',status)\n  }\n\n  // удалить пользователя\n  const handleDelete = async (e) => {\n    e.preventDefault()\n    setIsFetching(true)\n\n    const newPost = {\n      userId: username.username,\n      healthEnd: 1,\n      status: 4\n/*      workEnd: new Date(Date.now()),\n      workTime: new Date(Date.now()) - new Date(posts[0].workStart)*/\n    }\n /* localStorage.setItem('user', JSON.stringify({...localUser, status:3}))*/\n    try {\n      await axios.put('/api/deluser/', newPost)\n/*      if(user.status === 1){\n        await axios.put(\"/api/post/\"+posts[0]._id, newPost)\n      }*/\n/*      localStorage.clear()\n      window.location.reload()\n      window.location.href = '/'*/\n      setModalActiveDelete(false)\n      window.location.href = `/profile/${user.id}`\n    } catch (error) {\n      console.log(error);\n    }\n  }\n  localUser =(!!user && ! Array.isArray(user)) ? user:localUser\n  localUser.username=!!localUser.user_name ? localUser.user_name : localUser.username\n  const name=localUser.email.toLowerCase()\n\n\n  return (\n    <div className='profileInfo'>\n      {isFetching\n      ? <div className='isFatching'>Загрузка...</div>\n      : <div className={'employeePI ' + (findStatus(user.status))}>\n          <div className='top'>\n            <span className='name'>\n              {localUser.username}\n              {localUser ? <Create style={{fontSize:'medium', cursor:'pointer', marginLeft:'10px'}} onClick={() => setModalActive(true)}/> : ''}\n              {localUse.isAdmin ? <Delete style={{cursor:'pointer', fontSize:'medium'}}  onClick={() => setModalActiveDelete(true)}/> : <></>}\n            </span>\n          </div>\n          <div style={{fontSize:'18px'}} className='email'>{name.charAt(0).toUpperCase() + name.slice(1)}</div>\n          <hr className=\"hr\"/>\n            {<div className='changePass' onClick={() => setModalActivePass(true)}>Изменить пароль</div>}\n            <div className='changePass' style={{width: \"20px\"}}></div>\n            {localUse.isAdmin ? <div className='changePass' onClick={() => setModalActiveResetPass(true)}>Сбросить пароль</div>:''}\n            <div className='changePass' style={{width: \"20px\"}}></div>\n            {localUse.isAdmin ? <div className='changePass' onClick={status}>Закончить</div>:''}\n      </div>\n\n\n      }\n      <Modal active={modalActive} setActive={setModalActive}>\n        <h1>Изменение информации:</h1>\n        <hr/>\n        {error && <div className='modalError'>{error}</div>}\n        <form className=\"modalLoginBox\" onSubmit={handleClick}>\n          <input \n            placeholder=\"Name\"\n            className=\"ModalInput\"  \n            ref={modalName} \n          />\n          <select ref={modalDep}>\n            {/*<option value=''>Отдел</option>*/}\n            {deps.map((dep, id) => <option key={id} value={dep.id}>{dep.department_name}</option>)}\n          </select>\n          <input \n            placeholder=\"Email\" \n            type='email' \n            className=\"ModalInput\" \n            ref={modalEmail} \n            minLength='6'\n          />\n          <button className=\"ModalButton\" type=\"submit\" disabled={isFetching}>\n            Изменить\n          </button>\n        </form>\n      </Modal>\n      <Modal active={modalActivePass} setActive={setModalActivePass}>\n        <h1>Изменение информации:</h1>\n        <hr/>\n        {er && <div className='modalError'>{er}</div>}\n        <form className=\"modalLoginBox\" onSubmit={handleClickPassword}>\n          <input \n            placeholder=\"Old Password\"\n            type='password' \n            className=\"ModalInput\"  \n            ref={modalOldPass} \n          />\n          <input \n            placeholder=\"New Password\" \n            type='password' \n            className=\"ModalInput\" \n            ref={modalNewPass} \n            minLength='6'\n          />\n          <input \n            placeholder=\"New Password Again\" \n            type='password' \n            className=\"ModalInput\" \n            ref={modalNewPassAgain} \n            minLength='6'\n          />\n          <button className=\"ModalButton\" type=\"submit\" disabled={isFetching}>\n            Изменить\n          </button>\n        </form>\n      </Modal>\n      <Modal active={modalActiveResetPass} setActive={setModalActiveResetPass}>\n        <h1>Изменение информации:</h1>\n        <hr/>\n        <form className=\"modalLoginBox\" onSubmit={handleResetPass}>\n          <h2>Новый пароль будет: qwerty123</h2>\n          <button className=\"ModalButton\" type=\"submit\" disabled={isFetching}>\n            Сбросить\n          </button>\n        </form>\n      </Modal>\n      <Modal active={modalActiveDelete} setActive={setModalActiveDelete}>\n        <h1>Изменение информации:</h1>\n        <hr/>\n        <form className=\"modalLoginBox\" onSubmit={handleDelete}>\n          <h2>Пользователь будет удален</h2>\n          <button className=\"ModalButton\" type=\"submit\" disabled={isFetching}>\n            Удалить\n          </button>\n        </form>\n      </Modal>\n      <>\n        <button className='statusBtn' type='submit' onClick={() => setModalActive(true)}  className={'statusBtn ' + (findStatus(user.status))}>\n          {isFetching\n              ? <CircularProgress style={{color:'white', size:'20px', width:'20px', height:'20px'}}/>\n              : user.status !== 1\n                  ? 'Начать'\n                  : 'Закончить'\n          }\n        </button>\n        <Modal active={modalActive} setActive={setModalActive}>\n          <h1>Изменение информации:</h1>\n          <hr/>\n          {error && <div className='modalError'>{error}</div>}\n          <form className=\"modalLoginBox\" onSubmit={user.status === 1 ? handlerEnd : handlerStart}>\n            <div style={{display:'flex', justifyContent:'space-between', fontSize: '20px', width:'30%', marginLeft:'35%', marginTop: '30px'}}>\n              <label htmlFor='sickLeave'>\n                <input\n                    type='radio'\n                    value={1}\n                    id='sickLeave'\n                    name='sickLeave'\n                    onChange={handleName}\n                    checked={+modalName === 1}\n                />Здоров</label>\n              <label htmlFor='vacation'>\n                <input\n                    type='radio'\n                    value={0}\n                    id='vacation'\n                    name='vacation'\n                    onChange={handleName}\n                    checked={+modalName === 0}\n                />Болен</label>\n            </div>\n            <input\n                placeholder=\"Комментарий\"\n                className=\"ModalInput\"\n                ref={modalComment}\n            />\n            <button className=\"ModalButton\" type=\"submit\" disabled={isFetching}>\n              ок\n            </button>\n          </form>\n        </Modal>\n      </>\n    </div>\n\n  )\n}\n"]},"metadata":{},"sourceType":"module"}