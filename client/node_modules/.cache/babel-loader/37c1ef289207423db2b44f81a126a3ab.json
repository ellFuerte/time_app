{"ast":null,"code":"import _regeneratorRuntime from\"D:/time_app/client/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"D:/time_app/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"D:/time_app/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useHistory}from'react-router-dom';import{useEffect,useState}from'react';import axios from'axios';import'./Employee.css';import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export default function Employee(_ref){var user=_ref.user;var history=useHistory();var _useState=useState([]),_useState2=_slicedToArray(_useState,2),nominations=_useState2[0],setNominations=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),admin=_useState4[0],setAdmin=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),date=_useState6[0],setDate=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),time=_useState8[0],setTime=_useState8[1];var _useState9=useState(),_useState10=_slicedToArray(_useState9,2),dateStart=_useState10[0],setDateStart=_useState10[1];var _useState11=useState(),_useState12=_slicedToArray(_useState11,2),dateEnd=_useState12[0],setDateEnd=_useState12[1];var localUser=JSON.parse(localStorage.getItem('user'));var usersStatuses={0:'',1:'start',2:'end',3:'sick_leave',4:'deleted',5:'vacation',6:'time_off',7:'other'};function findStatus(e){for(var i in usersStatuses){if(i==e){return usersStatuses[i];}}}// Проверка, если пользователь в отпуске или на больничном, то вывод даты начала и конца\nuseEffect(function(){var fetchUser=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var users,res,post;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get('/api/user/'+user.id);case 2:users=_context.sent;_context.next=5;return axios.get('/api/vacation?id='+user.id);case 5:res=_context.sent;_context.next=8;return axios.get('/api/post?type=1&id='+user.id);case 8:post=_context.sent;setNominations(users.data.nomination_status);if(users.data.isadmin!==true){setAdmin('');}else{setAdmin('*');}if(res.data.length===0){setDateStart('');setDateEnd('');}else{setDateStart(res.data[0].workdate);setDateEnd(res.data[0].worked);}if(post.data.length===0){setDate('');setTime('');}else{setDate(post.data[0].workdate);setTime(post.data[0].workend);}case 13:case\"end\":return _context.stop();}}},_callee);}));return function fetchUser(){return _ref2.apply(this,arguments);};}();if(user.status===1||user.status===2||user.status===3||user.status===5||user.status===6||user.status===7){fetchUser();}},[user.id,localUser.isAdmin]);var handleClick=function handleClick(){history.push(\"/profile/\".concat(user.id));};var images={'1':{src:'../images/1.png',title:'Тучка'},'2':{src:'../images/2.png',title:'Аркадий Паровозов'},'3':{src:'../images/3.png',title:'И так сойдет'},'4':{src:'../images/4.png',title:'Портной'},'5':{src:'../images/5.png',title:'Мама обезьянка'},'6':{src:'../images/6.png',title:'Кот Матроскин'},'7':{src:'../images/7.png',title:'Крот'},'8':{src:'../images/8.png',title:'Птица говорун(голосуем только среди дежурных)'},'9':{src:'../images/9.png',title:'Хома(Голосуем среди коллег из внедрения)'},'10':{src:'../images/10.png',title:'Симка и нолик'}};return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"div\",{onClick:handleClick,style:{cursor:'pointer'},children:/*#__PURE__*/_jsx(\"div\",{className:\"searchBlockContainer\",children:/*#__PURE__*/_jsx(\"div\",{className:'employee '+findStatus(user.status),children:/*#__PURE__*/_jsxs(\"div\",{className:\"angry-grid\",children:[/*#__PURE__*/_jsx(\"div\",{id:\"item-0\",children:/*#__PURE__*/_jsxs(\"span\",{className:\"searchName\",children:[user.user_name,localUser.isAdmin?admin:'']})}),/*#__PURE__*/_jsxs(\"div\",{id:\"item-1\",children:[user.status===5&&/*#__PURE__*/_jsxs(\"div\",{className:\"vacationText\",children:[\"\\u041E\\u0442\\u043F\\u0443\\u0441\\u043A:\",dateStart,\"-\",dateEnd]}),user.status===6&&/*#__PURE__*/_jsxs(\"div\",{className:\"vacationText\",children:[\"\\u041E\\u0442\\u0433\\u0443\\u043B:\",dateStart,\"-\",dateEnd]}),user.status===7&&/*#__PURE__*/_jsxs(\"div\",{className:\"vacationText\",children:[\"\\u0414\\u0440\\u0443\\u0433\\u0430\\u044F \\u043F\\u0440\\u0438\\u0447\\u0438\\u043D\\u0430:\",dateStart,\"-\",dateEnd]}),user.status===3&&/*#__PURE__*/_jsxs(\"div\",{className:\"vacationText\",children:[\"\\u0411\\u043E\\u043B\\u044C\\u043D\\u0438\\u0447\\u043D\\u044B\\u0439:\",dateStart,\"-\",dateEnd]}),user.status===2&&/*#__PURE__*/_jsxs(\"div\",{className:\"vacationText\",children:[date,\" \",time]})]}),/*#__PURE__*/_jsx(\"div\",{id:\"item-2\",children:Object.keys(images).map(function(key,id){return(user.nomination_status===key||user.nomination_status===parseInt(key)||nominations===key||nominations===parseInt(key))&&/*#__PURE__*/_jsx(\"img\",{src:images[key].src,title:images[key].title,alt:\"Image for \".concat(key)},id);})})]})})})})});}","map":{"version":3,"sources":["D:/time_app/client/src/components/Employee/Employee.jsx"],"names":["useHistory","useEffect","useState","axios","Employee","user","history","nominations","setNominations","admin","setAdmin","date","setDate","time","setTime","dateStart","setDateStart","dateEnd","setDateEnd","localUser","JSON","parse","localStorage","getItem","usersStatuses","findStatus","e","i","fetchUser","get","id","users","res","post","data","nomination_status","isadmin","length","workdate","worked","workend","status","isAdmin","handleClick","push","images","src","title","cursor","user_name","Object","keys","map","key","parseInt"],"mappings":"4SAAA,OAAQA,UAAR,KAAyB,kBAAzB,CACA,OAAQC,SAAR,CAAmBC,QAAnB,KAAkC,OAAlC,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAO,gBAAP,C,6IAEA,cAAe,SAASC,CAAAA,QAAT,MAA0B,IAAPC,CAAAA,IAAO,MAAPA,IAAO,CACvC,GAAMC,CAAAA,OAAO,CAAEN,UAAU,EAAzB,CACA,cAAsCE,QAAQ,CAAC,EAAD,CAA9C,wCAAOK,WAAP,eAAoBC,cAApB,eACA,eAA0BN,QAAQ,EAAlC,yCAAOO,KAAP,eAAcC,QAAd,eACA,eAAwBR,QAAQ,CAAC,EAAD,CAAhC,yCAAOS,IAAP,eAAaC,OAAb,eACA,eAAwBV,QAAQ,CAAC,EAAD,CAAhC,yCAAOW,IAAP,eAAaC,OAAb,eACA,eAAkCZ,QAAQ,EAA1C,0CAAOa,SAAP,gBAAkBC,YAAlB,gBACA,gBAA8Bd,QAAQ,EAAtC,2CAAOe,OAAP,gBAAgBC,UAAhB,gBAEA,GAAMC,CAAAA,SAAS,CAAGC,IAAI,CAACC,KAAL,CAAWC,YAAY,CAACC,OAAb,CAAqB,MAArB,CAAX,CAAlB,CAEA,GAAMC,CAAAA,aAAa,CAAG,CACpB,EAAG,EADiB,CAEpB,EAAG,OAFiB,CAGpB,EAAG,KAHiB,CAIpB,EAAG,YAJiB,CAKpB,EAAG,SALiB,CAMpB,EAAG,UANiB,CAOpB,EAAG,UAPiB,CAQpB,EAAG,OARiB,CAAtB,CAWA,QAASC,CAAAA,UAAT,CAAoBC,CAApB,CAAuB,CACrB,IAAK,GAAIC,CAAAA,CAAT,GAAcH,CAAAA,aAAd,CAA6B,CAC3B,GAAIG,CAAC,EAAID,CAAT,CAAY,CACV,MAAOF,CAAAA,aAAa,CAACG,CAAD,CAApB,CACD,CACF,CACF,CAED;AACA1B,SAAS,CAAC,UAAM,CAEd,GAAM2B,CAAAA,SAAS,2FAAG,4KACIzB,CAAAA,KAAK,CAAC0B,GAAN,CAAU,aAAexB,IAAI,CAACyB,EAA9B,CADJ,QACVC,KADU,qCAEE5B,CAAAA,KAAK,CAAC0B,GAAN,CAAU,oBAAsBxB,IAAI,CAACyB,EAArC,CAFF,QAEVE,GAFU,qCAGG7B,CAAAA,KAAK,CAAC0B,GAAN,CAAU,uBAAyBxB,IAAI,CAACyB,EAAxC,CAHH,QAGVG,IAHU,eAIhBzB,cAAc,CAACuB,KAAK,CAACG,IAAN,CAAWC,iBAAZ,CAAd,CAEA,GAAIJ,KAAK,CAACG,IAAN,CAAWE,OAAX,GAAuB,IAA3B,CAAiC,CAC/B1B,QAAQ,CAAC,EAAD,CAAR,CACD,CAFD,IAEO,CACLA,QAAQ,CAAC,GAAD,CAAR,CACD,CAGD,GAAIsB,GAAG,CAACE,IAAJ,CAASG,MAAT,GAAoB,CAAxB,CAA2B,CACzBrB,YAAY,CAAC,EAAD,CAAZ,CACAE,UAAU,CAAC,EAAD,CAAV,CACD,CAHD,IAGO,CACLF,YAAY,CAACgB,GAAG,CAACE,IAAJ,CAAS,CAAT,EAAYI,QAAb,CAAZ,CACApB,UAAU,CAACc,GAAG,CAACE,IAAJ,CAAS,CAAT,EAAYK,MAAb,CAAV,CACD,CAID,GAAIN,IAAI,CAACC,IAAL,CAAUG,MAAV,GAAqB,CAAzB,CAA4B,CAC1BzB,OAAO,CAAC,EAAD,CAAP,CACAE,OAAO,CAAC,EAAD,CAAP,CACD,CAHD,IAGO,CACLF,OAAO,CAACqB,IAAI,CAACC,IAAL,CAAU,CAAV,EAAaI,QAAd,CAAP,CACAxB,OAAO,CAACmB,IAAI,CAACC,IAAL,CAAU,CAAV,EAAaM,OAAd,CAAP,CACD,CA7Be,uDAAH,kBAATZ,CAAAA,SAAS,2CAAf,CAgCE,GAAIvB,IAAI,CAACoC,MAAL,GAAgB,CAAhB,EAAqBpC,IAAI,CAACoC,MAAL,GAAgB,CAArC,EAA0CpC,IAAI,CAACoC,MAAL,GAAgB,CAA1D,EACGpC,IAAI,CAACoC,MAAL,GAAgB,CADnB,EACwBpC,IAAI,CAACoC,MAAL,GAAgB,CADxC,EAC6CpC,IAAI,CAACoC,MAAL,GAAgB,CADjE,CAEA,CACEb,SAAS,GACZ,CAEF,CAxCQ,CAwCN,CAACvB,IAAI,CAACyB,EAAN,CAASX,SAAS,CAACuB,OAAnB,CAxCM,CAAT,CA0CA,GAAMC,CAAAA,WAAW,CAAG,QAAdA,CAAAA,WAAc,EAAM,CACxBrC,OAAO,CAACsC,IAAR,oBAAyBvC,IAAI,CAACyB,EAA9B,GACD,CAFD,CAKA,GAAMe,CAAAA,MAAM,CAAG,CACb,IAAK,CAAEC,GAAG,CAAE,iBAAP,CAA0BC,KAAK,CAAE,OAAjC,CADQ,CAEb,IAAK,CAAED,GAAG,CAAE,iBAAP,CAA0BC,KAAK,CAAE,mBAAjC,CAFQ,CAGb,IAAK,CAAED,GAAG,CAAE,iBAAP,CAA0BC,KAAK,CAAE,cAAjC,CAHQ,CAIb,IAAK,CAAED,GAAG,CAAE,iBAAP,CAA0BC,KAAK,CAAE,SAAjC,CAJQ,CAKb,IAAK,CAAED,GAAG,CAAE,iBAAP,CAA0BC,KAAK,CAAE,gBAAjC,CALQ,CAMb,IAAK,CAAED,GAAG,CAAE,iBAAP,CAA0BC,KAAK,CAAE,eAAjC,CANQ,CAOb,IAAK,CAAED,GAAG,CAAE,iBAAP,CAA0BC,KAAK,CAAE,MAAjC,CAPQ,CAQb,IAAK,CAAED,GAAG,CAAE,iBAAP,CAA0BC,KAAK,CAAE,+CAAjC,CARQ,CASb,IAAK,CAAED,GAAG,CAAE,iBAAP,CAA0BC,KAAK,CAAE,0CAAjC,CATQ,CAUb,KAAM,CAAED,GAAG,CAAE,kBAAP,CAA2BC,KAAK,CAAE,eAAlC,CAVO,CAAf,CAcA,mBACI,sCACE,YAAK,OAAO,CAAEJ,WAAd,CAA2B,KAAK,CAAE,CAACK,MAAM,CAAC,SAAR,CAAlC,uBACA,YAAK,SAAS,CAAC,sBAAf,uBACI,YAAK,SAAS,CAAE,YAAevB,UAAU,CAACpB,IAAI,CAACoC,MAAN,CAAzC,uBACE,aAAK,SAAS,CAAC,YAAf,wBACE,YAAK,EAAE,CAAC,QAAR,uBACE,cAAM,SAAS,CAAC,YAAhB,WAA8BpC,IAAI,CAAC4C,SAAnC,CAA8C9B,SAAS,CAACuB,OAAV,CAAoBjC,KAApB,CAA4B,EAA1E,GADF,EADF,cAIE,aAAK,EAAE,CAAC,QAAR,WACGJ,IAAI,CAACoC,MAAL,GAAgB,CAAhB,eAAqB,aAAK,SAAS,CAAC,cAAf,mDAAsC1B,SAAtC,KAAkDE,OAAlD,GADxB,CAEGZ,IAAI,CAACoC,MAAL,GAAgB,CAAhB,eAAqB,aAAK,SAAS,CAAC,cAAf,6CAAqC1B,SAArC,KAAiDE,OAAjD,GAFxB,CAGGZ,IAAI,CAACoC,MAAL,GAAgB,CAAhB,eAAqB,aAAK,SAAS,CAAC,cAAf,8FAA8C1B,SAA9C,KAA0DE,OAA1D,GAHxB,CAIGZ,IAAI,CAACoC,MAAL,GAAgB,CAAhB,eAAqB,aAAK,SAAS,CAAC,cAAf,2EAA0C1B,SAA1C,KAAsDE,OAAtD,GAJxB,CAKGZ,IAAI,CAACoC,MAAL,GAAgB,CAAhB,eAAqB,aAAK,SAAS,CAAC,cAAf,WAA+B9B,IAA/B,KAAsCE,IAAtC,GALxB,GAJF,cAWE,YAAK,EAAE,CAAC,QAAR,UACGqC,MAAM,CAACC,IAAP,CAAYN,MAAZ,EAAoBO,GAApB,CAAwB,SAACC,GAAD,CAAMvB,EAAN,QACrB,CAACzB,IAAI,CAAC8B,iBAAL,GAA2BkB,GAA3B,EAAkChD,IAAI,CAAC8B,iBAAL,GAA2BmB,QAAQ,CAACD,GAAD,CAArE,EAA8E9C,WAAW,GAAK8C,GAA9F,EAAqG9C,WAAW,GAAK+C,QAAQ,CAACD,GAAD,CAA9H,gBACA,YAEI,GAAG,CAAER,MAAM,CAACQ,GAAD,CAAN,CAAYP,GAFrB,CAGI,KAAK,CAAED,MAAM,CAACQ,GAAD,CAAN,CAAYN,KAHvB,CAII,GAAG,qBAAeM,GAAf,CAJP,EACSvB,EADT,CAFqB,EAAxB,CADH,EAXF,GADF,EADJ,EADA,EADF,EADJ,CAiCD","sourcesContent":["import {useHistory} from 'react-router-dom'\r\nimport {useEffect, useState} from 'react'\r\nimport axios from 'axios'\r\nimport './Employee.css'\r\n\r\nexport default function Employee({user}) {\r\n  const history =useHistory()\r\n  const [nominations, setNominations] = useState([])\r\n  const [admin, setAdmin] = useState()\r\n  const [date, setDate] = useState('')\r\n  const [time, setTime] = useState('')\r\n  const [dateStart, setDateStart] = useState()\r\n  const [dateEnd, setDateEnd] = useState()\r\n\r\n  const localUser = JSON.parse(localStorage.getItem('user'))\r\n\r\n  const usersStatuses = {\r\n    0: '',\r\n    1: 'start',\r\n    2: 'end',\r\n    3: 'sick_leave',\r\n    4: 'deleted',\r\n    5: 'vacation',\r\n    6: 'time_off',\r\n    7: 'other'\r\n  }\r\n\r\n  function findStatus(e) {\r\n    for (let i in usersStatuses) {\r\n      if (i == e) {\r\n        return usersStatuses[i]\r\n      }\r\n    }\r\n  }\r\n\r\n  // Проверка, если пользователь в отпуске или на больничном, то вывод даты начала и конца\r\n  useEffect(() => {\r\n\r\n    const fetchUser = async () => {\r\n      const users = await axios.get('/api/user/' + user.id)\r\n      const res = await axios.get('/api/vacation?id=' + user.id);\r\n      const post = await axios.get('/api/post?type=1&id=' + user.id);\r\n      setNominations(users.data.nomination_status)\r\n\r\n      if (users.data.isadmin !== true) {\r\n        setAdmin('');\r\n      } else {\r\n        setAdmin('*');\r\n      }\r\n\r\n\r\n      if (res.data.length === 0) {\r\n        setDateStart('')\r\n        setDateEnd('')\r\n      } else {\r\n        setDateStart(res.data[0].workdate)\r\n        setDateEnd(res.data[0].worked)\r\n      }\r\n\r\n\r\n\r\n      if (post.data.length === 0) {\r\n        setDate('')\r\n        setTime('')\r\n      } else {\r\n        setDate(post.data[0].workdate)\r\n        setTime(post.data[0].workend)\r\n      }\r\n    }\r\n\r\n      if (user.status === 1 || user.status === 2 || user.status === 3\r\n          || user.status === 5 || user.status === 6 || user.status === 7)\r\n      {\r\n        fetchUser()\r\n    }\r\n\r\n  }, [user.id,localUser.isAdmin])\r\n\r\n  const handleClick = () => {\r\n    history.push(`/profile/${user.id}`);\r\n  };\r\n\r\n\r\n  const images = {\r\n    '1': { src: '../images/1.png', title: 'Тучка' },\r\n    '2': { src: '../images/2.png', title: 'Аркадий Паровозов' },\r\n    '3': { src: '../images/3.png', title: 'И так сойдет' },\r\n    '4': { src: '../images/4.png', title: 'Портной' },\r\n    '5': { src: '../images/5.png', title: 'Мама обезьянка' },\r\n    '6': { src: '../images/6.png', title: 'Кот Матроскин' },\r\n    '7': { src: '../images/7.png', title: 'Крот' },\r\n    '8': { src: '../images/8.png', title: 'Птица говорун(голосуем только среди дежурных)' },\r\n    '9': { src: '../images/9.png', title: 'Хома(Голосуем среди коллег из внедрения)' },\r\n    '10': { src: '../images/10.png', title: 'Симка и нолик' }\r\n  };\r\n\r\n\r\n  return (\r\n      <>\r\n        <div onClick={handleClick} style={{cursor:'pointer'}}>\r\n        <div className=\"searchBlockContainer\">\r\n            <div className={'employee ' + (findStatus(user.status))}>\r\n              <div className=\"angry-grid\">\r\n                <div id=\"item-0\">\r\n                  <span className='searchName'>{user.user_name}{localUser.isAdmin ? admin : ''}</span>\r\n                </div>\r\n                <div id=\"item-1\">\r\n                  {user.status === 5 && <div className='vacationText'>Отпуск:{dateStart}-{dateEnd}</div>}\r\n                  {user.status === 6 && <div className='vacationText'>Отгул:{dateStart}-{dateEnd}</div>}\r\n                  {user.status === 7 && <div className='vacationText'>Другая причина:{dateStart}-{dateEnd}</div>}\r\n                  {user.status === 3 && <div className='vacationText'>Больничный:{dateStart}-{dateEnd}</div>}\r\n                  {user.status === 2 && <div className='vacationText'>{date} {time}</div>}\r\n                </div>\r\n                <div id=\"item-2\">\r\n                  {Object.keys(images).map((key, id) => (\r\n                      (user.nomination_status === key || user.nomination_status === parseInt(key) || nominations === key || nominations === parseInt(key)) &&\r\n                      <img\r\n                          key={id}\r\n                          src={images[key].src}\r\n                          title={images[key].title}\r\n                          alt={`Image for ${key}`}\r\n                      />\r\n                  ))}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </>\r\n  )\r\n}\r\n\r\n"]},"metadata":{},"sourceType":"module"}