{"ast":null,"code":"import _regeneratorRuntime from\"D:/time_app/client/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"D:/time_app/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"D:/time_app/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import axios from'axios';import{useRef}from'react';import{useEffect,useState}from'react';import InfoPost from'../../InfoPost/InfoPost';import Pagination from'../../Pagination/Pagination';import VacationPost from'../../VacationPost/VacationPost';import'./HistoryInfo.css';import Modal from'../../Templates/Modal/Modal';import{useParams}from\"react-router-dom\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function HistoryInfo(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),posts=_useState2[0],setPosts=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),vacationPosts=_useState4[0],setVacationPosts=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isFetching=_useState6[0],setIsFetching=_useState6[1];var _useState7=useState(1),_useState8=_slicedToArray(_useState7,2),currentPage=_useState8[0],setCurrentPage=_useState8[1];var _useState9=useState(30),_useState10=_slicedToArray(_useState9,1),postsPerPage=_useState10[0];var lastPostIndex=currentPage*postsPerPage;var firstPostIndex=lastPostIndex-postsPerPage;var currentlyPosts=posts.slice(firstPostIndex,lastPostIndex);var lastPostIndexVacations=currentPage*postsPerPage;var firstPostIndexVacations=lastPostIndexVacations-postsPerPage;var currentlyVacations=vacationPosts.slice(firstPostIndexVacations,lastPostIndexVacations);var historyStartWork=useRef(null);var historyEndWork=useRef(null);var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),isFilter=_useState12[0],setIsFilter=_useState12[1];var _useState13=useState([]),_useState14=_slicedToArray(_useState13,2),newPosts=_useState14[0],setNewPosts=_useState14[1];var _useState15=useState(''),_useState16=_slicedToArray(_useState15,2),error=_useState16[0],setError=_useState16[1];var _useState17=useState(''),_useState18=_slicedToArray(_useState17,2),modalError=_useState18[0],setModalError=_useState18[1];var username=useParams();var localUser=!!username?{_id:username.username,email:\"\"}:JSON.parse(localStorage.getItem('user'));var _useState19=useState(true),_useState20=_slicedToArray(_useState19,2),isJob=_useState20[0],setIsJob=_useState20[1];var _useState21=useState(false),_useState22=_slicedToArray(_useState21,2),modalActive=_useState22[0],setModalActive=_useState22[1];var _useState23=useState(null),_useState24=_slicedToArray(_useState23,2),modalName=_useState24[0],setModalName=_useState24[1];var modalComment=useRef();var vacationStart=useRef();var vacationEnd=useRef();// получение всех постов работы от послелнего к первому\nuseEffect(function(){setIsFetching(true);fetchUserpost();},[username]);var fetchUserpost=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get('/api/post?type=1&id='+localUser._id);case 2:res=_context.sent;setPosts(res.data.sort(function(p1,p2){return new Date(p2.workstart)-new Date(p1.workstart);}));setIsFetching(false);case 5:case\"end\":return _context.stop();}}},_callee);}));return function fetchUserpost(){return _ref.apply(this,arguments);};}();var paginate=function paginate(pageNumber){return setCurrentPage(pageNumber);};// фильтер постов по дате\nvar handleClick=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var start,end,filter,fill;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:start=historyStartWork.current.value;end=historyEndWork.current.value;if(start===\"\"||end===\"\"){setError('Введите дату');}else{if(start!==''||end!==''){setError('Выберите дату');}if(end<start){setError('Конечная дата меньше начальной');}else{filter={startdate:historyStartWork.current.value,enddate:historyEndWork.current.value,userId:localUser._id,typework:isJob};setError('');fill=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var res;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return axios.post('/api/post/filter',filter);case 2:res=_context2.sent;console.log('res=',res.data);setVacationPosts(res.data.sort(function(p1,p2){return new Date(p2.workstart)-new Date(p1.workstart);}));setPosts(res.data.sort(function(p1,p2){return new Date(p2.workstart)-new Date(p1.workstart);}));setError('');case 7:case\"end\":return _context2.stop();}}},_callee2);}));return function fill(){return _ref3.apply(this,arguments);};}();fill();}}/*      let filterPosts = isJob\r\n              ?  posts.filter(post => post.workdate.split('T')[0] >= start)\r\n              : vacationPosts.filter(post => post.start.split('T')[0] >= start)\r\n            if(end){\r\n              filterPosts = isJob\r\n                ? filterPosts.filter(post => post.workdate.split('T')[0] <= end)\r\n                : filterPosts.filter(post => post.end.split('T')[0] <= end)\r\n            }\r\n            setNewPosts(filterPosts)*/case 3:case\"end\":return _context3.stop();}}},_callee3);}));return function handleClick(){return _ref2.apply(this,arguments);};}();// сброс фильтра\nvar handleClickCancel=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:setError('');setIsFilter(false);historyStartWork.current.value='';historyEndWork.current.value='';case 4:case\"end\":return _context4.stop();}}},_callee4);}));return function handleClickCancel(){return _ref4.apply(this,arguments);};}();// получение всех постов об отпуске/больничном от послелнего к первому\nuseEffect(function(){setIsFetching(true);fetchUservacation();},[username]);var fetchUservacation=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(){var res;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.next=2;return axios.get('/api/vacation?id='+localUser._id);case 2:res=_context5.sent;console.log('res=',res.data);setVacationPosts(res.data.sort(function(p1,p2){return new Date(p2.start)-new Date(p1.start);}));setIsFetching(false);case 6:case\"end\":return _context5.stop();}}},_callee5);}));return function fetchUservacation(){return _ref5.apply(this,arguments);};}();// добавление больничного\nvar handleClickAdd=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(e){var currentDay,vacation;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:e.preventDefault();currentDay=new Date();if(!(vacationStart.current.value===''||vacationEnd.current.value===''||modalName===null||modalComment.current.value==='')){_context6.next=5;break;}setModalError('Вcе поля должны быть заполнены');return _context6.abrupt(\"return\");case 5:if(!(new Date(vacationStart.current.value)>new Date(vacationEnd.current.value)&&vacationEnd.current.value!=='')){_context6.next=8;break;}setModalError('Вторая дата меньше первой');return _context6.abrupt(\"return\");case 8:vacation={userId:localUser._id,status:modalName,comment:modalComment.current.value,start:new Date(vacationStart.current.value),end:new Date(vacationEnd.current.value)};_context6.prev=9;_context6.next=12;return axios.post('/api/vacation/',vacation);case 12:window.location.reload();_context6.next=18;break;case 15:_context6.prev=15;_context6.t0=_context6[\"catch\"](9);console.log(_context6.t0);case 18:case\"end\":return _context6.stop();}}},_callee6,null,[[9,15]]);}));return function handleClickAdd(_x){return _ref6.apply(this,arguments);};}();// переход на страницу с больничным и обратно\nvar handleWorkVacation=function handleWorkVacation(){if(isJob){fetchUservacation();}else{fetchUserpost();}setIsJob(!isJob);setError('');setIsFilter(false);historyStartWork.current.value='';historyEndWork.current.value='';};var handleName=function handleName(e){setModalName(e.target.value);};return/*#__PURE__*/_jsxs(\"div\",{className:\"historyInfo\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"historyInfoTop\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"historyInfoTitle\",children:\"\\u0418\\u0441\\u0442\\u043E\\u0440\\u0438\\u044F\"}),/*#__PURE__*/_jsx(\"span\",{className:\"workVacation\",onClick:handleWorkVacation,children:isJob?/*#__PURE__*/_jsx(\"button\",{className:\"filterButton\",style:{width:'155px'},children:\"\\u041E\\u0442\\u043F\\u0443\\u0441\\u043A/\\u0411\\u043E\\u043B\\u044C\\u043D\\u0438\\u0447\\u043D\\u044B\\u0439\"}):/*#__PURE__*/_jsx(\"button\",{className:\"filterButton\",children:\"\\u0420\\u0430\\u0431\\u043E\\u0442\\u0430\"})}),!isJob&&(localUser||username===localUser._id)&&/*#__PURE__*/_jsx(\"div\",{className:\"addVacation\",onClick:function onClick(){return setModalActive(true);},children:/*#__PURE__*/_jsx(\"span\",{children:\"+\"})})]}),/*#__PURE__*/_jsx(\"hr\",{}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"errorHistoryInfo\",children:error}),/*#__PURE__*/_jsxs(\"div\",{className:\"historyFilter\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"date\",placeholder:\"\\u041D\\u0430\\u0447\\u0430\\u043B\\u043E \\u0440\\u0430\\u0431\\u043E\\u0442\\u044B\",className:\"ModalInput\",ref:historyStartWork,style:{'marginRight':'10px'}}),\"\\u2014  \",/*#__PURE__*/_jsx(\"input\",{type:\"date\",placeholder:\"\\u041A\\u043E\\u043D\\u0435\\u0446 \\u0440\\u0430\\u0431\\u043E\\u0442\\u044B\",className:\"ModalInput\",ref:historyEndWork,style:{'marginRight':'10px'}}),/*#__PURE__*/_jsx(\"button\",{className:\"filterButton\",onClick:handleClick,children:\"\\u041E\\u043A\"}),/*#__PURE__*/_jsx(\"button\",{className:\"filterButton\",onClick:handleClickCancel,children:\"\\u0421\\u0431\\u0440\\u043E\\u0441\\u0438\\u0442\\u044C\"})]}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsx(\"br\",{}),isJob?/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{className:\"historyinfodate\",children:\"\\u0414\\u0430\\u0442\\u0430\"}),/*#__PURE__*/_jsx(\"td\",{className:\"historyinfopost\",children:\"\\u0412\\u0440\\u0435\\u043C\\u044F \\u043D\\u0430\\u0447\\u0430\\u043B\\u0430\"}),/*#__PURE__*/_jsx(\"td\",{className:\"historyinfopost\",children:\"\\u0412\\u0440\\u0435\\u043C\\u044F \\u043E\\u043A\\u043E\\u043D\\u0447\\u0430\\u043D\\u0438\\u044F\"}),/*#__PURE__*/_jsx(\"td\",{className:\"historyinfopost\",children:\"\\u0414\\u043B\\u0438\\u0442\\u0435\\u043B\\u044C\\u043D\\u043E\\u0441\\u0442\\u044C\"}),/*#__PURE__*/_jsx(\"td\",{className:\"historyinfopost\",children:\"\\u0421\\u043E\\u0441\\u0442\\u043E\\u044F\\u043D\\u0438\\u0435 \\u0437\\u0434\\u043E\\u0440\\u043E\\u0432\\u044C\\u044F\"}),/*#__PURE__*/_jsx(\"td\",{className:\"historyinfocomment\",children:\"\\u041A\\u043E\\u043C\\u043C\\u0435\\u043D\\u0442\\u0430\\u0440\\u0438\\u0439\"})]}):/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{className:\"historyinfopostdate\",children:\"\\u041D\\u0430\\u0447\\u0430\\u043B\\u043E\"}),/*#__PURE__*/_jsx(\"td\",{className:\"historyinfopost\",children:\"\\u041A\\u043E\\u043D\\u0435\\u0446\"}),/*#__PURE__*/_jsx(\"td\",{className:\"historyinfopost\",children:\"\\u0414\\u043B\\u0438\\u0442\\u0435\\u043B\\u044C\\u043D\\u043E\\u0441\\u0442\\u044C\"}),/*#__PURE__*/_jsx(\"td\",{className:\"historyinfopost\",children:\"\\u041F\\u0440\\u0438\\u0447\\u0438\\u043D\\u0430\"}),/*#__PURE__*/_jsx(\"td\",{className:\"historycomment\",children:\"\\u041A\\u043E\\u043C\\u043C\\u0435\\u043D\\u0442\\u0430\\u0440\\u0438\\u0439\"})]}),isJob?isFetching?/*#__PURE__*/_jsx(\"div\",{className:\"isFatching\",children:\"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430...\"}):isFilter?newPosts.map(function(post,id){return/*#__PURE__*/_jsx(InfoPost,{post:post,username:username},id);}):currentlyPosts.map(function(post,id){return/*#__PURE__*/_jsx(InfoPost,{post:post,username:username},id);}):isFetching?/*#__PURE__*/_jsx(\"div\",{className:\"isFatching\",children:\"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430...\"}):isFilter?newPosts.map(function(post,id){return/*#__PURE__*/_jsx(VacationPost,{post:post,username:username},id);}):currentlyVacations.map(function(post,id){return/*#__PURE__*/_jsx(VacationPost,{post:post},id);}),isJob?/*#__PURE__*/_jsx(Pagination,{postsPerPage:postsPerPage,totalPosts:posts.length,paginate:paginate,currentPage:currentPage}):/*#__PURE__*/_jsx(Pagination,{postsPerPage:postsPerPage,totalPosts:vacationPosts.length,paginate:paginate,currentPage:currentPage}),/*#__PURE__*/_jsxs(Modal,{active:modalActive,setActive:setModalActive,children:[/*#__PURE__*/_jsx(\"h1\",{children:\"\\u0418\\u0437\\u043C\\u0435\\u043D\\u0435\\u043D\\u0438\\u0435 \\u0438\\u043D\\u0444\\u043E\\u0440\\u043C\\u0430\\u0446\\u0438\\u0438:\"}),/*#__PURE__*/_jsx(\"hr\",{}),modalError&&/*#__PURE__*/_jsx(\"div\",{className:\"errorHistoryInfo\",children:modalError}),/*#__PURE__*/_jsxs(\"form\",{className:\"modalLoginBox\",onSubmit:handleClickAdd,children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between',fontSize:'20px',width:'60%',marginLeft:'20%'},children:[/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"sickLeave\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"radio\",value:3,id:\"sickLeave\",name:\"sickLeave\",onChange:handleName,checked:modalName==='3'}),\"\\u0411\\u043E\\u043B\\u044C\\u043D\\u0438\\u0447\\u043D\\u044B\\u0439\"]}),/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"vacation\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"radio\",value:5,id:\"vacation\",name:\"vacation\",onChange:handleName,checked:modalName==='5'}),\"\\u041E\\u0442\\u043F\\u0443\\u0441\\u043A\"]}),/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"time\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"radio\",value:6,id:\"other\",name:\"time\",onChange:handleName,checked:modalName==='6'}),\"\\u041E\\u0442\\u0433\\u0443\\u043B\"]}),/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"anotherReason\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"radio\",value:7,id:\"anotherReason\",name:\"anotherReason\",onChange:handleName,checked:modalName==='7'}),\"\\u0414\\u0440\\u0443\\u0433\\u0430\\u044F \\u043F\\u0440\\u0438\\u0447\\u0438\\u043D\\u0430\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"inputVacanciesDiv\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"date\",placeholder:\"\\u041D\\u0430\\u0447\\u0430\\u043B\\u043E \\u0440\\u0430\\u0431\\u043E\\u0442\\u044B\",className:\"ModalInputInfoVacancies\",ref:vacationStart,style:{'marginRight':'10px'}}),\"\\u2014   \",/*#__PURE__*/_jsx(\"input\",{type:\"date\",placeholder:\"\\u041A\\u043E\\u043D\\u0435\\u0446 \\u0440\\u0430\\u0431\\u043E\\u0442\\u044B\",className:\"ModalInputInfoVacancies\",ref:vacationEnd,style:{'marginRight':'10px'}})]}),/*#__PURE__*/_jsx(\"input\",{placeholder:\"\\u041A\\u043E\\u043C\\u043C\\u0435\\u043D\\u0442\\u0430\\u0440\\u0438\\u0439\",className:\"ModalInputInfoVacanciesComment\",ref:modalComment}),/*#__PURE__*/_jsx(\"button\",{className:\"ModalButton\",type:\"submit\",disabled:isFetching,children:\"\\u0418\\u0437\\u043C\\u0435\\u043D\\u0438\\u0442\\u044C\"})]})]})]});}","map":{"version":3,"sources":["D:/time_app/client/src/components/ProfileInfo/HistoryInfo/HistoryInfo.jsx"],"names":["axios","useRef","useEffect","useState","InfoPost","Pagination","VacationPost","Modal","useParams","HistoryInfo","posts","setPosts","vacationPosts","setVacationPosts","isFetching","setIsFetching","currentPage","setCurrentPage","postsPerPage","lastPostIndex","firstPostIndex","currentlyPosts","slice","lastPostIndexVacations","firstPostIndexVacations","currentlyVacations","historyStartWork","historyEndWork","isFilter","setIsFilter","newPosts","setNewPosts","error","setError","modalError","setModalError","username","localUser","_id","email","JSON","parse","localStorage","getItem","isJob","setIsJob","modalActive","setModalActive","modalName","setModalName","modalComment","vacationStart","vacationEnd","fetchUserpost","get","res","data","sort","p1","p2","Date","workstart","paginate","pageNumber","handleClick","start","current","value","end","filter","startdate","enddate","userId","typework","fill","post","console","log","handleClickCancel","fetchUservacation","handleClickAdd","e","preventDefault","currentDay","vacation","status","comment","window","location","reload","handleWorkVacation","handleName","target","width","map","id","length","display","justifyContent","fontSize","marginLeft"],"mappings":"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","sourcesContent":["import axios from 'axios'\r\nimport { useRef } from 'react'\r\nimport { useEffect, useState } from 'react'\r\n\r\nimport InfoPost from '../../InfoPost/InfoPost'\r\nimport Pagination from '../../Pagination/Pagination'\r\nimport VacationPost from '../../VacationPost/VacationPost'\r\nimport './HistoryInfo.css'\r\nimport Modal from '../../Templates/Modal/Modal'\r\nimport {useParams} from \"react-router-dom\";\r\n\r\n\r\n\r\nexport default function HistoryInfo() {\r\n    const [posts, setPosts] = useState([])\r\n    const [vacationPosts, setVacationPosts] = useState([])\r\n    const [isFetching, setIsFetching] = useState(false)\r\n    const [currentPage, setCurrentPage] = useState(1)\r\n    const [postsPerPage] = useState(30)\r\n\r\n    const lastPostIndex = currentPage * postsPerPage\r\n    const firstPostIndex = lastPostIndex - postsPerPage\r\n    const currentlyPosts = posts.slice(firstPostIndex, lastPostIndex)\r\n\r\n\r\n    const lastPostIndexVacations = currentPage * postsPerPage\r\n    const firstPostIndexVacations = lastPostIndexVacations - postsPerPage\r\n    const currentlyVacations = vacationPosts.slice(firstPostIndexVacations, lastPostIndexVacations)\r\n\r\n\r\n\r\n    const historyStartWork = useRef(null)\r\n    const historyEndWork = useRef(null)\r\n    const [isFilter, setIsFilter] = useState(false)\r\n    const [newPosts, setNewPosts] = useState([])\r\n    const [error, setError] = useState('')\r\n    const [modalError, setModalError] = useState('')\r\n    const username=useParams()\r\n\r\n    let localUser = !!username ? {_id:username.username,email:\"\"} : JSON.parse(localStorage.getItem('user'))\r\n\r\n\r\n\r\n    const [isJob, setIsJob] = useState(true)\r\n    const [modalActive, setModalActive] = useState(false)\r\n    const [modalName, setModalName] = useState(null)\r\n    const modalComment = useRef()\r\n    const vacationStart = useRef()\r\n    const vacationEnd = useRef()\r\n\r\n    // получение всех постов работы от послелнего к первому\r\n\r\n    useEffect(() => {\r\n        setIsFetching(true)\r\n\r\n        fetchUserpost()\r\n    }, [username])\r\n\r\n    const fetchUserpost = async () => {\r\n        const res = await axios.get('/api/post?type=1&id='+localUser._id)\r\n        setPosts(res.data.sort((p1, p2) => {\r\n            return new Date(p2.workstart) - new Date(p1.workstart)\r\n        }))\r\n        setIsFetching(false)\r\n    }\r\n\r\n\r\n    const paginate = pageNumber => setCurrentPage(pageNumber)\r\n\r\n    // фильтер постов по дате\r\n    const handleClick = async () => {\r\n        const start = historyStartWork.current.value\r\n        const end = historyEndWork.current.value\r\n        if (start === \"\" || end === \"\" ) {\r\n            setError('Введите дату')\r\n        } else{\r\n            if (start !== '' || end !== '') {\r\n                setError('Выберите дату')}\r\n            if (end< start) {\r\n                setError('Конечная дата меньше начальной')}\r\n\r\n            else{\r\n\r\n                const filter = {\r\n                    startdate: historyStartWork.current.value,\r\n                    enddate: historyEndWork.current.value,\r\n                    userId: localUser._id,\r\n                    typework:isJob\r\n                }\r\n                setError('')\r\n\r\n                const fill = async () => {\r\n                    const res = await axios.post('/api/post/filter',filter)\r\n                    console.log('res=',res.data)\r\n\r\n                    setVacationPosts(res.data.sort((p1, p2) => {\r\n                        return new Date(p2.workstart) - new Date(p1.workstart)\r\n                    }))\r\n\r\n                    setPosts(res.data.sort((p1, p2) => {\r\n                        return new Date(p2.workstart) - new Date(p1.workstart)\r\n                    }))\r\n\r\n                    setError('')\r\n                }\r\n                fill()\r\n            }}\r\n\r\n        /*      let filterPosts = isJob\r\n              ?  posts.filter(post => post.workdate.split('T')[0] >= start)\r\n              : vacationPosts.filter(post => post.start.split('T')[0] >= start)\r\n            if(end){\r\n              filterPosts = isJob\r\n                ? filterPosts.filter(post => post.workdate.split('T')[0] <= end)\r\n                : filterPosts.filter(post => post.end.split('T')[0] <= end)\r\n            }\r\n            setNewPosts(filterPosts)*/\r\n\r\n    }\r\n\r\n\r\n    // сброс фильтра\r\n    const handleClickCancel = async () =>{\r\n        setError('')\r\n        setIsFilter(false)\r\n        historyStartWork.current.value = ''\r\n        historyEndWork.current.value = ''\r\n    }\r\n\r\n\r\n    // получение всех постов об отпуске/больничном от послелнего к первому\r\n    useEffect(() => {\r\n        setIsFetching(true)\r\n\r\n        fetchUservacation()\r\n    }, [username])\r\n\r\n    const fetchUservacation = async () => {\r\n        const res = await axios.get('/api/vacation?id='+localUser._id)\r\n        console.log('res=',res.data)\r\n        setVacationPosts(res.data.sort((p1, p2) => {\r\n            return new Date(p2.start) - new Date(p1.start)\r\n        }))\r\n        setIsFetching(false)\r\n    }\r\n    // добавление больничного\r\n    const handleClickAdd = async (e) => {\r\n        e.preventDefault()\r\n\r\n        const currentDay = new Date()\r\n\r\n        if(vacationStart.current.value === '' || vacationEnd.current.value === '' || modalName === null || modalComment.current.value === ''){\r\n            setModalError('Вcе поля должны быть заполнены')\r\n            return\r\n        }\r\n\r\n        if(new Date(vacationStart.current.value) > new Date(vacationEnd.current.value) && vacationEnd.current.value !== ''){\r\n            setModalError('Вторая дата меньше первой')\r\n            return\r\n        }\r\n\r\n\r\n\r\n\r\n        const vacation = {\r\n            userId: localUser._id,\r\n            status:modalName,\r\n            comment: modalComment.current.value,\r\n            start: new Date(vacationStart.current.value),\r\n            end: new Date(vacationEnd.current.value)\r\n        }\r\n\r\n        try {\r\n            await axios.post('/api/vacation/',vacation)\r\n            window.location.reload()\r\n        } catch (error) {\r\n            console.log(error);\r\n        }\r\n    }\r\n\r\n    // переход на страницу с больничным и обратно\r\n    const handleWorkVacation = () => {\r\n        if(isJob){\r\n            fetchUservacation()}else {\r\n            fetchUserpost()\r\n        }\r\n        setIsJob(!isJob)\r\n        setError('')\r\n        setIsFilter(false)\r\n        historyStartWork.current.value = ''\r\n        historyEndWork.current.value = ''\r\n    }\r\n\r\n    const handleName = e => {\r\n        setModalName(e.target.value)\r\n    }\r\n    return (\r\n        <div className='historyInfo'>\r\n            <div className='historyInfoTop'>\r\n                <span className='historyInfoTitle'>История</span>\r\n                <span className='workVacation' onClick={handleWorkVacation}>\r\n          {isJob ? <button className=\"filterButton\" style={{width:'155px'}}>Отпуск/Больничный</button> : <button className=\"filterButton\">Работа</button> }\r\n        </span>\r\n\r\n                {!isJob && (localUser || username === localUser._id)\r\n\r\n                && <div className='addVacation' onClick={() => setModalActive(true)}><span>+</span></div>}\r\n            </div>\r\n            <hr/>\r\n            {error && <div className='errorHistoryInfo'>{error}</div>}\r\n            <div className='historyFilter'>\r\n                <input\r\n                    type='date'\r\n                    placeholder=\"Начало работы\"\r\n                    className=\"ModalInput\"\r\n                    ref={historyStartWork}\r\n                    style={{'marginRight': '10px'}}\r\n                />\r\n                —  <input\r\n                type='date'\r\n                placeholder=\"Конец работы\"\r\n                className=\"ModalInput\"\r\n                ref={historyEndWork}\r\n                style={{'marginRight': '10px'}}\r\n            />\r\n                <button className=\"filterButton\" onClick={handleClick}>Ок</button>\r\n                <button className=\"filterButton\" onClick={handleClickCancel}>Сбросить</button>\r\n            </div>\r\n            <hr/>\r\n            <br/>\r\n            {isJob\r\n                ?\r\n                <tr>\r\n                    <td className=\"historyinfodate\">Дата</td>\r\n                    <td className=\"historyinfopost\">Время начала</td>\r\n                    <td className=\"historyinfopost\">Время окончания</td>\r\n                    <td className=\"historyinfopost\">Длительность</td>\r\n                    <td className=\"historyinfopost\">Состояние здоровья</td>\r\n                    <td className=\"historyinfocomment\">Комментарий</td>\r\n                </tr>\r\n                :\r\n                <tr>\r\n                    <td className=\"historyinfopostdate\">Начало</td>\r\n                    <td className=\"historyinfopost\">Конец</td>\r\n                    <td className=\"historyinfopost\">Длительность</td>\r\n                    <td className=\"historyinfopost\">Причина</td>\r\n                    <td className=\"historycomment\">Комментарий</td>\r\n                </tr>\r\n            }\r\n\r\n            {isJob\r\n                ? isFetching\r\n                    ? <div className='isFatching'>Загрузка...</div>\r\n                    : isFilter\r\n                        ? newPosts.map((post, id) => <InfoPost key={id} post={post} username={username}/>)\r\n                        : currentlyPosts.map((post, id) => <InfoPost key={id} post={post} username={username}/>)\r\n                : isFetching\r\n                    ? <div className='isFatching'>Загрузка...</div>\r\n                    : isFilter\r\n                        ? newPosts.map((post, id) => <VacationPost key={id} post={post} username={username}/>)\r\n                        : currentlyVacations.map((post, id) => <VacationPost key={id} post={post}/>)\r\n            }\r\n\r\n            {isJob ?\r\n                <Pagination postsPerPage={postsPerPage} totalPosts={posts.length} paginate={paginate} currentPage={currentPage}/>:\r\n                <Pagination postsPerPage={postsPerPage} totalPosts={vacationPosts.length} paginate={paginate} currentPage={currentPage}/>\r\n            }\r\n\r\n            <Modal active={modalActive} setActive={setModalActive}>\r\n                <h1>Изменение информации:</h1>\r\n                <hr/>\r\n                {modalError && <div className='errorHistoryInfo'>{modalError}</div>}\r\n                <form className=\"modalLoginBox\" onSubmit={handleClickAdd}>\r\n                    <div style={{display:'flex', justifyContent:'space-between', fontSize: '20px', width:'60%', marginLeft:'20%'}}>\r\n                        <label htmlFor='sickLeave'>\r\n                            <input\r\n                                type='radio'\r\n                                value={3}\r\n                                id='sickLeave'\r\n                                name='sickLeave'\r\n                                onChange={handleName}\r\n                                checked={modalName === '3'}\r\n                            />Больничный</label>\r\n                        <label htmlFor='vacation'>\r\n                            <input\r\n                                type='radio'\r\n                                value={5}\r\n                                id='vacation'\r\n                                name='vacation'\r\n                                onChange={handleName}\r\n                                checked={modalName === '5'}\r\n                            />Отпуск</label>\r\n                        <label htmlFor='time'>\r\n                            <input\r\n                                type='radio'\r\n                                value={6}\r\n                                id='other'\r\n                                name='time'\r\n                                onChange={handleName}\r\n                                checked={modalName === '6'}\r\n                            />Отгул</label>\r\n                        <label htmlFor='anotherReason'>\r\n                            <input\r\n                                type='radio'\r\n                                value={7}\r\n                                id='anotherReason'\r\n                                name='anotherReason'\r\n                                onChange={handleName}\r\n                                checked={modalName === '7'}\r\n                            />Другая причина</label>\r\n\r\n                    </div>\r\n                    <div className='inputVacanciesDiv'>\r\n                        <input\r\n                            type='date'\r\n                            placeholder=\"Начало работы\"\r\n                            className=\"ModalInputInfoVacancies\"\r\n                            ref={vacationStart}\r\n                            style={{'marginRight': '10px'}}\r\n                        />\r\n                        —   <input\r\n                        type='date'\r\n                        placeholder=\"Конец работы\"\r\n                        className=\"ModalInputInfoVacancies\"\r\n                        ref={vacationEnd}\r\n                        style={{'marginRight': '10px'}}\r\n                    />\r\n                    </div>\r\n                    <input\r\n                        placeholder=\"Комментарий\"\r\n                        className=\"ModalInputInfoVacanciesComment\"\r\n                        ref={modalComment}\r\n                    />\r\n\r\n                    <button className=\"ModalButton\" type=\"submit\" disabled={isFetching}>\r\n                        Изменить\r\n                    </button>\r\n                </form>\r\n            </Modal>\r\n        </div>\r\n    )\r\n}\r\n"]},"metadata":{},"sourceType":"module"}