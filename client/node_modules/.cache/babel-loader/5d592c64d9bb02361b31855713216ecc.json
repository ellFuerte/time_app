{"ast":null,"code":"import _regeneratorRuntime from\"D:/Download/time_app/client/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"D:/Download/time_app/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"D:/Download/time_app/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import axios from'axios';import{useRef}from'react';import{useEffect,useState}from'react';import{format}from'date-fns';/*import { Add } from '@material-ui/icons'*/import InfoReposts from'../ReportsInfo/InfoReposts';import InfoPost from'../InfoPost/InfoPost';import Pagination from'../Pagination/Pagination';import VacationPost from'../VacationPost/VacationPost';import'./HistoryInfo.css';import Modal from'../Templates/Modal/Modal';import{useParams}from\"react-router-dom\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function HistoryInfo(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),posts=_useState2[0],setPosts=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isFetching=_useState4[0],setIsFetching=_useState4[1];var _useState5=useState(1),_useState6=_slicedToArray(_useState5,2),currentPage=_useState6[0],setCurrentPage=_useState6[1];var _useState7=useState(30),_useState8=_slicedToArray(_useState7,1),postsPerPage=_useState8[0];var lastPostIndex=currentPage*postsPerPage;var firstPostIndex=lastPostIndex-postsPerPage;var currentlyPosts=posts.slice(firstPostIndex,lastPostIndex);var historyStartWork=useRef(null);var historyEndWork=useRef(null);var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),isFilter=_useState10[0],setIsFilter=_useState10[1];var _useState11=useState([]),_useState12=_slicedToArray(_useState11,2),newPosts=_useState12[0],setNewPosts=_useState12[1];var _useState13=useState(''),_useState14=_slicedToArray(_useState13,2),error=_useState14[0],setError=_useState14[1];var _useState15=useState(''),_useState16=_slicedToArray(_useState15,2),modalError=_useState16[0],setModalError=_useState16[1];var username=useParams();var localUser=!!username?{_id:username.username,email:\"\"}:JSON.parse(localStorage.getItem('user'));var _useState17=useState([]),_useState18=_slicedToArray(_useState17,2),vacationPosts=_useState18[0],setVacationPosts=_useState18[1];var _useState19=useState(true),_useState20=_slicedToArray(_useState19,2),isJob=_useState20[0],setIsJob=_useState20[1];var _useState21=useState(false),_useState22=_slicedToArray(_useState21,2),modalActive=_useState22[0],setModalActive=_useState22[1];var _useState23=useState(null),_useState24=_slicedToArray(_useState23,2),modalName=_useState24[0],setModalName=_useState24[1];var modalComment=useRef();var vacationStart=useRef();var vacationEnd=useRef();// получение всех постов работы от послелнего к первому\nuseEffect(function(){setIsFetching(true);fetchUserpost();},[username]);var fetchUserpost=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get('/api/post?type=1&id='+localUser._id);case 2:res=_context.sent;setPosts(res.data.sort(function(p1,p2){return new Date(p2.workstart)-new Date(p1.workstart);}));setIsFetching(false);case 5:case\"end\":return _context.stop();}}},_callee);}));return function fetchUserpost(){return _ref.apply(this,arguments);};}();var paginate=function paginate(pageNumber){return setCurrentPage(pageNumber);};// фильтер постов по дате\nvar handleClick=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var start,end,filter,fill;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:start=historyStartWork.current.value;end=historyEndWork.current.value;if(start===\"\"||end===\"\"){setError('Введите дату');}else{if(start!==''||end!==''){setError('Выберите дату');}if(end<start){setError('Конечная дата меньше начальной');}else{filter={startdate:historyStartWork.current.value,enddate:historyEndWork.current.value,userId:localUser._id,typework:isJob};setError('');fill=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var res;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return axios.post('/api/post/filter',filter);case 2:res=_context2.sent;console.log(res);setVacationPosts(res.data.sort(function(p1,p2){return new Date(p2.workstart)-new Date(p1.workstart);}));setPosts(res.data.sort(function(p1,p2){return new Date(p2.workstart)-new Date(p1.workstart);}));setError('');case 7:case\"end\":return _context2.stop();}}},_callee2);}));return function fill(){return _ref3.apply(this,arguments);};}();fill();}}/*      let filterPosts = isJob\r\n      ?  posts.filter(post => post.workdate.split('T')[0] >= start)\r\n      : vacationPosts.filter(post => post.start.split('T')[0] >= start)\r\n    if(end){\r\n      filterPosts = isJob\r\n        ? filterPosts.filter(post => post.workdate.split('T')[0] <= end)\r\n        : filterPosts.filter(post => post.end.split('T')[0] <= end)\r\n    }\r\n    setNewPosts(filterPosts)*/case 3:case\"end\":return _context3.stop();}}},_callee3);}));return function handleClick(){return _ref2.apply(this,arguments);};}();// сброс фильтра\nvar handleClickCancel=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:setError('');setIsFilter(false);historyStartWork.current.value='';historyEndWork.current.value='';case 4:case\"end\":return _context4.stop();}}},_callee4);}));return function handleClickCancel(){return _ref4.apply(this,arguments);};}();// получение всех постов об отпуске/больничном от послелнего к первому\nuseEffect(function(){setIsFetching(true);fetchUservacation();},[username]);var fetchUservacation=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(){var res;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.next=2;return axios.get('/api/vacation?id='+localUser._id);case 2:res=_context5.sent;setVacationPosts(res.data.sort(function(p1,p2){return new Date(p2.start)-new Date(p1.start);}));setIsFetching(false);case 5:case\"end\":return _context5.stop();}}},_callee5);}));return function fetchUservacation(){return _ref5.apply(this,arguments);};}();// добавление больничного\nvar handleClickAdd=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(e){var currentDay,vacation,isTrue;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:e.preventDefault();currentDay=new Date();if(!(vacationStart.current.value===''||vacationEnd.current.value===''||modalName===null||modalComment.current.value==='')){_context6.next=5;break;}setModalError('Вcе поля должны быть заполнены');return _context6.abrupt(\"return\");case 5:if(!(new Date(vacationStart.current.value)>new Date(vacationEnd.current.value)&&vacationEnd.current.value!=='')){_context6.next=8;break;}setModalError('Вторая дата меньше первой');return _context6.abrupt(\"return\");case 8:vacation={userId:localUser._id,status:modalName,comment:modalComment.current.value,start:new Date(vacationStart.current.value),end:new Date(vacationEnd.current.value)};/*    const newPost = {\r\n      userId: localUser._id,\r\n      healthEnd: 1,\r\n      workEnd: new Date(Date.now()),\r\n      workTime: new Date(Date.now()) - new Date(posts[0].workStart)\r\n    }*/isTrue=new Date(vacationStart.current.value)<=currentDay&&currentDay.getDate()<=vacation.end.getDate()+1;_context6.prev=10;_context6.next=13;return axios.post('/api/vacation/',vacation);case 13:/*      if (isTrue) {\r\n       /!* await axios.put(\"/api/post/\"+posts[0]._id, newPost)*!/\r\n        await axios.put('/api/user/'+localUser._id, {status:3, userId: username})\r\n        if (localUser._id === username) {\r\n          localStorage.setItem('user', JSON.stringify({...localUser, status:3}))\r\n        }\r\n      }*/window.location.reload();_context6.next=19;break;case 16:_context6.prev=16;_context6.t0=_context6[\"catch\"](10);console.log(_context6.t0);case 19:case\"end\":return _context6.stop();}}},_callee6,null,[[10,16]]);}));return function handleClickAdd(_x){return _ref6.apply(this,arguments);};}();// переход на страницу с больничным и обратно\nvar handleWorkVacation=function handleWorkVacation(){if(isJob){fetchUservacation();}else{fetchUserpost();}setIsJob(!isJob);setError('');setIsFilter(false);historyStartWork.current.value='';historyEndWork.current.value='';};var handleName=function handleName(e){setModalName(e.target.value);};return/*#__PURE__*/_jsxs(\"div\",{className:\"historyInfo\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"historyInfoTop\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"historyInfoTitle\",children:\"\\u0418\\u0441\\u0442\\u043E\\u0440\\u0438\\u044F\"}),/*#__PURE__*/_jsx(\"span\",{className:\"workVacation\",onClick:handleWorkVacation,children:isJob?/*#__PURE__*/_jsx(\"button\",{className:\"filterButton\",style:{width:'155px'},children:\"\\u041E\\u0442\\u043F\\u0443\\u0441\\u043A/\\u0411\\u043E\\u043B\\u044C\\u043D\\u0438\\u0447\\u043D\\u044B\\u0439\"}):/*#__PURE__*/_jsx(\"button\",{className:\"filterButton\",children:\"\\u0420\\u0430\\u0431\\u043E\\u0442\\u0430\"})}),!isJob&&(localUser||username===localUser._id)&&/*#__PURE__*/_jsx(\"div\",{className:\"addVacation\",onClick:function onClick(){return setModalActive(true);},children:/*#__PURE__*/_jsx(\"span\",{children:\"+\"})})]}),/*#__PURE__*/_jsx(\"hr\",{}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"errorHistoryInfo\",children:error}),/*#__PURE__*/_jsxs(\"div\",{className:\"historyFilter\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"date\",placeholder:\"\\u041D\\u0430\\u0447\\u0430\\u043B\\u043E \\u0440\\u0430\\u0431\\u043E\\u0442\\u044B\",className:\"ModalInput\",ref:historyStartWork,style:{'marginRight':'10px'}}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",placeholder:\"\\u041A\\u043E\\u043D\\u0435\\u0446 \\u0440\\u0430\\u0431\\u043E\\u0442\\u044B\",className:\"ModalInput\",ref:historyEndWork,style:{'marginRight':'10px'}}),/*#__PURE__*/_jsx(\"button\",{className:\"filterButton\",onClick:handleClick,children:\"\\u043E\\u043A\"}),/*#__PURE__*/_jsx(\"button\",{className:\"filterButton\",onClick:handleClickCancel,children:\"\\u0441\\u0431\\u0440\\u043E\\u0441\\u0438\\u0442\\u044C\"})]}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsx(\"br\",{}),isJob?/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{className:\"historyinfodate\",children:\"\\u0414\\u0430\\u0442\\u0430\"}),/*#__PURE__*/_jsx(\"td\",{className:\"historyinfopost\",children:\"\\u0412\\u0440\\u0435\\u043C\\u044F \\u043D\\u0430\\u0447\\u0430\\u043B\\u0430\"}),/*#__PURE__*/_jsx(\"td\",{className:\"historyinfopost\",children:\"\\u0412\\u0440\\u0435\\u043C\\u044F \\u043E\\u043A\\u043E\\u043D\\u0447\\u0430\\u043D\\u0438\\u044F\"}),/*#__PURE__*/_jsx(\"td\",{className:\"historyinfopost\",children:\"\\u0414\\u043B\\u0438\\u0442\\u0435\\u043B\\u044C\\u043D\\u043E\\u0441\\u0442\\u044C\"}),/*#__PURE__*/_jsx(\"td\",{className:\"historyinfopost\",children:\"\\u0421\\u043E\\u0441\\u0442\\u043E\\u044F\\u043D\\u0438\\u0435 \\u0437\\u0434\\u043E\\u0440\\u043E\\u0432\\u044C\\u044F\"}),/*#__PURE__*/_jsx(\"td\",{className:\"historyinfocomment\",children:\"\\u041A\\u043E\\u043C\\u043C\\u0435\\u043D\\u0442\\u0430\\u0440\\u0438\\u0439\"})]}):/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{className:\"historyinfopostdate\",children:\"\\u041D\\u0430\\u0447\\u0430\\u043B\\u043E\"}),/*#__PURE__*/_jsx(\"td\",{className:\"historyinfopost\",children:\"\\u041A\\u043E\\u043D\\u0435\\u0446\"}),/*#__PURE__*/_jsx(\"td\",{className:\"historyinfopost\",children:\"\\u0414\\u043B\\u0438\\u0442\\u0435\\u043B\\u044C\\u043D\\u043E\\u0441\\u0442\\u044C\"}),/*#__PURE__*/_jsx(\"td\",{className:\"historyinfopost\",children:\"\\u041F\\u0440\\u0438\\u0447\\u0438\\u043D\\u0430\"}),/*#__PURE__*/_jsx(\"td\",{className:\"historycomment\",children:\"\\u041A\\u043E\\u043C\\u043C\\u0435\\u043D\\u0442\\u0430\\u0440\\u0438\\u0439\"})]}),isJob?isFetching?/*#__PURE__*/_jsx(\"div\",{className:\"isFatching\",children:\"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430...\"}):isFilter?newPosts.map(function(post,id){return/*#__PURE__*/_jsx(InfoPost,{post:post,username:username},id);}):currentlyPosts.map(function(post,id){return/*#__PURE__*/_jsx(InfoPost,{post:post,username:username},id);}):isFetching?/*#__PURE__*/_jsx(\"div\",{className:\"isFatching\",children:\"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430...\"}):isFilter?newPosts.map(function(post,id){return/*#__PURE__*/_jsx(VacationPost,{post:post,username:username},id);}):vacationPosts.map(function(post,id){return/*#__PURE__*/_jsx(VacationPost,{post:post},id);}),/*#__PURE__*/_jsx(Pagination,{postsPerPage:postsPerPage,totalPosts:posts.length,paginate:paginate,currentPage:currentPage}),/*#__PURE__*/_jsxs(Modal,{active:modalActive,setActive:setModalActive,children:[/*#__PURE__*/_jsx(\"h1\",{children:\"\\u0418\\u0437\\u043C\\u0435\\u043D\\u0435\\u043D\\u0438\\u0435 \\u0438\\u043D\\u0444\\u043E\\u0440\\u043C\\u0430\\u0446\\u0438\\u0438:\"}),/*#__PURE__*/_jsx(\"hr\",{}),modalError&&/*#__PURE__*/_jsx(\"div\",{className:\"errorHistoryInfo\",children:modalError}),/*#__PURE__*/_jsxs(\"form\",{className:\"modalLoginBox\",onSubmit:handleClickAdd,children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between',fontSize:'20px',width:'60%',marginLeft:'20%'},children:[/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"sickLeave\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"radio\",value:3,id:\"sickLeave\",name:\"sickLeave\",onChange:handleName,checked:modalName==='3'}),\"\\u0411\\u043E\\u043B\\u044C\\u043D\\u0438\\u0447\\u043D\\u044B\\u0439\"]}),/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"vacation\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"radio\",value:5,id:\"vacation\",name:\"vacation\",onChange:handleName,checked:modalName==='5'}),\"\\u041E\\u0442\\u043F\\u0443\\u0441\\u043A\"]}),/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"time\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"radio\",value:6,id:\"other\",name:\"time\",onChange:handleName,checked:modalName==='6'}),\"\\u041E\\u0442\\u0433\\u0443\\u043B\"]}),/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"anotherReason\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"radio\",value:7,id:\"anotherReason\",name:\"anotherReason\",onChange:handleName,checked:modalName==='7'}),\"\\u0414\\u0440\\u0443\\u0433\\u0430\\u044F \\u043F\\u0440\\u0438\\u0447\\u0438\\u043D\\u0430\"]})]}),/*#__PURE__*/_jsx(\"input\",{placeholder:\"\\u041A\\u043E\\u043C\\u043C\\u0435\\u043D\\u0442\\u0430\\u0440\\u0438\\u0439\",className:\"ModalInput\",ref:modalComment}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",placeholder:\"\\u041D\\u0430\\u0447\\u0430\\u043B\\u043E \\u0440\\u0430\\u0431\\u043E\\u0442\\u044B\",className:\"ModalInput\",ref:vacationStart,style:{'marginRight':'10px'}}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",placeholder:\"\\u041A\\u043E\\u043D\\u0435\\u0446 \\u0440\\u0430\\u0431\\u043E\\u0442\\u044B\",className:\"ModalInput\",ref:vacationEnd,style:{'marginRight':'10px'}}),/*#__PURE__*/_jsx(\"button\",{className:\"ModalButton\",type:\"submit\",disabled:isFetching,children:\"\\u0418\\u0437\\u043C\\u0435\\u043D\\u0438\\u0442\\u044C\"})]})]})]});}","map":{"version":3,"sources":["D:/Download/time_app/client/src/components/HistoryInfo/HistoryInfo.jsx"],"names":["axios","useRef","useEffect","useState","format","InfoReposts","InfoPost","Pagination","VacationPost","Modal","useParams","HistoryInfo","posts","setPosts","isFetching","setIsFetching","currentPage","setCurrentPage","postsPerPage","lastPostIndex","firstPostIndex","currentlyPosts","slice","historyStartWork","historyEndWork","isFilter","setIsFilter","newPosts","setNewPosts","error","setError","modalError","setModalError","username","localUser","_id","email","JSON","parse","localStorage","getItem","vacationPosts","setVacationPosts","isJob","setIsJob","modalActive","setModalActive","modalName","setModalName","modalComment","vacationStart","vacationEnd","fetchUserpost","get","res","data","sort","p1","p2","Date","workstart","paginate","pageNumber","handleClick","start","current","value","end","filter","startdate","enddate","userId","typework","fill","post","console","log","handleClickCancel","fetchUservacation","handleClickAdd","e","preventDefault","currentDay","vacation","status","comment","isTrue","getDate","window","location","reload","handleWorkVacation","handleName","target","width","map","id","length","display","justifyContent","fontSize","marginLeft"],"mappings":"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","sourcesContent":["import axios from 'axios'\r\nimport { useRef } from 'react'\r\nimport { useEffect, useState } from 'react'\r\nimport { format } from 'date-fns'\r\n/*import { Add } from '@material-ui/icons'*/\r\nimport InfoReposts from '../ReportsInfo/InfoReposts'\r\nimport InfoPost from '../InfoPost/InfoPost'\r\nimport Pagination from '../Pagination/Pagination'\r\nimport VacationPost from '../VacationPost/VacationPost'\r\nimport './HistoryInfo.css'\r\nimport Modal from '../Templates/Modal/Modal'\r\nimport {useParams} from \"react-router-dom\";\r\n\r\n\r\nexport default function HistoryInfo() {\r\n  const [posts, setPosts] = useState([])\r\n  const [isFetching, setIsFetching] = useState(false)\r\n  const [currentPage, setCurrentPage] = useState(1)\r\n  const [postsPerPage] = useState(30)\r\n\r\n  const lastPostIndex = currentPage * postsPerPage\r\n  const firstPostIndex = lastPostIndex - postsPerPage\r\n  const currentlyPosts = posts.slice(firstPostIndex, lastPostIndex)\r\n\r\n  const historyStartWork = useRef(null)\r\n  const historyEndWork = useRef(null)\r\n  const [isFilter, setIsFilter] = useState(false)\r\n  const [newPosts, setNewPosts] = useState([])\r\n  const [error, setError] = useState('')\r\n  const [modalError, setModalError] = useState('')\r\n  const username=useParams()\r\n\r\n  let localUser = !!username ? {_id:username.username,email:\"\"} : JSON.parse(localStorage.getItem('user'))\r\n\r\n\r\n  const [vacationPosts, setVacationPosts] = useState([])\r\n  const [isJob, setIsJob] = useState(true)\r\n\r\n  const [modalActive, setModalActive] = useState(false)\r\n  const [modalName, setModalName] = useState(null)\r\n  const modalComment = useRef()\r\n  const vacationStart = useRef()\r\n  const vacationEnd = useRef()\r\n\r\n  // получение всех постов работы от послелнего к первому\r\n\r\n   useEffect(() => {\r\n    setIsFetching(true)\r\n\r\n     fetchUserpost()\r\n  }, [username])\r\n\r\n  const fetchUserpost = async () => {\r\n    const res = await axios.get('/api/post?type=1&id='+localUser._id)\r\n    setPosts(res.data.sort((p1, p2) => {\r\n      return new Date(p2.workstart) - new Date(p1.workstart)\r\n    }))\r\n    setIsFetching(false)\r\n  }\r\n  const paginate = pageNumber => setCurrentPage(pageNumber)\r\n\r\n  // фильтер постов по дате\r\n      const handleClick = async () => {\r\n      const start = historyStartWork.current.value\r\n      const end = historyEndWork.current.value\r\n      if (start === \"\" || end === \"\" ) {\r\n        setError('Введите дату')\r\n      } else{\r\n        if (start !== '' || end !== '') {\r\n          setError('Выберите дату')}\r\n        if (end< start) {\r\n          setError('Конечная дата меньше начальной')}\r\n\r\n        else{\r\n\r\n        const filter = {\r\n          startdate: historyStartWork.current.value,\r\n          enddate: historyEndWork.current.value,\r\n          userId: localUser._id,\r\n          typework:isJob\r\n        }\r\n        setError('')\r\n\r\n        const fill = async () => {\r\n        const res = await axios.post('/api/post/filter',filter)\r\n        console.log(res)\r\n          setVacationPosts(res.data.sort((p1, p2) => {\r\n            return new Date(p2.workstart) - new Date(p1.workstart)\r\n          }))\r\n          setPosts(res.data.sort((p1, p2) => {\r\n            return new Date(p2.workstart) - new Date(p1.workstart)\r\n          }))\r\n        setError('')\r\n        }\r\n          fill()\r\n      }}\r\n\r\n/*      let filterPosts = isJob\r\n      ?  posts.filter(post => post.workdate.split('T')[0] >= start)\r\n      : vacationPosts.filter(post => post.start.split('T')[0] >= start)\r\n    if(end){\r\n      filterPosts = isJob\r\n        ? filterPosts.filter(post => post.workdate.split('T')[0] <= end)\r\n        : filterPosts.filter(post => post.end.split('T')[0] <= end)\r\n    }\r\n    setNewPosts(filterPosts)*/\r\n\r\n  }\r\n\r\n\r\n  // сброс фильтра\r\n  const handleClickCancel = async () =>{\r\n    setError('')\r\n    setIsFilter(false)\r\n    historyStartWork.current.value = ''\r\n    historyEndWork.current.value = ''\r\n  }\r\n\r\n\r\n  // получение всех постов об отпуске/больничном от послелнего к первому\r\n    useEffect(() => {\r\n    setIsFetching(true)\r\n\r\n      fetchUservacation()\r\n  }, [username])\r\n\r\n  const fetchUservacation = async () => {\r\n    const res = await axios.get('/api/vacation?id='+localUser._id)\r\n    setVacationPosts(res.data.sort((p1, p2) => {\r\n      return new Date(p2.start) - new Date(p1.start)\r\n    }))\r\n    setIsFetching(false)\r\n  }\r\n  // добавление больничного\r\n  const handleClickAdd = async (e) => {\r\n    e.preventDefault()\r\n\r\n    const currentDay = new Date()\r\n\r\n    if(vacationStart.current.value === '' || vacationEnd.current.value === '' || modalName === null || modalComment.current.value === ''){\r\n      setModalError('Вcе поля должны быть заполнены')\r\n      return\r\n    }\r\n\r\n    if(new Date(vacationStart.current.value) > new Date(vacationEnd.current.value) && vacationEnd.current.value !== ''){\r\n      setModalError('Вторая дата меньше первой')\r\n      return\r\n    }\r\n\r\n    const vacation = {\r\n      userId: localUser._id,\r\n      status: modalName,\r\n      comment: modalComment.current.value,\r\n      start: new Date(vacationStart.current.value),\r\n      end: new Date(vacationEnd.current.value)\r\n    }\r\n\r\n/*    const newPost = {\r\n      userId: localUser._id,\r\n      healthEnd: 1,\r\n      workEnd: new Date(Date.now()),\r\n      workTime: new Date(Date.now()) - new Date(posts[0].workStart)\r\n    }*/\r\n\r\n    const isTrue = new Date(vacationStart.current.value) <= currentDay && currentDay.getDate() <= vacation.end.getDate()+1\r\n\r\n    try {\r\n      await axios.post('/api/vacation/',vacation)\r\n/*      if (isTrue) {\r\n       /!* await axios.put(\"/api/post/\"+posts[0]._id, newPost)*!/\r\n        await axios.put('/api/user/'+localUser._id, {status:3, userId: username})\r\n        if (localUser._id === username) {\r\n          localStorage.setItem('user', JSON.stringify({...localUser, status:3}))\r\n        }\r\n      }*/\r\n      window.location.reload()\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n  }\r\n\r\n  // переход на страницу с больничным и обратно\r\n  const handleWorkVacation = () => {\r\n    if(isJob){\r\n      fetchUservacation()}else {\r\n      fetchUserpost()\r\n    }\r\n    setIsJob(!isJob)\r\n    setError('')\r\n    setIsFilter(false)\r\n    historyStartWork.current.value = ''\r\n    historyEndWork.current.value = ''\r\n  }\r\n\r\n  const handleName = e => {\r\n    setModalName(e.target.value)\r\n  }\r\n  return (\r\n    <div className='historyInfo'>\r\n      <div className='historyInfoTop'>\r\n        <span className='historyInfoTitle'>История</span>\r\n        <span className='workVacation' onClick={handleWorkVacation}>{isJob ? <button className=\"filterButton\" style={{width:'155px'}}>Отпуск/Больничный</button> : <button className=\"filterButton\">Работа</button> }</span>\r\n\r\n        {!isJob && (localUser || username === localUser._id)\r\n\r\n        && <div className='addVacation' onClick={() => setModalActive(true)}><span>+</span></div>}\r\n      </div>\r\n      <hr/>\r\n      {error && <div className='errorHistoryInfo'>{error}</div>}\r\n      <div className='historyFilter'>\r\n        <input\r\n          type='date'\r\n          placeholder=\"Начало работы\"\r\n          className=\"ModalInput\"\r\n          ref={historyStartWork}\r\n          style={{'marginRight': '10px'}}\r\n        />\r\n        <input\r\n          type='date'\r\n          placeholder=\"Конец работы\"\r\n          className=\"ModalInput\"\r\n          ref={historyEndWork}\r\n          style={{'marginRight': '10px'}}\r\n        />\r\n        <button className=\"filterButton\" onClick={handleClick}>ок</button>\r\n        <button className=\"filterButton\" onClick={handleClickCancel}>сбросить</button>\r\n      </div>\r\n      <hr/>\r\n      <br/>\r\n      {isJob\r\n          ?\r\n        <tr>\r\n          <td className=\"historyinfodate\">Дата</td>\r\n          <td className=\"historyinfopost\">Время начала</td>\r\n          <td className=\"historyinfopost\">Время окончания</td>\r\n          <td className=\"historyinfopost\">Длительность</td>\r\n          <td className=\"historyinfopost\">Состояние здоровья</td>\r\n          <td className=\"historyinfocomment\">Комментарий</td>\r\n        </tr>\r\n          :\r\n            <tr>\r\n            <td className=\"historyinfopostdate\">Начало</td>\r\n            <td className=\"historyinfopost\">Конец</td>\r\n            <td className=\"historyinfopost\">Длительность</td>\r\n            <td className=\"historyinfopost\">Причина</td>\r\n            <td className=\"historycomment\">Комментарий</td>\r\n            </tr>\r\n      }\r\n\r\n      {isJob\r\n        ? isFetching\r\n          ? <div className='isFatching'>Загрузка...</div>\r\n          : isFilter\r\n            ? newPosts.map((post, id) => <InfoPost key={id} post={post} username={username}/>)\r\n            : currentlyPosts.map((post, id) => <InfoPost key={id} post={post} username={username}/>)\r\n        : isFetching\r\n          ? <div className='isFatching'>Загрузка...</div>\r\n          : isFilter\r\n            ? newPosts.map((post, id) => <VacationPost key={id} post={post} username={username}/>)\r\n            : vacationPosts.map((post, id) => <VacationPost key={id} post={post}/>)\r\n      }\r\n\r\n\r\n\r\n      <Pagination postsPerPage={postsPerPage} totalPosts={posts.length} paginate={paginate} currentPage={currentPage}/>\r\n\r\n      <Modal active={modalActive} setActive={setModalActive}>\r\n        <h1>Изменение информации:</h1>\r\n        <hr/>\r\n        {modalError && <div className='errorHistoryInfo'>{modalError}</div>}\r\n        <form className=\"modalLoginBox\" onSubmit={handleClickAdd}>\r\n          <div style={{display:'flex', justifyContent:'space-between', fontSize: '20px', width:'60%', marginLeft:'20%'}}>\r\n            <label htmlFor='sickLeave'>\r\n            <input\r\n              type='radio'\r\n              value={3}\r\n              id='sickLeave'\r\n              name='sickLeave'\r\n              onChange={handleName}\r\n              checked={modalName === '3'}\r\n            />Больничный</label>\r\n            <label htmlFor='vacation'>\r\n            <input\r\n              type='radio'\r\n              value={5}\r\n              id='vacation'\r\n              name='vacation'\r\n              onChange={handleName}\r\n              checked={modalName === '5'}\r\n            />Отпуск</label>\r\n            <label htmlFor='time'>\r\n              <input\r\n                  type='radio'\r\n                  value={6}\r\n                  id='other'\r\n                  name='time'\r\n                  onChange={handleName}\r\n                  checked={modalName === '6'}\r\n              />Отгул</label>\r\n            <label htmlFor='anotherReason'>\r\n            <input\r\n              type='radio'\r\n              value={7}\r\n              id='anotherReason'\r\n              name='anotherReason'\r\n              onChange={handleName}\r\n              checked={modalName === '7'}\r\n            />Другая причина</label>\r\n\r\n          </div>\r\n          <input\r\n            placeholder=\"Комментарий\"\r\n            className=\"ModalInput\"\r\n            ref={modalComment}\r\n          />\r\n          <input\r\n          type='date'\r\n          placeholder=\"Начало работы\"\r\n          className=\"ModalInput\"\r\n          ref={vacationStart}\r\n          style={{'marginRight': '10px'}}\r\n        />\r\n        <input\r\n          type='date'\r\n          placeholder=\"Конец работы\"\r\n          className=\"ModalInput\"\r\n          ref={vacationEnd}\r\n          style={{'marginRight': '10px'}}\r\n        />\r\n          <button className=\"ModalButton\" type=\"submit\" disabled={isFetching}>\r\n            Изменить\r\n          </button>\r\n        </form>\r\n      </Modal>\r\n    </div>\r\n  )\r\n}\r\n"]},"metadata":{},"sourceType":"module"}