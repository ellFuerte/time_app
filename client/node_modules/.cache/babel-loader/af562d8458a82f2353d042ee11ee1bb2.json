{"ast":null,"code":"import _regeneratorRuntime from\"D:/Download/time_app/client/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"D:/Download/time_app/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"D:/Download/time_app/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{Link}from'react-router-dom';import{Delete}from'@material-ui/icons';import axios from'axios';import'./Employee.css';import{useEffect,useState}from'react';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export default function Employee(_ref){var user=_ref.user;var _useState=useState(['']),_useState2=_slicedToArray(_useState,2),admin=_useState2[0],setAdmin=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),posts=_useState4[0],setPosts=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isFetching=_useState6[0],setIsFetching=_useState6[1];var _useState7=useState(null),_useState8=_slicedToArray(_useState7,2),date=_useState8[0],setDate=_useState8[1];var _useState9=useState(null),_useState10=_slicedToArray(_useState9,2),time=_useState10[0],setTime=_useState10[1];var _useState11=useState(null),_useState12=_slicedToArray(_useState11,2),dateStart=_useState12[0],setDateStart=_useState12[1];var _useState13=useState(null),_useState14=_slicedToArray(_useState13,2),dateEnd=_useState14[0],setDateEnd=_useState14[1];var localUser=JSON.parse(localStorage.getItem('user'));var setDat=new Date();setDat.setDate(setDat.getDate());var dat=setDat.toLocaleDateString();var usersStatuses={0:'',1:'start',2:'end',3:'sick_leave',4:'deleted',5:'vacation',6:'time_off',7:'other'};function findStatus(k){for(var i in usersStatuses){if(i==k){return usersStatuses[i];}}}var fetchUserpost=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res,users;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get('/api/post?type=1&id='+user.id);case 2:res=_context.sent;_context.next=5;return axios.get('/api/user/'+user.id);case 5:users=_context.sent;console.log(\"REEEEEEEEEEEE=\",users.data.isadmin);if(users.data.isadmin===true){setAdmin('*');}else{setAdmin('');}setDate('');setTime('');try{setDate(res.data[0].workdate);setTime(res.data[0].workend);}catch(_unused){}setPosts(res.data.sort(function(p1,p2){return new Date(p2.workstart)-new Date(p1.workstart);}));setIsFetching(false);case 13:case\"end\":return _context.stop();}}},_callee);}));return function fetchUserpost(){return _ref2.apply(this,arguments);};}();/*  // Проверка, если пользователь закончил работу, то вывод даты, когда он закончил\r\n  useEffect(() => {\r\n    const fetchUser = async () => {\r\n      const res = await axios.get('/api/post/')\r\n      res.data.sort((p1, p2) => {\r\n        return new Date(p2.workStart) - new Date(p1.workStart)\r\n      })\r\n      let data = (res.data[0].workEnd)\r\n      data = new Date(data)\r\n      data = data.toLocaleString()\r\n      data = data.split(',')\r\n      let dataF = data[0].split('.')\r\n      let dataS = data[1].split(':')\r\n      dataF = dataF[0]+'/'+dataF[1]\r\n      dataS = dataS[0]+':'+dataS[1]\r\n      setDate(dataF)\r\n      setTime(dataS)\r\n    }\r\n    if(user.status === 2){\r\n      fetchUser()\r\n    }\r\n  }, [user._id])*/ // Проверка, если пользователь в отпуске или на больничном, то вывод даты начала и конца\nuseEffect(function(){var fetchUser=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var res,users;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return axios.get('/api/vacation?id='+user.id);case 2:res=_context2.sent;if(res.data.length===0){setDateStart(global.workdate='');setDateEnd(global.worked='');}else{setDateStart(res.data[0].workdate);setDateEnd(res.data[0].worked);}_context2.next=6;return axios.get('/api/user/'+user.id);case 6:users=_context2.sent;console.log(\"REEEEEEEEEEEE=\",users.data.isadmin);if(users.data.isadmin===true){setAdmin('*');}else{setAdmin('');}case 9:case\"end\":return _context2.stop();}}},_callee2);}));return function fetchUser(){return _ref3.apply(this,arguments);};}();if(user.status===1){fetchUser();}if(user.status===3){fetchUser();}if(user.status===7){fetchUser();}if(user.status===6){fetchUser();}if(user.status===5){fetchUser();}if(user.status===2){fetchUserpost();}},[user._id]);return/*#__PURE__*/_jsx(_Fragment,{children:user.status===4&&!localUser.isAdmin?/*#__PURE__*/_jsx(\"div\",{}):/*#__PURE__*/_jsxs(\"div\",{className:'employee '+findStatus(user.status),children:[/*#__PURE__*/_jsx(\"div\",{className:\"top\",children:localUser.isAdmin?/*#__PURE__*/_jsx(Link,{to:\"/profile/\".concat(user.id),className:\"name\",children:/*#__PURE__*/_jsxs(\"span\",{className:\"name\",children:[user.user_name,admin]})}):/*#__PURE__*/_jsx(\"div\",{className:\"name\",children:/*#__PURE__*/_jsxs(\"span\",{className:\"name\",children:[user.user_name,admin]})})}),/*#__PURE__*/_jsx(\"div\",{className:\"down\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"downRight\",children:[user.status===5&&/*#__PURE__*/_jsxs(\"div\",{className:\"vacationText\",children:[\"\\u041E\\u0442\\u043F\\u0443\\u0441\\u043A:\",dateStart,\"-\",dateEnd]}),user.status===6&&/*#__PURE__*/_jsxs(\"div\",{className:\"vacationText\",children:[\"\\u041E\\u0442\\u0433\\u0443\\u043B:\",dateStart,\"-\",dateEnd]}),user.status===7&&/*#__PURE__*/_jsxs(\"div\",{className:\"vacationText\",children:[\"\\u0414\\u0440\\u0443\\u0433\\u0430\\u044F \\u043F\\u0440\\u0438\\u0447\\u0438\\u043D\\u0430:\",dateStart,\"-\",dateEnd]}),user.status===3&&/*#__PURE__*/_jsxs(\"div\",{className:\"vacationText\",children:[\"\\u0411\\u043E\\u043B\\u044C\\u043D\\u0438\\u0447\\u043D\\u044B\\u0439:\",dateStart,\"-\",dateEnd]}),user.status===2&&/*#__PURE__*/_jsxs(\"div\",{className:\"vacationText\",children:[date,\"  \",time]})]})})]})});}{/*<div className='emailEmployee'>{user.email}</div>*/}","map":{"version":3,"sources":["D:/Download/time_app/client/src/components/Employee/Employee.jsx"],"names":["Link","Delete","axios","useEffect","useState","Employee","user","admin","setAdmin","posts","setPosts","isFetching","setIsFetching","date","setDate","time","setTime","dateStart","setDateStart","dateEnd","setDateEnd","localUser","JSON","parse","localStorage","getItem","setDat","Date","getDate","dat","toLocaleDateString","usersStatuses","findStatus","k","i","fetchUserpost","get","id","res","users","console","log","data","isadmin","workdate","workend","sort","p1","p2","workstart","fetchUser","length","global","worked","status","_id","isAdmin","user_name"],"mappings":"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","sourcesContent":["import { Link } from 'react-router-dom'\r\nimport { Delete } from '@material-ui/icons'\r\nimport axios from 'axios'\r\n\r\nimport './Employee.css'\r\nimport { useEffect, useState } from 'react'\r\n\r\n\r\nexport default function Employee({user}) {\r\n  const [admin, setAdmin] = useState([''])\r\n  const [posts, setPosts] = useState([])\r\n  const [isFetching, setIsFetching] = useState(false)\r\n  const [date, setDate] = useState(null)\r\n  const [time, setTime] = useState(null)\r\n  const [dateStart, setDateStart] = useState(null)\r\n  const [dateEnd, setDateEnd] = useState(null)\r\n\r\n\r\n  const localUser = JSON.parse(localStorage.getItem('user'))\r\n\r\n  const setDat = new Date()\r\n  setDat.setDate(setDat.getDate())\r\n  const dat=setDat.toLocaleDateString()\r\n\r\n  const usersStatuses = {0: '', 1: 'start', 2: 'end', 3: 'sick_leave', 4: 'deleted' ,5: 'vacation', 6: 'time_off', 7: 'other'}\r\n  function findStatus(k){\r\n    for(let i in usersStatuses){\r\n      if(i == k){\r\n        return usersStatuses[i]\r\n      }\r\n    }\r\n  }\r\n\r\n\r\n\r\n\r\n  const fetchUserpost = async () => {\r\n    const res = await axios.get('/api/post?type=1&id='+user.id)\r\n    const users = await axios.get('/api/user/'+user.id)\r\n    console.log(\"REEEEEEEEEEEE=\",users.data.isadmin)\r\n\r\n    if(users.data.isadmin===true){\r\n      setAdmin('*')}else{\r\n        setAdmin('')\r\n      }\r\n\r\n    setDate('')\r\n    setTime('')\r\ntry{\r\n  setDate(res.data[0].workdate)\r\n  setTime(res.data[0].workend)\r\n}\r\ncatch {\r\n}\r\n    setPosts(res.data.sort((p1, p2) => {\r\n      return new Date(p2.workstart) - new Date(p1.workstart)\r\n      }))\r\n    setIsFetching(false)\r\n\r\n  }\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/*  // Проверка, если пользователь закончил работу, то вывод даты, когда он закончил\r\n  useEffect(() => {\r\n    const fetchUser = async () => {\r\n      const res = await axios.get('/api/post/')\r\n      res.data.sort((p1, p2) => {\r\n        return new Date(p2.workStart) - new Date(p1.workStart)\r\n      })\r\n      let data = (res.data[0].workEnd)\r\n      data = new Date(data)\r\n      data = data.toLocaleString()\r\n      data = data.split(',')\r\n      let dataF = data[0].split('.')\r\n      let dataS = data[1].split(':')\r\n      dataF = dataF[0]+'/'+dataF[1]\r\n      dataS = dataS[0]+':'+dataS[1]\r\n      setDate(dataF)\r\n      setTime(dataS)\r\n    }\r\n    if(user.status === 2){\r\n      fetchUser()\r\n    }\r\n  }, [user._id])*/\r\n\r\n\r\n\r\n  // Проверка, если пользователь в отпуске или на больничном, то вывод даты начала и конца\r\n  useEffect(() => {\r\n    const fetchUser = async () => {\r\n      const res = await axios.get('/api/vacation?id=' + user.id)\r\n\r\n      if (res.data.length === 0) {\r\n        setDateStart(global.workdate = '')\r\n        setDateEnd(global.worked = '')\r\n      } else {\r\n        setDateStart(res.data[0].workdate)\r\n        setDateEnd(res.data[0].worked)\r\n\r\n      }\r\n      const users = await axios.get('/api/user/'+user.id)\r\n      console.log(\"REEEEEEEEEEEE=\",users.data.isadmin)\r\n\r\n      if(users.data.isadmin===true){\r\n        setAdmin('*')}else{\r\n        setAdmin('')\r\n      }\r\n    }\r\n\r\n    if (user.status === 1) {\r\n      fetchUser()\r\n    }\r\n    if (user.status === 3) {\r\n        fetchUser()\r\n      }\r\n\r\n      if (user.status === 7) {\r\n        fetchUser()\r\n      }\r\n      if (user.status === 6) {\r\n        fetchUser()\r\n      }\r\n\r\n      if (user.status === 5) {\r\n        fetchUser()\r\n      }\r\n      if (user.status === 2) {\r\n        fetchUserpost()\r\n      }\r\n  }, [user._id])\r\n\r\n\r\n\r\n  return (<>\r\n\r\n        {user.status === 4 && !localUser.isAdmin\r\n            ?\r\n            <div></div>\r\n            :\r\n            <div className={'employee ' + (findStatus(user.status))}>\r\n              <div className='top'>{localUser.isAdmin\r\n                  ?\r\n                  <Link to={`/profile/${user.id}`} className='name'><span className='name'>{user.user_name}{admin}</span></Link>\r\n                  : <div className='name'><span className='name'>{user.user_name}{admin}</span></div>\r\n              }\r\n              </div>\r\n              <div className='down'>\r\n                <div className='downRight'>\r\n                  {/*<div className='emailEmployee'>{user.email}</div>*/}\r\n                  {user.status === 5 && <div className='vacationText'>Отпуск:{dateStart}-{dateEnd}</div>}\r\n                  {user.status === 6 && <div className='vacationText'>Отгул:{dateStart}-{dateEnd}</div>}\r\n                  {user.status === 7 && <div className='vacationText'>Другая причина:{dateStart}-{dateEnd}</div>}\r\n                  {user.status === 3 && <div className='vacationText' >Больничный:{dateStart}-{dateEnd}</div>}\r\n                  {user.status === 2 && <div className='vacationText' >{date}  {time}</div>}\r\n                </div>\r\n              </div>\r\n            </div>\r\n        }</>\r\n  )\r\n}\r\n\r\n\r\n{/*<div className='emailEmployee'>{user.email}</div>*/}\r\n"]},"metadata":{},"sourceType":"module"}