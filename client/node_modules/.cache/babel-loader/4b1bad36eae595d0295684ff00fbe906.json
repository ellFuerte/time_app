{"ast":null,"code":"import _regeneratorRuntime from\"D:/time_app/client/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"D:/time_app/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"D:/time_app/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{Link}from'react-router-dom';import'./SearchBlock.css';import{useEffect,useState}from\"react\";import axios from\"axios\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var usersStatuses={0:'',1:'start',2:'end',3:'sick_leave',4:'deleted',5:'vacation',6:'time_off',7:'other'};function findStatus(k){for(var i in usersStatuses){if(i==k){return usersStatuses[i];}}}export default function SearchBlock(_ref){var user=_ref.user;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),nominations=_useState2[0],setNominations=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),admin=_useState4[0],setAdmin=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),date=_useState6[0],setDate=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),time=_useState8[0],setTime=_useState8[1];var _useState9=useState(),_useState10=_slicedToArray(_useState9,2),dateStart=_useState10[0],setDateStart=_useState10[1];var _useState11=useState(),_useState12=_slicedToArray(_useState11,2),dateEnd=_useState12[0],setDateEnd=_useState12[1];var localUser=JSON.parse(localStorage.getItem('user'));var usersStatuses={0:'',1:'start',2:'end',3:'sick_leave',4:'deleted',5:'vacation',6:'time_off',7:'other'};function findStatus(k){for(var i in usersStatuses){if(i==k){return usersStatuses[i];}}}// Проверка, если пользователь в отпуске или на больничном, то вывод даты начала и конца\nuseEffect(function(){var fetchUser=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var users,res,post;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get('/api/user/'+user.id);case 2:users=_context.sent;_context.next=5;return axios.get('/api/vacation?id='+user.id);case 5:res=_context.sent;_context.next=8;return axios.get('/api/post?type=1&id='+user.id);case 8:post=_context.sent;setNominations(users.data.nomination_status);if(users.data.isadmin!==true){setAdmin('');}else{setAdmin('*');}if(res.data.length===0){setDateStart('');setDateEnd('');}else{setDateStart(res.data[0].workdate);setDateEnd(res.data[0].worked);}if(post.data.length===0){setDate('');setTime('');}else{setDate(post.data[0].workdate);setTime(post.data[0].workend);}case 13:case\"end\":return _context.stop();}}},_callee);}));return function fetchUser(){return _ref2.apply(this,arguments);};}();if(user.status===1||user.status===2||user.status===3||user.status===5||user.status===6||user.status===7){fetchUser();}},[user.id]);var images={'1':{src:'../images/1.png',title:'Тучка'},'2':{src:'../images/2.png',title:'Аркадий Паровозов'},'3':{src:'../images/3.png',title:'И так сойдет'},'4':{src:'../images/4.png',title:'Портной'},'5':{src:'../images/5.png',title:'Мама обезьянка'},'6':{src:'../images/6.png',title:'Кот Матроскин'},'7':{src:'../images/7.png',title:'Крот'},'8':{src:'../images/8.png',title:'Птица говорун(голосуем только среди дежурных)'},'9':{src:'../images/9.png',title:'Хома(Голосуем среди коллег из внедрения)'},'10':{src:'../images/10.png',title:'Симка и нолик'}};return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"div\",{className:\"searchBlockContainer\",children:/*#__PURE__*/_jsx(Link,{to:\"/profile/\".concat(user.id),className:\"name\",onClick:function onClick(){return window.location.href=\"/profile/\".concat(user.id);},children:/*#__PURE__*/_jsx(\"div\",{className:'employee '+findStatus(user.status),children:/*#__PURE__*/_jsxs(\"div\",{className:\"angry-grid\",children:[/*#__PURE__*/_jsx(\"div\",{id:\"item-0\",children:/*#__PURE__*/_jsxs(\"span\",{className:\"searchName\",children:[user.user_name,localUser.isAdmin?admin:'']})}),/*#__PURE__*/_jsxs(\"div\",{id:\"item-1\",children:[user.status===5&&/*#__PURE__*/_jsxs(\"div\",{className:\"vacationText\",children:[\"\\u041E\\u0442\\u043F\\u0443\\u0441\\u043A:\",dateStart,\"-\",dateEnd]}),user.status===6&&/*#__PURE__*/_jsxs(\"div\",{className:\"vacationText\",children:[\"\\u041E\\u0442\\u0433\\u0443\\u043B:\",dateStart,\"-\",dateEnd]}),user.status===7&&/*#__PURE__*/_jsxs(\"div\",{className:\"vacationText\",children:[\"\\u0414\\u0440\\u0443\\u0433\\u0430\\u044F \\u043F\\u0440\\u0438\\u0447\\u0438\\u043D\\u0430:\",dateStart,\"-\",dateEnd]}),user.status===3&&/*#__PURE__*/_jsxs(\"div\",{className:\"vacationText\",children:[\"\\u0411\\u043E\\u043B\\u044C\\u043D\\u0438\\u0447\\u043D\\u044B\\u0439:\",dateStart,\"-\",dateEnd]}),user.status===2&&/*#__PURE__*/_jsxs(\"div\",{className:\"vacationText\",children:[date,\" \",time]})]}),/*#__PURE__*/_jsx(\"div\",{id:\"item-2\",children:Object.keys(images).map(function(key,id){return(user.nomination_status===key||user.nomination_status===parseInt(key)||nominations===key||nominations===parseInt(key))&&/*#__PURE__*/_jsx(\"img\",{src:images[key].src,title:images[key].title,alt:\"Image for \".concat(key)},id);})})]})})})})});}","map":{"version":3,"sources":["D:/time_app/client/src/components/SearchBlock/SearchBlock.jsx"],"names":["Link","useEffect","useState","axios","usersStatuses","findStatus","k","i","SearchBlock","user","nominations","setNominations","admin","setAdmin","date","setDate","time","setTime","dateStart","setDateStart","dateEnd","setDateEnd","localUser","JSON","parse","localStorage","getItem","fetchUser","get","id","users","res","post","data","nomination_status","isadmin","length","workdate","worked","workend","status","images","src","title","window","location","href","user_name","isAdmin","Object","keys","map","key","parseInt"],"mappings":"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","sourcesContent":["import {Link} from 'react-router-dom'\r\nimport './SearchBlock.css'\r\nimport {useEffect, useState} from \"react\";\r\nimport axios from \"axios\";\r\n\r\n\r\nconst usersStatuses = {0: '', 1: 'start', 2: 'end', 3: 'sick_leave', 4: 'deleted' ,5: 'vacation', 6: 'time_off', 7: 'other'}\r\nfunction findStatus(k){\r\n    for(let i in usersStatuses){\r\n        if(i == k){\r\n            return usersStatuses[i]\r\n        }\r\n    }\r\n}\r\n\r\nexport default function SearchBlock({user}) {\r\n    const [nominations, setNominations] = useState([])\r\n    const [admin, setAdmin] = useState()\r\n    const [date, setDate] = useState('')\r\n    const [time, setTime] = useState('')\r\n    const [dateStart, setDateStart] = useState()\r\n    const [dateEnd, setDateEnd] = useState()\r\n\r\n    const localUser = JSON.parse(localStorage.getItem('user'))\r\n\r\n    const usersStatuses = {\r\n        0: '',\r\n        1: 'start',\r\n        2: 'end',\r\n        3: 'sick_leave',\r\n        4: 'deleted',\r\n        5: 'vacation',\r\n        6: 'time_off',\r\n        7: 'other'\r\n    }\r\n\r\n    function findStatus(k) {\r\n        for (let i in usersStatuses) {\r\n            if (i == k) {\r\n                return usersStatuses[i]\r\n            }\r\n        }\r\n    }\r\n\r\n    // Проверка, если пользователь в отпуске или на больничном, то вывод даты начала и конца\r\n    useEffect(() => {\r\n\r\n        const fetchUser = async () => {\r\n            const users = await axios.get('/api/user/' + user.id)\r\n            const res = await axios.get('/api/vacation?id=' + user.id);\r\n            const post = await axios.get('/api/post?type=1&id=' + user.id);\r\n            setNominations(users.data.nomination_status)\r\n\r\n            if (users.data.isadmin !== true) {\r\n                setAdmin('');\r\n            } else {\r\n                setAdmin('*');\r\n            }\r\n\r\n\r\n            if (res.data.length === 0) {\r\n                setDateStart('')\r\n                setDateEnd('')\r\n            } else {\r\n                setDateStart(res.data[0].workdate)\r\n                setDateEnd(res.data[0].worked)\r\n            }\r\n\r\n\r\n\r\n            if (post.data.length === 0) {\r\n                setDate('')\r\n                setTime('')\r\n            } else {\r\n                setDate(post.data[0].workdate)\r\n                setTime(post.data[0].workend)\r\n            }\r\n        }\r\n\r\n        if (user.status === 1 || user.status === 2 || user.status === 3\r\n            || user.status === 5 || user.status === 6 || user.status === 7)\r\n        {\r\n            fetchUser()\r\n        }\r\n\r\n    }, [user.id])\r\n\r\n\r\n    const images = {\r\n        '1': { src: '../images/1.png', title: 'Тучка' },\r\n        '2': { src: '../images/2.png', title: 'Аркадий Паровозов' },\r\n        '3': { src: '../images/3.png', title: 'И так сойдет' },\r\n        '4': { src: '../images/4.png', title: 'Портной' },\r\n        '5': { src: '../images/5.png', title: 'Мама обезьянка' },\r\n        '6': { src: '../images/6.png', title: 'Кот Матроскин' },\r\n        '7': { src: '../images/7.png', title: 'Крот' },\r\n        '8': { src: '../images/8.png', title: 'Птица говорун(голосуем только среди дежурных)' },\r\n        '9': { src: '../images/9.png', title: 'Хома(Голосуем среди коллег из внедрения)' },\r\n        '10': { src: '../images/10.png', title: 'Симка и нолик' }\r\n    };\r\n\r\n\r\n    return (\r\n        <>\r\n            <div className=\"searchBlockContainer\">\r\n                    <Link to={`/profile/${user.id}`} className='name'\r\n                          onClick={() => window.location.href = `/profile/${user.id}`}>\r\n                        <div className={'employee ' + (findStatus(user.status))}>\r\n                            <div className=\"angry-grid\">\r\n                                <div id=\"item-0\">\r\n                                    <span className='searchName'>{user.user_name}{localUser.isAdmin ? admin:''}</span>\r\n                                </div>\r\n                                <div id=\"item-1\">\r\n\r\n                                    {user.status === 5 && <div className='vacationText'>Отпуск:{dateStart}-{dateEnd}</div>}\r\n                                    {user.status === 6 && <div className='vacationText'>Отгул:{dateStart}-{dateEnd}</div>}\r\n                                    {user.status === 7 && <div className='vacationText'>Другая причина:{dateStart}-{dateEnd}</div>}\r\n                                    {user.status === 3 && <div className='vacationText'>Больничный:{dateStart}-{dateEnd}</div>}\r\n                                    {user.status === 2 && <div className='vacationText'>{date} {time}</div>}\r\n\r\n                                </div>\r\n                                <div id=\"item-2\">\r\n\r\n                                    {Object.keys(images).map((key, id) => (\r\n                                        (user.nomination_status === key || user.nomination_status === parseInt(key) || nominations===key || nominations===parseInt(key)) &&\r\n\r\n                                        <img\r\n                                            key={id}\r\n                                            src={images[key].src}\r\n                                            title={images[key].title}\r\n                                            alt={`Image for ${key}`}\r\n                                        />\r\n\r\n                                    ))}\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </Link>\r\n            </div>\r\n        </>\r\n    )\r\n}\r\n\r\n\r\n"]},"metadata":{},"sourceType":"module"}