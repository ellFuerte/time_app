{"ast":null,"code":"import _regeneratorRuntime from\"D:/time_app/client/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"D:/time_app/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"D:/time_app/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useRef,useState}from'react';import Pagination from\"../Pagination/Pagination\";import ModalVacancies from\"../Templates/ModalVacancies/ModalVacancies\";import axios from\"axios\";import'./VacanciesView.css';import VacanciesItem from\"../VacanciesItem/VacanciesItem\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function VacanciesView(departId){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),modalVacations=_useState2[0],setModalVacations=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),inputValue=_useState4[0],setInputValue=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),inputValueGrade=_useState6[0],setInputValueGrade=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),selectedVacanciesName=_useState8[0],setSelectedVacanciesName=_useState8[1];var _useState9=useState(''),_useState10=_slicedToArray(_useState9,2),selectedVacanciesGrade=_useState10[0],setSelectedVacanciesGrade=_useState10[1];var _useState11=useState([]),_useState12=_slicedToArray(_useState11,2),deps=_useState12[0],setDeps=_useState12[1];var _useState13=useState(\"\"),_useState14=_slicedToArray(_useState13,2),searchValue=_useState14[0],setSearchValue=_useState14[1];var _useState15=useState(true),_useState16=_slicedToArray(_useState15,2),isOpen=_useState16[0],setIsOpen=_useState16[1];var _useState17=useState(1),_useState18=_slicedToArray(_useState17,2),currentPage=_useState18[0],setCurrentPage=_useState18[1];var _useState19=useState(5),_useState20=_slicedToArray(_useState19,1),postsPerPage=_useState20[0];var _useState21=useState(1),_useState22=_slicedToArray(_useState21,2),currentPageVacancies=_useState22[0],setCurrentPageVacancies=_useState22[1];var _useState23=useState(5),_useState24=_slicedToArray(_useState23,1),postsPerPageVacancies=_useState24[0];var _useState25=useState([]),_useState26=_slicedToArray(_useState25,2),vacancies=_useState26[0],setVacancies=_useState26[1];var _useState27=useState([]),_useState28=_slicedToArray(_useState27,2),find=_useState28[0],setFind=_useState28[1];var lastPostIndex=currentPage*postsPerPage;var firstPostIndex=lastPostIndex-postsPerPage;var currentlyPosts=vacancies.slice(firstPostIndex,lastPostIndex);var lastPostIndexVacancies=currentPageVacancies*postsPerPageVacancies;var firstPostIndexVacancies=lastPostIndexVacancies-postsPerPageVacancies;var currentlySearch=find.slice(firstPostIndexVacancies,lastPostIndexVacancies);var paginate=function paginate(pageNumber){return setCurrentPage(pageNumber);};var paginateVacancies=function paginateVacancies(pageNumberVacancies){return setCurrentPageVacancies(pageNumberVacancies);};var department=useRef();var searchRef=useRef();var _useState29=useState(''),_useState30=_slicedToArray(_useState29,2),startDate=_useState30[0],setStartDate=_useState30[1];// начальная дата фильтра\nvar _useState31=useState(''),_useState32=_slicedToArray(_useState31,2),endDate=_useState32[0],setEndDate=_useState32[1];// конечная дата фильтра\nvar _useState33=useState([]),_useState34=_slicedToArray(_useState33,2),filteredData=_useState34[0],setFilteredData=_useState34[1];useEffect(function(){var VacanciesView=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res,getVacancies,sort;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get('/api/departments/');case 2:res=_context.sent;setDeps(res.data);_context.next=6;return axios.get('/api/Vacations/');case 6:getVacancies=_context.sent;sort=getVacancies.data.sort(function(a,b){return b.create_date.localeCompare(a.create_date);});setVacancies(sort);case 9:case\"end\":return _context.stop();}}},_callee);}));return function VacanciesView(){return _ref.apply(this,arguments);};}();VacanciesView();},[]);var handleClick=function handleClick(name,grade){setSelectedVacanciesName(name);setInputValue(name);// Установка начального значения для name\nsetSelectedVacanciesGrade(grade);setInputValueGrade(grade);// Установка начального значения для grade\nsetModalVacations(true);};// Обработчик изменения значения для поля ввода с именем\nvar handleNameInputChange=function handleNameInputChange(e){setInputValue(e.target.value);};// Обработчик изменения значения для поля ввода с grade\nvar handleGradeInputChange=function handleGradeInputChange(e){setInputValueGrade(e.target.value);};var reset=function reset(){searchRef.current.value='';setSearchValue('');setStartDate('');setEndDate('');};var handleStartDateChange=function handleStartDateChange(e){setStartDate(e.target.value);};var handleEndDateChange=function handleEndDateChange(e){setEndDate(e.target.value);};var handleCombinedFilter=function handleCombinedFilter(){if(searchValue.length===0&&!startDate&&!endDate){// Если нет поискового запроса и не выбраны даты, просто отобразите сообщение об ошибке или что-то подобное\nsetFilteredData([]);setFind([]);setIsOpen(true);return;}if(searchValue.length!==0){// Если есть поисковой запрос, выполняем фильтрацию по нему\nsetFind(vacancies.filter(function(vac){return vac.name.toLowerCase().includes(searchValue.toLowerCase());}));setFilteredData([]);setIsOpen(false);}else{// Если нет поискового запроса, выполняем фильтрацию по дате\nsetFilteredData(vacancies.filter(function(item){var itemDate=new Date(item.create_date);var start=startDate?new Date(startDate):null;var end=endDate?new Date(endDate):null;return(!start||itemDate>=start)&&(!end||itemDate<=end);}));setFind([]);setIsOpen(false);}};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"Vacations\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"VacationsContainerTop\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\u0412\\u0430\\u043A\\u0430\\u043D\\u0441\\u0438\\u0438\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"div\",{className:\"VacationsMain\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"inputsContainer\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"search\",placeholder:\"\\u041D\\u0430\\u0438\\u043C\\u0435\\u043D\\u043E\\u0432\\u0430\\u043D\\u0438\\u0435 \\u0432\\u0430\\u043A\\u0430\\u043D\\u0441\\u0438\\u0438\",className:\"ModalInput\",style:{'marginRight':'10px'},onChange:function onChange(e){return setSearchValue(e.target.value);},ref:searchRef}),/*#__PURE__*/_jsx(\"select\",{ref:department,className:\"depsView\",children:deps.map(function(dep,name){return/*#__PURE__*/_jsx(\"option\",{selected:dep.id===departId.departId,value:dep.id,children:dep.department_name},name);})})]})}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"input\",{type:\"date\",placeholder:\"\\u0412\\u044B\\u0431\\u0435\\u0440\\u0438\\u0442\\u0435 \\u0434\\u0430\\u0442\\u0443\",className:\"ModalInput\",style:{'marginRight':'10px'},value:startDate,onChange:handleStartDateChange}),\"\\u2014   \",/*#__PURE__*/_jsx(\"input\",{type:\"date\",placeholder:\"\\u0412\\u044B\\u0431\\u0435\\u0440\\u0438\\u0442\\u0435 \\u0434\\u0430\\u0442\\u0443\",className:\"ModalInput\",style:{'marginRight':'10px'},value:endDate,onChange:handleEndDateChange}),/*#__PURE__*/_jsx(\"button\",{className:\"filterButton\",onClick:handleCombinedFilter,children:\"\\u041F\\u043E\\u0438\\u0441\\u043A\"}),/*#__PURE__*/_jsx(\"button\",{className:\"filterButton\",onClick:reset,children:\"\\u0421\\u0431\\u0440\\u043E\\u0441\\u0438\\u0442\\u044C\"})]})]}),isOpen?currentlyPosts.map(function(vac,id){return/*#__PURE__*/_jsx(\"div\",{className:\"VacationsContainer\",onClick:function onClick(){return handleClick(vac.name,vac.grade);},children:/*#__PURE__*/_jsx(VacanciesItem,{vac:vac})},id);}):/*#__PURE__*/_jsx(\"div\",{children:currentlySearch.map(function(vac,id){return/*#__PURE__*/_jsx(\"div\",{className:\"VacationsContainer\",onClick:function onClick(){return handleClick(vac.name,vac.grade);},children:/*#__PURE__*/_jsx(VacanciesItem,{vac:vac})},id);})}),filteredData.map(function(vac){return/*#__PURE__*/_jsx(\"div\",{className:\"VacationsContainer\",onClick:function onClick(){return handleClick(vac.name,vac.grade);},children:/*#__PURE__*/_jsx(VacanciesItem,{vac:vac})},vac.id);})]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"div\",{style:{textAlign:'center'},children:isOpen?/*#__PURE__*/_jsx(Pagination,{postsPerPage:postsPerPage,totalPosts:vacancies.length,paginate:paginate,currentPage:currentPage}):/*#__PURE__*/_jsx(Pagination,{postsPerPage:postsPerPageVacancies,totalPosts:find.length,paginate:paginateVacancies,currentPage:currentPageVacancies})}),/*#__PURE__*/_jsxs(ModalVacancies,{active:modalVacations,setActive:setModalVacations,children:[/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"input\",{className:\"ModalInputVacancies\",value:inputValue,onChange:handleNameInputChange})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"input\",{className:\"ModalInputVacancies\",value:inputValueGrade,onChange:handleGradeInputChange})}),/*#__PURE__*/_jsx(\"button\",{className:\"ModalButton\",type:\"submit\",children:\"\\u0421\\u043E\\u0445\\u0440\\u0430\\u043D\\u0438\\u0442\\u044C\"})]}),/*#__PURE__*/_jsx(\"div\",{})]});}export default VacanciesView;","map":{"version":3,"sources":["D:/time_app/client/src/components/VacanciesView/VacanciesView.jsx"],"names":["React","useEffect","useRef","useState","Pagination","ModalVacancies","axios","VacanciesItem","VacanciesView","departId","modalVacations","setModalVacations","inputValue","setInputValue","inputValueGrade","setInputValueGrade","selectedVacanciesName","setSelectedVacanciesName","selectedVacanciesGrade","setSelectedVacanciesGrade","deps","setDeps","searchValue","setSearchValue","isOpen","setIsOpen","currentPage","setCurrentPage","postsPerPage","currentPageVacancies","setCurrentPageVacancies","postsPerPageVacancies","vacancies","setVacancies","find","setFind","lastPostIndex","firstPostIndex","currentlyPosts","slice","lastPostIndexVacancies","firstPostIndexVacancies","currentlySearch","paginate","pageNumber","paginateVacancies","pageNumberVacancies","department","searchRef","startDate","setStartDate","endDate","setEndDate","filteredData","setFilteredData","get","res","data","getVacancies","sort","a","b","create_date","localeCompare","handleClick","name","grade","handleNameInputChange","e","target","value","handleGradeInputChange","reset","current","handleStartDateChange","handleEndDateChange","handleCombinedFilter","length","filter","vac","toLowerCase","includes","item","itemDate","Date","start","end","map","dep","id","department_name","textAlign"],"mappings":"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","sourcesContent":["import React, {useEffect, useRef, useState} from 'react'\r\nimport Pagination from \"../Pagination/Pagination\";\r\nimport ModalVacancies from \"../Templates/ModalVacancies/ModalVacancies\"\r\nimport axios from \"axios\";\r\nimport './VacanciesView.css'\r\nimport VacanciesItem from \"../VacanciesItem/VacanciesItem\";\r\n\r\n\r\n\r\nfunction VacanciesView(departId) {\r\n    const [modalVacations, setModalVacations] = useState(false)\r\n    const [inputValue, setInputValue] = useState(\"\")\r\n    const [inputValueGrade, setInputValueGrade] = useState(\"\")\r\n\r\n\r\n    const [selectedVacanciesName, setSelectedVacanciesName] = useState('');\r\n    const [selectedVacanciesGrade, setSelectedVacanciesGrade] = useState('');\r\n\r\n\r\n    const [deps, setDeps] = useState([])\r\n\r\n    const [searchValue, setSearchValue] = useState(\"\")\r\n    const [isOpen, setIsOpen] = useState(true)\r\n\r\n    const [currentPage, setCurrentPage] = useState(1)\r\n    const [postsPerPage] = useState(5)\r\n\r\n    const [currentPageVacancies, setCurrentPageVacancies] = useState(1)\r\n    const [postsPerPageVacancies] = useState(5)\r\n\r\n    const [vacancies, setVacancies] = useState([])\r\n    const [find, setFind] = useState([])\r\n\r\n    const lastPostIndex = currentPage * postsPerPage\r\n    const firstPostIndex = lastPostIndex - postsPerPage\r\n    const currentlyPosts = vacancies.slice(firstPostIndex, lastPostIndex)\r\n\r\n    const lastPostIndexVacancies = currentPageVacancies * postsPerPageVacancies\r\n    const firstPostIndexVacancies = lastPostIndexVacancies - postsPerPageVacancies\r\n    const currentlySearch = find.slice(firstPostIndexVacancies, lastPostIndexVacancies)\r\n\r\n    const paginate = pageNumber => setCurrentPage(pageNumber)\r\n    const paginateVacancies = pageNumberVacancies => setCurrentPageVacancies(pageNumberVacancies)\r\n\r\n\r\n    const department = useRef()\r\n    const searchRef = useRef()\r\n\r\n\r\n\r\n    const [startDate, setStartDate] = useState(''); // начальная дата фильтра\r\n    const [endDate, setEndDate] = useState(''); // конечная дата фильтра\r\n\r\n\r\n    const [filteredData, setFilteredData] = useState([]);\r\n\r\n    useEffect(() => {\r\n        const VacanciesView = async () => {\r\n            const res = await axios.get('/api/departments/')\r\n            setDeps(res.data)\r\n            const getVacancies = await axios.get('/api/Vacations/')\r\n            const sort = getVacancies.data.sort((a, b) => b.create_date.localeCompare(a.create_date))\r\n            setVacancies(sort)\r\n        }\r\n\r\n        VacanciesView()\r\n    }, [])\r\n\r\n\r\n    const handleClick = (name, grade) => {\r\n        setSelectedVacanciesName(name);\r\n        setInputValue(name); // Установка начального значения для name\r\n        setSelectedVacanciesGrade(grade);\r\n        setInputValueGrade(grade); // Установка начального значения для grade\r\n        setModalVacations(true);\r\n    };\r\n\r\n    // Обработчик изменения значения для поля ввода с именем\r\n    const handleNameInputChange = (e) => {\r\n        setInputValue(e.target.value);\r\n    }\r\n\r\n    // Обработчик изменения значения для поля ввода с grade\r\n    const handleGradeInputChange = (e) => {\r\n        setInputValueGrade(e.target.value);\r\n    }\r\n\r\n\r\n    const reset = () => {\r\n        searchRef.current.value = ''\r\n        setSearchValue('')\r\n        setStartDate('')\r\n        setEndDate('')\r\n    }\r\n\r\n\r\n    const handleStartDateChange = (e) => {\r\n        setStartDate(e.target.value)\r\n    };\r\n\r\n    const handleEndDateChange = (e) => {\r\n        setEndDate(e.target.value)\r\n    }\r\n\r\n\r\n\r\n    const handleCombinedFilter = () => {\r\n        if (searchValue.length === 0 && !startDate && !endDate) {\r\n            // Если нет поискового запроса и не выбраны даты, просто отобразите сообщение об ошибке или что-то подобное\r\n            setFilteredData([]);\r\n            setFind([]);\r\n            setIsOpen(true)\r\n            return\r\n        }\r\n\r\n        if (searchValue.length !== 0) {\r\n            // Если есть поисковой запрос, выполняем фильтрацию по нему\r\n            setFind(vacancies.filter(vac => {\r\n                return vac.name.toLowerCase().includes(searchValue.toLowerCase());\r\n            }));\r\n            setFilteredData([]);\r\n            setIsOpen(false);\r\n        } else {\r\n            // Если нет поискового запроса, выполняем фильтрацию по дате\r\n            setFilteredData(vacancies.filter(item => {\r\n                const itemDate = new Date(item.create_date);\r\n                const start = startDate ? new Date(startDate) : null;\r\n                const end = endDate ? new Date(endDate) : null;\r\n                return (!start || itemDate >= start) && (!end || itemDate <= end);\r\n            }));\r\n            setFind([]);\r\n            setIsOpen(false);\r\n        }\r\n    };\r\n\r\n\r\n    return (\r\n        <>\r\n            <div className='Vacations'>\r\n                <div className=\"VacationsContainerTop\">\r\n                    <h2>Вакансии</h2>\r\n                    <br/>\r\n                    <div className=\"VacationsMain\">\r\n                        <div className=\"inputsContainer\">\r\n                            <input\r\n                                type='search'\r\n                                placeholder=\"Наименование вакансии\"\r\n                                className=\"ModalInput\"\r\n                                style={{'marginRight': '10px'}}\r\n                                onChange={(e) => setSearchValue(e.target.value)}\r\n                                ref={searchRef}\r\n                            />\r\n                            <select ref={department} className='depsView'>\r\n                                {deps.map((dep, name) => <option selected={dep.id === departId.departId} key={name} value={dep.id}>{dep.department_name}</option>)}\r\n                            </select>\r\n                        </div>\r\n\r\n                    </div>\r\n                        <br/>\r\n                    <div>\r\n                        <input\r\n                            type='date'\r\n                            placeholder=\"Выберите дату\"\r\n                            className=\"ModalInput\"\r\n                            style={{'marginRight': '10px'}}\r\n                            value={startDate} onChange={handleStartDateChange}\r\n                        />—   <input\r\n                        type='date'\r\n                        placeholder=\"Выберите дату\"\r\n                        className=\"ModalInput\"\r\n                        style={{'marginRight': '10px'}}\r\n                        value={endDate} onChange={handleEndDateChange}\r\n                    />\r\n                            <button className=\"filterButton\" onClick={handleCombinedFilter}>Поиск</button>\r\n                            <button className=\"filterButton\" onClick={reset}>Сбросить</button>\r\n                    </div>\r\n\r\n                </div>\r\n                {isOpen ? (\r\n                    currentlyPosts.map((vac, id) => (\r\n                        <div className='VacationsContainer' key={id} onClick={() => handleClick(vac.name, vac.grade)}>\r\n                            <VacanciesItem vac={vac}/>\r\n                        </div>\r\n                    ))\r\n                ) : (\r\n                    <div>\r\n                        {currentlySearch.map((vac, id) => (\r\n                            <div className='VacationsContainer' key={id}\r\n                                 onClick={() => handleClick(vac.name, vac.grade)}>\r\n                                <VacanciesItem vac={vac}/>\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n                )}\r\n                {filteredData.map(vac => (\r\n                    <div className='VacationsContainer' key={vac.id}\r\n                         onClick={() => handleClick(vac.name, vac.grade)}>\r\n                        <VacanciesItem vac={vac}/>\r\n                    </div>\r\n                    ))}\r\n            </div>\r\n            <br/>\r\n                <div style={{textAlign:'center'}}>\r\n                {isOpen ?\r\n                    <Pagination postsPerPage={postsPerPage} totalPosts={vacancies.length} paginate={paginate}\r\n                                currentPage={currentPage}/>\r\n                    :\r\n\r\n                    <Pagination postsPerPage={postsPerPageVacancies} totalPosts={find.length}\r\n                                paginate={paginateVacancies}\r\n                                currentPage={currentPageVacancies}/>}\r\n                </div>\r\n\r\n\r\n            <ModalVacancies active={modalVacations} setActive={setModalVacations}>\r\n                <hr/>\r\n                <div>\r\n                    <input className=\"ModalInputVacancies\"\r\n                           value={inputValue}\r\n                           onChange={handleNameInputChange}\r\n                    />\r\n                </div>\r\n                <div>\r\n                    <input className=\"ModalInputVacancies\"\r\n                           value={inputValueGrade}\r\n                           onChange={handleGradeInputChange}\r\n                    />\r\n                </div>\r\n                <button className=\"ModalButton\" type=\"submit\">\r\n                    Сохранить\r\n                </button>\r\n            </ModalVacancies>\r\n            <div>\r\n            </div>\r\n\r\n        </>\r\n\r\n    )\r\n}\r\n\r\nexport default VacanciesView"]},"metadata":{},"sourceType":"module"}