{"ast":null,"code":"import _regeneratorRuntime from\"D:/time_app/client/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"D:/time_app/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"D:/time_app/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useRef,useState}from'react';import Modal from\"../../Templates/Modal/Modal\";import'./Skills.css';import axios from\"axios\";import{useParams}from\"react-router-dom\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Skills=function Skills(_ref){var modalActiveSkills=_ref.modalActiveSkills,setModalActiveSkills=_ref.setModalActiveSkills;var skill=useRef();var username=useParams();var localUser=JSON.parse(localStorage.getItem('user'));var _useState=useState(''),_useState2=_slicedToArray(_useState,2),searchTermSkills=_useState2[0],setSearchTermSkills=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),skillsAll=_useState4[0],setAllSkills=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),error=_useState6[0],setError=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),skillId=_useState8[0],setSkillId=_useState8[1];var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),userSkills=_useState10[0],setUserSkills=_useState10[1];var _useState11=useState([]),_useState12=_slicedToArray(_useState11,2),filteredSkills=_useState12[0],setFilteredSkills=_useState12[1];var _useState13=useState(null),_useState14=_slicedToArray(_useState13,2),selectedNumber=_useState14[0],setSelectedNumber=_useState14[1];var _useState15=useState(null),_useState16=_slicedToArray(_useState15,2),selectedNumber2=_useState16[0],setSelectedNumber2=_useState16[1];useEffect(function(){var getSkills=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res,userId,getAllSkills,getUserSkills;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get('/api/user/'+username.username);case 2:res=_context.sent;userId=res.data.id;_context.next=6;return axios.get('/api/Skills/');case 6:getAllSkills=_context.sent;if(getAllSkills.data[0]['get_all_skills_json']===null){setAllSkills([]);}else{setAllSkills(getAllSkills.data[0]['get_all_skills_json']);}_context.next=10;return axios.get('/api/Skills/'+userId);case 10:getUserSkills=_context.sent;if(getUserSkills.data[0]['get_user_skills_json']===null){setUserSkills([]);}else{setUserSkills(getUserSkills.data[0]['get_user_skills_json']);}case 12:case\"end\":return _context.stop();}}},_callee);}));return function getSkills(){return _ref2.apply(this,arguments);};}();getSkills();},[]);var handleClick=function handleClick(number1){setSelectedNumber(number1);console.log(\"You clicked number \".concat(number1));};var handleClick2=function handleClick2(number2){setSelectedNumber2(number2);console.log(\"You clicked number \".concat(number2));};var handleInputChangeSkills=function handleInputChangeSkills(e){var termCities=e.target.value;setSearchTermSkills(termCities);var filtered=skillsAll.filter(function(skill){return skill.name&&skill.name.toLowerCase().includes(termCities.toLowerCase());});if(termCities===''){setFilteredSkills([]);}else{setFilteredSkills(filtered);}};var handleSkillsClick=function handleSkillsClick(id,name){setFilteredSkills([]);setSkillId(id);setSearchTermSkills(name);};var ButtonAddSkills=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var addSkills,getSkills,res,userId,getUserSkills;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:setSelectedNumber(null);if(!(skillId.length===0)){_context2.next=5;break;}setError('Выберите умение');_context2.next=26;break;case 5:if(!(selectedNumber==null)){_context2.next=9;break;}setError('Укажите уровень от 1 до 5');_context2.next=26;break;case 9:if(!(skillId.length===0&&selectedNumber>0)){_context2.next=13;break;}setError('Выберите умение');_context2.next=26;break;case 13:addSkills={user_id:username.username,skill_id:skillId,self_grade:selectedNumber};if(skillId.length>0||selectedNumber!==null||skillId.length===0&&selectedNumber>0){setError('');}_context2.next=17;return axios.post('/api/Skills/',addSkills);case 17:getSkills=_context2.sent;_context2.next=20;return axios.get('/api/user/'+username.username);case 20:res=_context2.sent;userId=res.data.id;_context2.next=24;return axios.get('/api/Skills/'+userId);case 24:getUserSkills=_context2.sent;if(getUserSkills.data[0]['get_user_skills_json']===null){setUserSkills([]);}else{setUserSkills(getUserSkills.data[0]['get_user_skills_json']);}case 26:case\"end\":return _context2.stop();}}},_callee2);}));return function ButtonAddSkills(){return _ref3.apply(this,arguments);};}();var SkillDelete=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(e){var skill_id,not_active_skill,DeleteSkills,res,userId,getUserSkills;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:skill_id=e.target.value;not_active_skill={is_active:false,skill_id:skill_id};_context3.next=4;return axios.post('/api/Skills/',not_active_skill);case 4:DeleteSkills=_context3.sent;_context3.next=7;return axios.get('/api/user/'+username.username);case 7:res=_context3.sent;userId=res.data.id;_context3.next=11;return axios.get('/api/Skills/'+userId);case 11:getUserSkills=_context3.sent;if(getUserSkills.data[0]['get_user_skills_json']===null){setUserSkills([]);}else{setUserSkills(getUserSkills.data[0]['get_user_skills_json']);}case 13:case\"end\":return _context3.stop();}}},_callee3);}));return function SkillDelete(_x){return _ref4.apply(this,arguments);};}();var changeGrade=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(event,id){var _event$target,name,value,changeGrade;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_event$target=event.target,name=_event$target.name,value=_event$target.value;changeGrade={user_id:username.username,skill_id:id};if(name==='gradeSelf'&&value!==undefined){changeGrade.newGradeSelf=value;}else if(name==='gradeHead'&&value!==undefined){changeGrade.newGradeHead=value;}_context4.next=5;return axios.post('/api/Skills/',changeGrade);case 5:case\"end\":return _context4.stop();}}},_callee4);}));return function changeGrade(_x2,_x3){return _ref5.apply(this,arguments);};}();return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(Modal,{active:modalActiveSkills,setActive:setModalActiveSkills,children:[/*#__PURE__*/_jsx(\"h1\",{children:\"\\u041D\\u0430\\u0432\\u044B\\u043A\\u0438:\"}),/*#__PURE__*/_jsx(\"div\",{className:\"error\",children:error}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"div\",{className:\"modalError\"}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"label\",{style:{fontWeight:\"bold\"},children:\"\\u0412\\u044B\\u0431\\u0435\\u0440\\u0438\\u0442\\u0435 \\u0443\\u043C\\u0435\\u043D\\u0438\\u0435:\"})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"inputContainer\",children:[/*#__PURE__*/_jsx(\"input\",{placeholder:\"\\u041D\\u0430\\u0447\\u043D\\u0438\\u0442\\u0435 \\u0432\\u0432\\u043E\\u0434\\u0438\\u0442\\u044C \\u0443\\u043C\\u0435\\u043D\\u0438\\u0435\",ref:skill,className:\"registerInput\",value:searchTermSkills,onChange:handleInputChangeSkills}),/*#__PURE__*/_jsx(\"div\",{children:filteredSkills.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"dropdown\",children:filteredSkills.map(function(skill,id){return/*#__PURE__*/_jsx(\"div\",{className:\"selectNameDiv\",value:id,onClick:function onClick(){return handleSkillsClick(skill.id,skill.name);},children:skill.name},id);})})})]})})]}),/*#__PURE__*/_jsx(\"div\",{style:{width:'50px'}}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"label\",{style:{fontWeight:\"bold\"},children:\"\\u041E\\u0446\\u0435\\u043D\\u043A\\u0430 \\u0441\\u043E\\u0442\\u0440\\u0443\\u0434\\u043D\\u0438\\u043A\\u0430:\"})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"div\",{className:\"MainContainer\",children:[1,2,3,4,5].map(function(number1){return/*#__PURE__*/_jsx(\"div\",{className:\"WrapperContainer \".concat(selectedNumber===number1?'selected':''),onClick:function onClick(){return handleClick(number1);},children:number1},number1);})})})]})]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"button\",{className:\"ModalButton\",type:\"submit\",onClick:ButtonAddSkills,children:\"\\u0414\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C \\u0443\\u043C\\u0435\\u043D\\u0438\\u0435\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"div\",{className:\"divreserve\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"skills-table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{className:\"skills-header\",children:[/*#__PURE__*/_jsx(\"th\",{children:\"\\u041D\\u0430\\u0432\\u044B\\u043A\"}),/*#__PURE__*/_jsx(\"th\",{children:\"\\u041E\\u0446\\u0435\\u043D\\u043A\\u0430 \\u0441\\u043E\\u0442\\u0440\\u0443\\u0434\\u043D\\u0438\\u043A\\u0430\"}),/*#__PURE__*/_jsx(\"th\",{children:\"\\u041E\\u0446\\u0435\\u043D\\u043A\\u0430 \\u0440\\u0443\\u043A\\u043E\\u0432\\u043E\\u0434\\u0438\\u0442\\u0435\\u043B\\u044F\"}),/*#__PURE__*/_jsx(\"th\",{})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:userSkills.map(function(array,id){return/*#__PURE__*/_jsxs(\"tr\",{className:\"skill-item\",children:[/*#__PURE__*/_jsx(\"td\",{children:array.name}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"select\",{name:\"gradeSelf\",defaultValue:array.self_grade,onChange:function onChange(event){return changeGrade(event,array.id);},children:[1,2,3,4,5].map(function(number){return/*#__PURE__*/_jsx(\"option\",{value:number,children:number},number);})})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(\"select\",{name:\"gradeHead\",defaultValue:array.head_grade,disabled:!localUser.isAdmin,onChange:function onChange(event){return changeGrade(event,array.id);},children:[array.head_grade===null&&!localUser.isAdmin?/*#__PURE__*/_jsx(\"option\",{children:\"\\u041D\\u0435\\u0442 \\u043E\\u0446\\u0435\\u043D\\u043A\\u0438\"}):'',array.head_grade===null?/*#__PURE__*/_jsx(\"option\",{children:\"\\u041D\\u0435\\u0442 \\u043E\\u0446\\u0435\\u043D\\u043A\\u0438\"}):'',[1,2,3,4,5].map(function(number){return/*#__PURE__*/_jsx(\"option\",{value:number,children:number},number);})]})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"button\",{value:array.id,className:\"SkillButton\",onClick:SkillDelete,children:\"\\u0423\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C\"})})]},id);})})]})}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{})]})});};export default Skills;","map":{"version":3,"sources":["D:/time_app/client/src/components/ProfileInfo/Skills/Skills.jsx"],"names":["React","useEffect","useRef","useState","Modal","axios","useParams","Skills","modalActiveSkills","setModalActiveSkills","skill","username","localUser","JSON","parse","localStorage","getItem","searchTermSkills","setSearchTermSkills","skillsAll","setAllSkills","error","setError","skillId","setSkillId","userSkills","setUserSkills","filteredSkills","setFilteredSkills","selectedNumber","setSelectedNumber","selectedNumber2","setSelectedNumber2","getSkills","get","res","userId","data","id","getAllSkills","getUserSkills","handleClick","number1","console","log","handleClick2","number2","handleInputChangeSkills","e","termCities","target","value","filtered","filter","name","toLowerCase","includes","handleSkillsClick","ButtonAddSkills","length","addSkills","user_id","skill_id","self_grade","post","SkillDelete","not_active_skill","is_active","DeleteSkills","changeGrade","event","undefined","newGradeSelf","newGradeHead","fontWeight","map","width","array","number","head_grade","isAdmin"],"mappings":"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","sourcesContent":["import React, {useEffect, useRef, useState} from 'react';\r\nimport Modal from \"../../Templates/Modal/Modal\";\r\nimport './Skills.css'\r\nimport axios from \"axios\";\r\nimport {useParams} from \"react-router-dom\";\r\n\r\nconst Skills = ({ modalActiveSkills, setModalActiveSkills}) => {\r\n\r\n    const skill = useRef()\r\n    const username = useParams()\r\n    const localUser = JSON.parse(localStorage.getItem('user'))\r\n    const [searchTermSkills, setSearchTermSkills] = useState('');\r\n    const [skillsAll, setAllSkills] = useState([])\r\n    const [error, setError] = useState('')\r\n    const [skillId, setSkillId] = useState([])\r\n    const [userSkills, setUserSkills] = useState([])\r\n    const [filteredSkills, setFilteredSkills] = useState([]);\r\n    const [selectedNumber, setSelectedNumber] = useState(null);\r\n    const [selectedNumber2, setSelectedNumber2] = useState(null);\r\n\r\n\r\n    useEffect(() => {\r\n        const getSkills = async () => {\r\n            const res = await axios.get('/api/user/' + username.username)\r\n            const userId=res.data.id\r\n\r\n\r\n            const getAllSkills = await axios.get('/api/Skills/')\r\n\r\n            if(getAllSkills.data[0]['get_all_skills_json']===null){\r\n                setAllSkills([])\r\n            }else {\r\n                setAllSkills(getAllSkills.data[0]['get_all_skills_json'])\r\n            }\r\n\r\n            const getUserSkills = await axios.get('/api/Skills/'+userId)\r\n\r\n            if(getUserSkills.data[0]['get_user_skills_json']===null){\r\n                setUserSkills([])\r\n            }else {\r\n                setUserSkills(getUserSkills.data[0]['get_user_skills_json'])\r\n\r\n            }\r\n\r\n        }\r\n        getSkills()\r\n    }, [])\r\n\r\n\r\n\r\n    const handleClick = (number1) => {\r\n            setSelectedNumber(number1)\r\n        console.log(`You clicked number ${number1}`);\r\n    };\r\n    const handleClick2 = (number2) => {\r\n        setSelectedNumber2(number2)\r\n        console.log(`You clicked number ${number2}`);\r\n    };\r\n\r\n\r\n    const handleInputChangeSkills = (e) => {\r\n        const termCities = e.target.value;\r\n        setSearchTermSkills(termCities);\r\n        const filtered = skillsAll.filter(skill =>\r\n            skill.name && skill.name.toLowerCase().includes(termCities.toLowerCase())\r\n        );\r\n        if (termCities === '') {\r\n            setFilteredSkills([])\r\n        } else {\r\n            setFilteredSkills(filtered);\r\n        }\r\n    }\r\n\r\n\r\n    const handleSkillsClick = (id,name) => {\r\n        setFilteredSkills([])\r\n        setSkillId(id)\r\n        setSearchTermSkills(name)\r\n    }\r\n\r\n    const ButtonAddSkills = async () => {\r\n        setSelectedNumber(null)\r\n\r\n        if (skillId.length === 0) {\r\n            setError('Выберите умение')\r\n        } else if (selectedNumber == null) {\r\n            setError('Укажите уровень от 1 до 5')\r\n        } else if (skillId.length === 0 && selectedNumber > 0) {\r\n            setError('Выберите умение')\r\n        } else {\r\n\r\n            const addSkills = {\r\n                user_id: username.username,\r\n                skill_id: skillId,\r\n                self_grade: selectedNumber\r\n            }\r\n\r\n            if(skillId.length>0 || selectedNumber !== null || skillId.length === 0 && selectedNumber > 0 )\r\n            {\r\n                setError('')\r\n            }\r\n            const getSkills = await axios.post('/api/Skills/', addSkills)\r\n\r\n            const res = await axios.get('/api/user/' + username.username)\r\n            const userId = res.data.id\r\n            const getUserSkills = await axios.get('/api/Skills/' + userId)\r\n\r\n            if (getUserSkills.data[0]['get_user_skills_json'] === null) {\r\n                setUserSkills([])\r\n            } else {\r\n                setUserSkills(getUserSkills.data[0]['get_user_skills_json'])\r\n            }\r\n        }\r\n    }\r\n\r\n    const SkillDelete= async (e) => {\r\n        const skill_id=e.target.value\r\n        const not_active_skill = {\r\n            is_active:false,\r\n            skill_id:skill_id\r\n        }\r\n        const DeleteSkills = await axios.post('/api/Skills/',not_active_skill)\r\n        const res = await axios.get('/api/user/' + username.username)\r\n        const userId = res.data.id\r\n        const getUserSkills = await axios.get('/api/Skills/' + userId)\r\n\r\n        if (getUserSkills.data[0]['get_user_skills_json'] === null) {\r\n            setUserSkills([])\r\n        } else {\r\n            setUserSkills(getUserSkills.data[0]['get_user_skills_json'])\r\n        }\r\n    }\r\n\r\n    const changeGrade = async (event, id) => {\r\n        const { name, value } = event.target;\r\n        const changeGrade = {\r\n            user_id: username.username,\r\n            skill_id: id\r\n        }\r\n        if (name === 'gradeSelf' && value !== undefined) {\r\n            changeGrade.newGradeSelf = value;\r\n        } else if (name === 'gradeHead' && value !== undefined) {\r\n            changeGrade.newGradeHead = value;\r\n        }\r\n        await axios.post('/api/Skills/', changeGrade);\r\n    }\r\n\r\n\r\n\r\n\r\n    return (\r\n\r\n        <div>\r\n            <Modal active={modalActiveSkills} setActive={setModalActiveSkills}>\r\n                <h1>Навыки:</h1>\r\n                <div className='error'>{error}</div>\r\n                <br/>\r\n\r\n                <div className='modalError'>\r\n\r\n                </div>\r\n\r\n                <hr/>\r\n                <br/>\r\n                <div className='flex'>\r\n                    <div>\r\n                        <div>\r\n                            <label style={{fontWeight: \"bold\"}}>Выберите умение:</label>\r\n                        </div>\r\n                        <div>\r\n                            <div className=\"inputContainer\">\r\n                            <input\r\n                                placeholder=\"Начните вводить умение\"\r\n                                ref={skill}\r\n                                className=\"registerInput\"\r\n                                value={searchTermSkills}\r\n                                onChange={handleInputChangeSkills}\r\n                            />\r\n                            <div>\r\n                                {filteredSkills.length > 0 && (\r\n                                    <div className=\"dropdown\">\r\n                                        {filteredSkills.map((skill, id) => (\r\n                                            <div className='selectNameDiv' key={id} value={id} onClick={() => handleSkillsClick(skill.id,skill.name)}>\r\n                                                {skill.name}\r\n                                            </div>\r\n                                        ))}\r\n                                    </div>\r\n                                )}\r\n                            </div>\r\n                            </div>\r\n\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div style={{width: '50px'}}></div>\r\n\r\n                    <div>\r\n                        <div>\r\n                            <label style={{fontWeight: \"bold\"}}>Оценка сотрудника:</label>\r\n                        </div>\r\n                        <div>\r\n                            <div className='MainContainer'>\r\n                                {[1, 2, 3, 4, 5].map((number1) => (\r\n                                    <div className={`WrapperContainer ${selectedNumber === number1 ? 'selected' : ''}`}\r\n                                        key={number1}\r\n                                        onClick={() => handleClick(number1)}\r\n                                    >\r\n                                        {number1}\r\n                                    </div>\r\n                                ))}\r\n                            </div>\r\n                        </div>\r\n\r\n                    </div>\r\n{/*                    <div style={{width: '50px'}}></div>\r\n                    <div>\r\n                        <div>\r\n                            <label style={{fontWeight: \"bold\"}}>Оценка руководителя:</label>\r\n                        </div>\r\n                        <div>\r\n                            <div className='MainContainer'>\r\n                                {[1, 2, 3, 4, 5].map((number2) => (\r\n                                    <div className={`WrapperContainer ${selectedNumber2 === number2 ? 'selected' : ''}`}\r\n                                         key={number2}\r\n                                         onClick={() => handleClick2(number2)}\r\n                                    >\r\n                                        {number2}\r\n                                    </div>\r\n                                ))}\r\n                            </div>\r\n                        </div>\r\n\r\n                    </div>*/}\r\n\r\n                </div>\r\n                <br/>\r\n                <button className=\"ModalButton\" type=\"submit\" onClick={ButtonAddSkills}>\r\n                    Добавить умение\r\n                </button>\r\n                <br/>\r\n                <br/>\r\n                <div className='divreserve'>\r\n                    <table className=\"skills-table\">\r\n                        <thead>\r\n                        <tr className=\"skills-header\">\r\n                            <th>Навык</th>\r\n                            <th>Оценка сотрудника</th>\r\n                            <th>Оценка руководителя</th>\r\n                            <th></th>\r\n\r\n                        </tr>\r\n                        </thead>\r\n                        <tbody>\r\n                        {userSkills.map((array, id) => (\r\n                            <tr className=\"skill-item\" key={id}>\r\n                                <td>\r\n                                    {array.name}\r\n                                </td>\r\n                                <td>\r\n\r\n                                    <select\r\n                                        name='gradeSelf'\r\n                                        defaultValue={array.self_grade}\r\n                                        onChange={(event) => changeGrade(event, array.id)}\r\n                                    >\r\n                                        {[1, 2, 3, 4, 5].map(number => (\r\n                                            <option key={number} value={number}>{number}</option>\r\n                                        ))}\r\n                                    </select>\r\n                               </td>\r\n                                <td>\r\n                                    <select\r\n                                    name='gradeHead'\r\n                                    defaultValue={array.head_grade}\r\n                                    disabled={!localUser.isAdmin}\r\n                                    onChange={(event) => changeGrade(event, array.id)}\r\n                                >\r\n                                    {array.head_grade === null && !localUser.isAdmin ? <option>Нет оценки</option> : ''}\r\n                                    {array.head_grade === null ? <option>Нет оценки</option> : ''}\r\n                                    {[1, 2, 3, 4, 5].map(number => (\r\n                                        <option key={number} value={number}>{number}</option>\r\n                                    ))}\r\n                                </select>\r\n                                </td>\r\n                                <td><button value={array.id} className='SkillButton' onClick={SkillDelete}>Удалить</button></td>\r\n                            </tr>\r\n                        ))}\r\n                        </tbody>\r\n                    </table>\r\n                </div>\r\n                <br/>\r\n                <br/>\r\n                <br/><br/>\r\n            </Modal>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Skills;"]},"metadata":{},"sourceType":"module"}