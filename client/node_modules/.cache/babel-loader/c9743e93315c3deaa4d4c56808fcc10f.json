{"ast":null,"code":"import _regeneratorRuntime from\"D:/time_app/client/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"D:/time_app/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"D:/time_app/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import\"./VcanciesItem.css\";import moment from\"moment\";import React,{useRef,useState}from\"react\";import ModalVacancies from\"../Templates/ModalVacancies/ModalVacancies\";import axios from\"axios\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var VacanciesItem=function VacanciesItem(_ref){var department=_ref.department,vacancies=_ref.vacancies,status=_ref.status,users=_ref.users;console.log('vac=',vacancies);var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),message=_useState2[0],setMessage=_useState2[1];var localUser=JSON.parse(localStorage.getItem('user'));var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),vacanciesId=_useState4[0],setVacanciesId=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),modalVacations=_useState6[0],setModalVacations=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),inputValue=_useState8[0],setInputValue=_useState8[1];var _useState9=useState(\"\"),_useState10=_slicedToArray(_useState9,2),old_user=_useState10[0],setOld_user=_useState10[1];var _useState11=useState(\"\"),_useState12=_slicedToArray(_useState11,2),inputValueDescription=_useState12[0],setInputValueDescription=_useState12[1];var _useState13=useState(\"\"),_useState14=_slicedToArray(_useState13,2),inputValueStatuses=_useState14[0],setInputValueStatuses=_useState14[1];var _useState15=useState(\"\"),_useState16=_slicedToArray(_useState15,2),inputValueGrade=_useState16[0],setInputValueGrade=_useState16[1];var _useState17=useState(''),_useState18=_slicedToArray(_useState17,2),user_name=_useState18[0],setUser_name=_useState18[1];var _useState19=useState(''),_useState20=_slicedToArray(_useState19,2),selectedVacanciesName=_useState20[0],setSelectedVacanciesName=_useState20[1];var _useState21=useState(''),_useState22=_slicedToArray(_useState21,2),selectedVacanciesStatuses=_useState22[0],setSelectedVacanciesStatuses=_useState22[1];var _useState23=useState(''),_useState24=_slicedToArray(_useState23,2),selectedVacanciesDescription=_useState24[0],setSelectedVacanciesDescription=_useState24[1];var _useState25=useState(''),_useState26=_slicedToArray(_useState25,2),selectedVacanciesGrade=_useState26[0],setSelectedVacanciesGrade=_useState26[1];var statusRef=useRef();var searchRef=useRef();var _useState27=useState(''),_useState28=_slicedToArray(_useState27,2),startDate=_useState28[0],setStartDate=_useState28[1];// начальная дата фильтра\nvar _useState29=useState(''),_useState30=_slicedToArray(_useState29,2),endDate=_useState30[0],setEndDate=_useState30[1];// конечная дата фильтра\nvar handleNameInputChange=function handleNameInputChange(e){setInputValue(e.target.value);};// Обработчик изменения значения для поля ввода с grade\nvar handleDescriptionInputChange=function handleDescriptionInputChange(e){setInputValueDescription(e.target.value);};var handleGradeInputChange=function handleGradeInputChange(e){setInputValueGrade(e.target.value);};var selectValue=function selectValue(){setInputValueStatuses(statusRef.current.value);};var ChangeData=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var ChangeData,res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:ChangeData={namevacanciesId:vacanciesId,namevacancies:inputValue,description:inputValueDescription,Statuses:inputValueStatuses,grade:inputValueGrade,statuses:statusRef.current.value,users:userId,old_user:old_user};_context.next=3;return axios.put('/api/Vacations/',ChangeData);case 3:res=_context.sent;setMessage('Добавленно');case 5:case\"end\":return _context.stop();}}},_callee);}));return function ChangeData(){return _ref2.apply(this,arguments);};}();var date=moment().format('YYYY-MM-DD');var _useState31=useState(''),_useState32=_slicedToArray(_useState31,2),searchTerm=_useState32[0],setSearchTerm=_useState32[1];var _useState33=useState([]),_useState34=_slicedToArray(_useState33,2),userId=_useState34[0],setUserId=_useState34[1];var _useState35=useState([]),_useState36=_slicedToArray(_useState35,2),filteredUsers=_useState36[0],setFilteredUsers=_useState36[1];var handleInputChange=function handleInputChange(e){var term=e.target.value;setSearchTerm(term);var filtered=users.filter(function(user){return user.user_name&&user.user_name.toLowerCase().includes(term.toLowerCase());});if(term===''){setUser_name('');}else{setFilteredUsers(filtered);// всегда устанавливаем filteredUsers\n}};var handleClick=function handleClick(name,grade,id,description,status_id,user_name,user_id){if(localUser.isAdmin===true){console.log('name=',user_name);if(user_name===null){setUser_name([]);}else{setUser_name(user_name);}setFilteredUsers([]);setMessage([]);setModalVacations(true);setVacanciesId(id);setSelectedVacanciesName(name);setInputValue(name);// Установка начального значения для name\nsetSelectedVacanciesDescription(description);setInputValueDescription(description);setSelectedVacanciesGrade(grade);setInputValueGrade(grade);// Установка начального значения для grade\nsetSelectedVacanciesStatuses(status_id);setInputValueStatuses(status_id);setOld_user(user_id);}};var handleUserClick=function handleUserClick(userName,userId){console.log('user=',userId);setUserId(userId);setSearchTerm(userName);setFilteredUsers([]);};var getColorByStatusId=function getColorByStatusId(statusId){switch(statusId){case 1:return'Reserve';// Установите зеленый цвет для статуса 1\ncase 2:return'Selection';// Установите желтый цвет для статуса 2\ncase 3:return'Securely';// Установите оранжевый цвет для статуса 3\ncase 4:return'Liquidated';// Установите красный цвет для статуса 4\ncase 5:return'Finalist';// Установите красный цвет для статуса 4\n}};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"label\",{className:\"departmentName\",children:department}),/*#__PURE__*/_jsxs(\"div\",{className:\"vacancies-container\",children:[vacancies.map(function(vac){return/*#__PURE__*/_jsx(\"div\",{className:\"angry-grid1\"+getColorByStatusId(vac.status_id),onClick:function onClick(){return handleClick(vac.name,vac.grade,vac.id,vac.description,vac.status_id,vac.user_name,vac.user_id);},children:/*#__PURE__*/_jsxs(\"div\",{id:\"cssportal-grid\",children:[/*#__PURE__*/_jsxs(\"div\",{id:\"div1\",children:[vac.user_name?vac.user_name+'('+vac.vacancy_code+')':vac.vacancy_code,/*#__PURE__*/_jsx(\"label\",{className:\"New\",children:date===vac.create_date?'NEW':''})]}),/*#__PURE__*/_jsxs(\"div\",{id:\"div2\",children:[\"\\u0413\\u0440\\u0435\\u0439\\u0434: \",vac.grade]}),/*#__PURE__*/_jsx(\"div\",{id:\"div3\",children:vac.status_name}),/*#__PURE__*/_jsxs(\"div\",{id:\"div4\",children:[\"\\u041F\\u0440\\u043E\\u0435\\u043A\\u0442: \",vac.project_id]}),/*#__PURE__*/_jsx(\"div\",{id:\"div5\",children:vac.company_name})]})},vac.id);}),/*#__PURE__*/_jsxs(ModalVacancies,{active:modalVacations,setActive:setModalVacations,children:[message,/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"ModalInputVacancies\",value:inputValue,onChange:handleNameInputChange})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"textarea\",{className:\"textDescription\",value:inputValueDescription,onChange:handleDescriptionInputChange})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\u0421\\u0442\\u0430\\u0442\\u0443\\u0441:\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"select\",{ref:statusRef,value:inputValueStatuses,onChange:selectValue,className:\"InputVacanciesItem\",children:status.map(function(status,name){return/*#__PURE__*/_jsx(\"option\",{value:status.id,children:status.name},name);})})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\u0413\\u0440\\u0435\\u0439\\u0434:\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:inputValueGrade,onChange:handleGradeInputChange,className:\"InputVacanciesItem\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\u0418\\u043C\\u044F \\u0441\\u043E\\u0442\\u0440\\u0443\\u0434\\u043D\\u0438\\u043A\\u0430\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"div\",{className:\"inputDiv\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"\\u0418\\u043C\\u044F \\u0441\\u043E\\u0442\\u0440\\u0443\\u0434\\u043D\\u0438\\u043A\\u0430\",value:searchTerm||user_name,onChange:handleInputChange,className:\"InputVacanciesItem\"}),filteredUsers.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"userListContainer\",children:filteredUsers.map(function(user,index){return/*#__PURE__*/_jsx(\"div\",{className:\"selectNameDiv\",value:user.id,onClick:function onClick(){return handleUserClick(user.user_name,user.id);},children:user.user_name},index);})})]})]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"div\",{className:\"divHistory\",children:\"\\u0418\\u0441\\u0442\\u043E\\u0440\\u0438\\u044F\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"button\",{className:\"ModalButton\",type:\"submit\",onClick:ChangeData,children:\"\\u0421\\u043E\\u0445\\u0440\\u0430\\u043D\\u0438\\u0442\\u044C\"})})]})]})]})]});};export default VacanciesItem;","map":{"version":3,"sources":["D:/time_app/client/src/components/VacanciesItem/VacanciesItem.jsx"],"names":["moment","React","useRef","useState","ModalVacancies","axios","VacanciesItem","department","vacancies","status","users","console","log","message","setMessage","localUser","JSON","parse","localStorage","getItem","vacanciesId","setVacanciesId","modalVacations","setModalVacations","inputValue","setInputValue","old_user","setOld_user","inputValueDescription","setInputValueDescription","inputValueStatuses","setInputValueStatuses","inputValueGrade","setInputValueGrade","user_name","setUser_name","selectedVacanciesName","setSelectedVacanciesName","selectedVacanciesStatuses","setSelectedVacanciesStatuses","selectedVacanciesDescription","setSelectedVacanciesDescription","selectedVacanciesGrade","setSelectedVacanciesGrade","statusRef","searchRef","startDate","setStartDate","endDate","setEndDate","handleNameInputChange","e","target","value","handleDescriptionInputChange","handleGradeInputChange","selectValue","current","ChangeData","namevacanciesId","namevacancies","description","Statuses","grade","statuses","userId","put","res","date","format","searchTerm","setSearchTerm","setUserId","filteredUsers","setFilteredUsers","handleInputChange","term","filtered","filter","user","toLowerCase","includes","handleClick","name","id","status_id","user_id","isAdmin","handleUserClick","userName","getColorByStatusId","statusId","map","vac","vacancy_code","create_date","status_name","project_id","company_name","length","index"],"mappings":"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","sourcesContent":["import \"./VcanciesItem.css\"\r\nimport moment from \"moment\";\r\nimport React, {useRef, useState} from \"react\";\r\nimport ModalVacancies from \"../Templates/ModalVacancies/ModalVacancies\";\r\nimport axios from \"axios\";\r\n\r\nconst VacanciesItem =({department,vacancies,status,users})=> {\r\n    console.log('vac=',vacancies)\r\n\r\n    const [message, setMessage] = useState(\"\")\r\n    const localUser = JSON.parse(localStorage.getItem('user'))\r\n\r\n    const [vacanciesId, setVacanciesId] = useState(\"\")\r\n    const [modalVacations, setModalVacations] = useState(false)\r\n\r\n    const [inputValue, setInputValue] = useState(\"\")\r\n    const [old_user, setOld_user] = useState(\"\")\r\n\r\n    const [inputValueDescription, setInputValueDescription] = useState(\"\")\r\n\r\n    const [inputValueStatuses, setInputValueStatuses] = useState(\"\")\r\n\r\n    const [inputValueGrade, setInputValueGrade] = useState(\"\")\r\n\r\n    const [user_name, setUser_name] = useState('')\r\n\r\n    const [selectedVacanciesName, setSelectedVacanciesName] = useState('');\r\n    const [selectedVacanciesStatuses, setSelectedVacanciesStatuses] = useState('');\r\n    const [selectedVacanciesDescription, setSelectedVacanciesDescription] = useState('');\r\n    const [selectedVacanciesGrade, setSelectedVacanciesGrade] = useState('');\r\n\r\n    const statusRef = useRef()\r\n\r\n    const searchRef = useRef()\r\n\r\n    const [startDate, setStartDate] = useState(''); // начальная дата фильтра\r\n    const [endDate, setEndDate] = useState(''); // конечная дата фильтра\r\n\r\n\r\n\r\n\r\n\r\n    const handleNameInputChange = (e) => {\r\n        setInputValue(e.target.value);\r\n    }\r\n\r\n    // Обработчик изменения значения для поля ввода с grade\r\n    const handleDescriptionInputChange = (e) => {\r\n        setInputValueDescription(e.target.value);\r\n    }\r\n\r\n    const handleGradeInputChange = (e) => {\r\n        setInputValueGrade(e.target.value);\r\n    }\r\n\r\n\r\n    const selectValue = () => {\r\n        setInputValueStatuses(statusRef.current.value)\r\n    }\r\n\r\n\r\n\r\n    const ChangeData = async () => {\r\n\r\n        const ChangeData ={\r\n            namevacanciesId:vacanciesId,\r\n            namevacancies:inputValue,\r\n            description:inputValueDescription,\r\n            Statuses:inputValueStatuses,\r\n            grade:inputValueGrade,\r\n            statuses:statusRef.current.value,\r\n            users:userId,\r\n            old_user:old_user\r\n        }\r\n\r\n        const res = await axios.put('/api/Vacations/', ChangeData)\r\n        setMessage('Добавленно')\r\n    }\r\n\r\n    const date = moment().format('YYYY-MM-DD');\r\n    const [searchTerm, setSearchTerm] = useState('');\r\n    const [userId, setUserId] = useState([])\r\n    const [filteredUsers, setFilteredUsers] = useState([]);\r\n\r\n\r\n\r\n\r\n    const handleInputChange = (e) => {\r\n        const term = e.target.value;\r\n        setSearchTerm(term);\r\n        const filtered = users.filter(user =>\r\n            user.user_name && user.user_name.toLowerCase().includes(term.toLowerCase())\r\n        );\r\n        if (term === '') {\r\n            setUser_name('')\r\n        } else {\r\n            setFilteredUsers(filtered); // всегда устанавливаем filteredUsers\r\n        }\r\n    }\r\n\r\n\r\n    const handleClick = (name, grade,id,description,status_id,user_name,user_id) => {\r\n        if(localUser.isAdmin===true) {\r\n\r\n            console.log('name=',user_name)\r\n            if(user_name===null){\r\n                setUser_name([])\r\n            }else {\r\n                setUser_name(user_name)\r\n            }\r\n\r\n            setFilteredUsers([])\r\n            setMessage([])\r\n            setModalVacations(true);\r\n            setVacanciesId(id)\r\n            setSelectedVacanciesName(name);\r\n            setInputValue(name); // Установка начального значения для name\r\n\r\n\r\n            setSelectedVacanciesDescription(description)\r\n            setInputValueDescription(description)\r\n\r\n            setSelectedVacanciesGrade(grade);\r\n            setInputValueGrade(grade); // Установка начального значения для grade\r\n\r\n            setSelectedVacanciesStatuses(status_id)\r\n            setInputValueStatuses(status_id)\r\n\r\n            setOld_user(user_id)\r\n\r\n\r\n        }\r\n\r\n    };\r\n\r\n    const handleUserClick = (userName,userId) => {\r\n        console.log('user=',userId)\r\n        setUserId(userId)\r\n        setSearchTerm(userName)\r\n        setFilteredUsers([])\r\n\r\n    }\r\n\r\n\r\n    const getColorByStatusId = (statusId) => {\r\n        switch (statusId) {\r\n            case 1:\r\n                return 'Reserve'; // Установите зеленый цвет для статуса 1\r\n            case 2:\r\n                return 'Selection'; // Установите желтый цвет для статуса 2\r\n            case 3:\r\n                return 'Securely'; // Установите оранжевый цвет для статуса 3\r\n            case 4:\r\n                return 'Liquidated'; // Установите красный цвет для статуса 4\r\n            case 5:\r\n                return 'Finalist'; // Установите красный цвет для статуса 4\r\n        }\r\n    };\r\n\r\n    return (\r\n        <>\r\n                <label className='departmentName'>{department}</label>\r\n                <div className=\"vacancies-container\" >\r\n                    {vacancies.map(vac => (\r\n                    <div key={vac.id} className={\"angry-grid1\"+getColorByStatusId(vac.status_id)} onClick={() => handleClick(vac.name, vac.grade,vac.id,vac.description,vac.status_id,vac.user_name,vac.user_id)}>\r\n{/*                        <div id=\"cssportal-grid\">\r\n                            <div id=\"div1\"></div>\r\n                            <div id=\"div2\">{vac.user_name ? vac.user_name+'\\n'+\r\n                                '('+vac.vacancy_code+')'+'\\n': vac.vacancy_code+'\\n'+'\\n'}</div>\r\n                            <div id=\"div3\">{date === vac.create_date ? 'NEW' : ''}</div>\r\n                            <div id=\"div4\">Грейд: {vac.grade}</div>\r\n                            <div id=\"div5\"></div>\r\n                            <div id=\"div6\">Проект: {vac.project_id}</div>\r\n                            <div id=\"div7\">{vac.company_name}</div>\r\n                        </div>*/}\r\n\r\n\r\n                        <div id=\"cssportal-grid\">\r\n                            <div id=\"div1\">{vac.user_name ? vac.user_name+'('+vac.vacancy_code+')': vac.vacancy_code}<label className='New'>{date === vac.create_date ? 'NEW' : ''}</label></div>\r\n                            <div id=\"div2\">Грейд: {vac.grade}</div>\r\n                            <div id=\"div3\">{vac.status_name}</div>\r\n                            <div id=\"div4\">Проект: {vac.project_id}</div>\r\n                            <div id=\"div5\">{vac.company_name}</div>\r\n                        </div>\r\n\r\n                    </div>\r\n                        ))}\r\n\r\n{/*                    <div id=\"item-01\">\r\n                        <div style={{textAlign:'center'}}>\r\n                            {vac.user_name ? vac.user_name+'\\n'+\r\n                                '('+vac.vacancy_code+')': vac.vacancy_code+'\\n'+'\\n'}\r\n                        </div>\r\n                        <div id=\"item-11\">\r\n                            {date === vac.create_date ? 'NEW' : ''}\r\n                        </div>\r\n                    </div>\r\n                    <div id=\"item-21\">\r\n\r\n                    </div>\r\n                    <div id=\"item-31\">\r\n                        Грейд: {vac.grade}\r\n                    </div>\r\n                    <div id=\"item-41\">\r\n                        Проект: {vac.project_id}\r\n                    </div>\r\n                    <div>\r\n                        Компания: {vac.company_name}\r\n                    </div>*/}\r\n\r\n\r\n                    <ModalVacancies active={modalVacations} setActive={setModalVacations}>\r\n                        {message}\r\n                        <div>\r\n                            <input type='text' className=\"ModalInputVacancies\"\r\n                                   value={inputValue}\r\n                                   onChange={handleNameInputChange}\r\n                            />\r\n                        </div>\r\n                        <div>\r\n                    <textarea className='textDescription'\r\n                              value={inputValueDescription}\r\n                              onChange={handleDescriptionInputChange}\r\n                    />\r\n                        </div>\r\n                        <div>\r\n                            <span>Статус:</span><br/>\r\n                            <select ref={statusRef} value={inputValueStatuses} onChange={selectValue} className='InputVacanciesItem'>\r\n                                {status.map((status, name) => <option key={name}\r\n                                                                      value={status.id}>{status.name}</option>)}\r\n                            </select>\r\n                        </div>\r\n                        <div>\r\n                            <span>Грейд:</span><br/>\r\n                            <input type='number'\r\n                                   value={inputValueGrade}\r\n                                   onChange={handleGradeInputChange}\r\n                                   className='InputVacanciesItem'\r\n                            />\r\n                        </div>\r\n                        <div className=\"container\">\r\n                            <div>\r\n\r\n                                <span>Имя сотрудника</span><br/>\r\n                                <div className='inputDiv'>\r\n                                    <input\r\n                                        type='text'\r\n                                        placeholder='Имя сотрудника'\r\n                                        value={searchTerm || user_name}\r\n                                        onChange={handleInputChange}\r\n                                        className='InputVacanciesItem'\r\n                                    />\r\n                                    {filteredUsers.length > 0 && (\r\n                                        <div className=\"userListContainer\">\r\n                                            {filteredUsers.map((user, index) => (\r\n                                                <div className='selectNameDiv' key={index} value={user.id}\r\n                                                     onClick={() => handleUserClick(user.user_name, user.id)}>\r\n                                                    {user.user_name}\r\n                                                </div>\r\n                                            ))}\r\n                                        </div>\r\n                                    )}\r\n                                </div>\r\n                            </div>\r\n                            <br/>\r\n                            <div className='divHistory'>\r\n                                История\r\n                            </div>\r\n                            <br/>\r\n                            <div>\r\n                                <button className=\"ModalButton\" type=\"submit\" onClick={ChangeData}>\r\n                                    Сохранить\r\n                                </button>\r\n                            </div>\r\n                        </div>\r\n                    </ModalVacancies>\r\n                </div>\r\n        </>\r\n    )\r\n}\r\nexport default VacanciesItem"]},"metadata":{},"sourceType":"module"}